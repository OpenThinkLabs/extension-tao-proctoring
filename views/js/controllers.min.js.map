{"version":3,"sources":["routes.js","../helper/status.js","../component/breadcrumbs.js","../templates/delivery/listBoxActions!tpl","../templates/delivery/listBoxStats!tpl","Delivery/index.js","Delivery/manage.js","../component/extraTime/encoder.js","../component/extraTime/extraTime!tpl","../component/extraTime/extraTime.js","../templates/delivery/deliveryLink!tpl","../templates/delivery/statusFilter!tpl","../templates/delivery/approximatedTimer!tpl","Delivery/monitoring.js","Delivery/testTakers.js","../../taoQtiTest/testRunner/resumingStrategy/keepAfterResume.js","../templates/deliveryServer/authorizationSuccess!tpl","DeliveryServer/awaiting.js","../helper/textConverter.js","Diagnostic/deliveriesByProctor.js","../../taoClientDiagnostic/tools/diagnostic/status.js","../../taoClientDiagnostic/tools/fixedDecimals.js","../../taoClientDiagnostic/tools/stats.js","../../taoQtiItem/qtiItem/core/qtiClasses.js","../../taoQtiItem/qtiItem/helper/util.js","../../taoQtiItem/qtiItem/helper/rendererConfig.js","../../taoQtiItem/qtiItem/core/Element.js","../../taoQtiItem/qtiItem/core/Loader.js","../../taoQtiItem/qtiItem/helper/interactionHelper.js","../../taoQtiItem/qtiRunner/core/Renderer.js","../../taoItems/assets/manager.js","../../taoItems/assets/strategies.js","../../taoQtiItem/portableElementRegistry/factory/factory.js","../../taoQtiItem/qtiCreator/helper/qtiElements.js","../../taoQtiItem/portableElementRegistry/factory/ciRegistry.js","../../taoQtiItem/portableElementRegistry/ciRegistry.js","../../taoQtiItem/portableElementRegistry/factory/icRegistry.js","../../taoQtiItem/portableElementRegistry/icRegistry.js","../../taoQtiItem/portableElementRegistry/assetManager/portableAssetStrategy.js","../../taoQtiItem/qtiCommonRenderer/renderers/config.js","../../taoQtiItem/qtiCommonRenderer/renderers/Renderer.js","../../taoClientDiagnostic/tools/performances/tester.js","../../taoClientDiagnostic/tools/bandwidth/tester.js","../../taoClientDiagnostic/tools/upload/tester.js","../../taoClientDiagnostic/tools/getconfig.js","../../taoClientDiagnostic/tools/browser/tester.js","../../taoClientDiagnostic/tools/diagnostic/tpl/main!tpl","../../taoClientDiagnostic/tools/diagnostic/tpl/result!tpl","../../taoClientDiagnosticCss/diagnostics!css","../../taoClientDiagnostic/tools/diagnostic/diagnostic.js","../templates/diagnostic/main!tpl","Diagnostic/diagnostic.js","Diagnostic/index.js","Irregularity/index.js","../component/proctorForm/form!tpl","../component/proctorForm.js","../templates/proctorManager/counters!tpl","../templates/proctorManager/status!tpl","ProctorManager/index.js","../component/dateRange/form!tpl","../component/dateRange.js","../component/history/historyTable.js","Reporting/history.js","../templates/testSiteAdmin/adminLink!tpl","TestCenter/index.js","TestCenter/testCenter.js","../component/eligibilityEditor/layout!tpl","../../taoProctoringCss/eligibilityEditor!css","../component/eligibilityEditor.js","../component/eligibilityTable/status!tpl","../component/eligibilityTable/actions!tpl","../../taoProctoringCss/eligibilityTable!css","../component/eligibilityTable.js","../provider/eligibility.js","TestCenterManager/editCenter.js","../../../../../../../../../../onLayerEnd0.js"],"names":["define","TestCenter","actions","index","testCenter","TestCenterManager","editCenter","ProctorManager","Diagnostic","diagnostic","deliveriesByProctor","Reporting","sessionHistory","Irregularity","Delivery","manage","monitoring","monitoringAll","testTakers","_","__","getStatus","statusName","_status","getStatusByCode","statusCode","find","code","verifyTestTaker","testTakerData","actionName","formatted","id","label","firstname","lastname","status","state","allowed","can","reason","getStatuses","map","el","_awaiting","_authorized","_inprogress","_paused","_completed","_terminated","awaiting","authorize","pause","terminate","report","print","time","authorized","inprogress","paused","completed","terminated","STATUS_AUTHORIZED","STATUS_INPROGRESS","STATUS_PAUSED","STATUS_COMPLETED","STATUS_TERMINATED","breadcrumbs","$container","crumbs","data","renderTo","replace","cls","hb","template","Handlebars","depth0","helpers","partials","this","compilerInfo","merge","stack1","helper","options","buffer","functionType","escapeExpression","helperMissing","call","hash","program1","periodStart","periodEnd","self","showProperties","inverse","noop","fn","program","locked","inProgress","$","loadingBar","listBoxFactory","encode","feedback","bulkActionPopup","cascadingComboBox","breadcrumbsFactory","actionsTpl","statsTpl","cssScope","taoProctoringCtlr","start","format","transform","result","delivery","props","properties","tplData","stats","awaitingApproval","html","content","getDeliveryLabel","deliveries","update","listBox","stop","refresh","setLoading","ajax","url","serviceUrl","cache","dataType","type","done","deliveryId","selection","deliveryExecutions","testTaker","firstName","lastName","resourceType","categoriesSelector","categoriesDefinitions","categories","allowedResources","on","_url","testCenterId","execution","pluck","error","response","messageContext","unprocessed","success","forEach","uri","count","length","join","warning","encodeHtml","list","title","textEmpty","textNumber","textLoading","width","countRenderer","e","pauseUrl","stopPropagation","preventDefault","get","res","inProgressExecs","isPlainObject","isArray","filter","info","dialog","proctorDeliveryIndexCtlr","$list","dataset","assignUrl","removeUrl","monitoringUrl","request","message","testtaker","datatable","remove","empty","available","loading","tools","icon","action","window","location","href","massAction","autoRender","autoDestroy","onOkBtn","selectable","model","timeEncoder","encodeExtraTime","extraTime","consumedTime","pattern","unit","encoded","Math","min","each","program2","deniedResources","program7","remainingStr","program3","extraTimeStr","program5","program8","program10","component","hider","extraTimeTpl","extraTimeFactory","config","initConfig","defaults","_defaults","timeUnit","resource","remaining","parseFloat","setTemplate","checkInputError","value","$time","val","trim","Number","isNaN","show","$error","$ok","attr","focus","removeAttr","hide","submit","trigger","$cmp","modal","cancel","select","getElement","reduce","max","addClass","destroy","event","keyCode","$btn","target","closest","control","removeClass","init","statuses","since","timer","program4","moment","extraTimePopup","deliveryLinkTpl","statusFilterTpl","approximatedTimerTpl","extraTimeUnit","getExecutionData","date","authorise","execBulkAction","sel","authoriseUrl","terminateUrl","reportUrl","open","JSON","stringify","terminateAndIrregularity","buttons","close","showHistory","urlParams","session","printReport","printResults","timeHandling","_selection","listSessions","$content","extraTimeUrl","canDo","what","verifyDelivery","deliveryName","isObject","text","consumedExtraTime","allowedDeliveries","forbiddenDeliveries","checkedDelivery","push","actionTitle","cb","askForReason","reasonRequired","isFunction","buildStatusFilter","statusFilterHandler","$el","select2","dropdownAutoWidth","placeholder","minimumResultsForSearch","Infinity","allowClear","actionButtons","actionList","extraFields","isManageable","approximateTimer","approximateTimerWarning","timeHandlingButton","printReportButton","refreshBtn","autoRefresh","manageUrl","serviceAllUrl","highlightRows","setInterval","sortable","row","extraField","filterable","customFilter","callback","disabled","refinedValue","approximatedRemaining","parseInt","isFinite","duration","humanize","hidden","online","progress","newDataset","children","v","uniq","forIn","filtercolumns","sortorder","sortby","proctorDeliveryAssignCtlr","managerUrl","assign","sessionStateFactory","_start","_interval","TypeError","setLocalStorageData","getLocalStorageData","_accuracy","_stop","clearInterval","_reset","clearLocalStorage","_init","accuracy","localStorage","setItem","_storageKey","getItem","parse","removeItem","sessionState","reset","restart","getDuration","dialogAlert","polling","keepAfterResume","authSuccessTpl","refreshPolling","awaitingAuthorizationCtlr","exit","returnUrl","isAuthorizedUrl","deliveryExecution","runDeliveryUrl","boxes","deliveryLabel","deliveryInit","async","reject","resolve","interval","autoStart","Promise","proctoringLabelsLoader","pendingPromise","route","labels","translations","proctoringLabels","fail","undefined","console","log","localized","arguments","apply","textConverter","then","catch","err","diagnosticStatusFactory","thresholds","performances","performancesThresholds","bandwidth","bandwidthThresholds","upload","uploadThresholds","summary","summaryThresholds","getThresholds","name","percentage","len","i","step","round","isString","threshold","quality","clone","fixedDecimals","decimals","shift","pow","abs","fieldName","variance","avg","med","middle","getValue","results","sum","sum2","MAX_VALUE","values","item","diff","sqrt","sort","floor","ceil","average","median","key","_container","assessmentItem","responseProcessing","_simpleFeedbackRule","stylesheet","math","img","object","outcomeDeclaration","responseDeclaration","rubricBlock","associableHotspot","gap","gapImg","gapText","hotspotChoice","hottext","inlineChoice","simpleAssociableChoice","simpleChoice","associateInteraction","choiceInteraction","endAttemptInteraction","extendedTextInteraction","gapMatchInteraction","graphicAssociateInteraction","graphicGapMatchInteraction","graphicOrderInteraction","hotspotInteraction","hottextInteraction","inlineChoiceInteraction","matchInteraction","mediaInteraction","orderInteraction","prompt","selectPointInteraction","sliderInteraction","textEntryInteraction","uploadInteraction","feedbackBlock","feedbackInline","modalFeedback","customInteraction","infoControl","include","util","buildSerial","prefix","chars","charAt","random","buildId","usedIds","suffix","exists","getUsedIds","contains","buildIdentifier","useSuffix","getUsedIdentifiers","isUndefined","findInCollection","element","collectionNames","searchedSerial","found","Error","collectionName","collection","split","nameToken","elt","parent","addMarkupNamespace","markup","ns","$0","$1","$2","$3","$4","indexOf","removeMarkupNamespaces","getMarkupUsedNamespaces","namespaces","original","slash","node","rendererConfigHelper","getOptionsFromArguments","args","subclass","renderer","arg","isRenderer","Class","rendererConfig","_instances","Element","extend","qtiClass","serial","relatedItem","attributes","metaData","match","setAttributes","initContainer","initObject","is","getSerial","elts","getComposingElements","prop","document","removeData","removeAttributes","getAttributes","attrNames","append","getBody","getObject","isA","getUsedClasses","ret","composingElts","getRelatedItem","setRelatedItem","recursive","setRenderer","getRenderer","render","_renderer","defaultData","tag","body","resolveUrl","getData","rendering","renderTpl","replaceWith","postRender","altClassName","postRenderers","compact","getContainer","$scope","toArray","arr","isEmpty","className","clazz","_containClass","hasClass","regex","RegExp","toggleClass","isset","issetElement","unset","unsetElement","allClassStr","test","qtiElement","getElementBySerial","composingElements","qtiClasses","loadPortableCustomElementData","portableElement","typeIdentifier","entryPoint","libraries","Loader","classesLocation","qti","setClassesLocation","getRequiredClasses","union","loadRequiredClasses","reload","requiredClasses","required","requiredClass","_this","require","QtiClass","prototype","getLoadedClasses","keys","loadItemData","Qti","loadContainer","outcomes","outcome","buildOutcome","addOutcomeDeclaration","feedbacks","buildElement","addModalFeedback","stylesheets","addStylesheet","responses","buildResponse","addResponseDeclaration","feedbackRules","fbData","buildSimpleFeedbackRule","setResponseProcessing","buildResponseProcessing","setNamespaces","setSchemaLocations","schemaLocations","setApipAccessibility","apipAccessibility","loadAndBuildElement","loadElement","loadElementData","loadElements","allElements","elementData","howMatch","defaultValue","correctResponse","correctResponses","size","mapping","mapEntries","areaMapping","mappingAttributes","feedbackRule","setCondition","condition","comparedValue","feedbackOutcome","feedbackThen","modalFeedbacks","feedbackElse","comparedOutcome","rp","processingType","xml","bodyObject","bodyData","elements","eltData","setElement","bdy","loadObjectData","loadInteractionData","loadChoiceData","loadMathData","loadPicData","interaction","buildInteractionChoices","loadPciData","choices","set","matchSet","choice","addChoice","gapImgs","addGapImg","_alt","setMathML","mathML","annotations","encoding","setAnnotation","pci","pic","convertChoices","outputType","c","findChoices","inputType","getChoice","getChoiceByIdentifier","shuffleChoices","r","f","j","n","k","tmp","serialToIdentifier","choiceSerial","interactionHelper","themeLoader","getDocumentBaseUrl","protocol","host","pathname","_isValidRenderer","valid","classCorrect","_renderableClasses","pos","slice","subClass","_renderableSubclasses","_dependencies","Renderer","registerRendererClass","_locations","_renderers","shuffledChoices","_getClassRenderer","setOption","setOptions","opts","getOption","getCustomMessage","elementName","messageKey","messages","compile","getAssetManager","assetManager","getThemeLoader","qtiSubclass","decorators","before","after","renderDirect","tpl","setResponse","qtiInteraction","getResponse","resetResponse","getState","setState","getLoadedRenderers","register","renderersLocations","load","themes","base","theme","path","intersection","reqClass","deps","requiredSubClasses","unload","setShuffledChoices","identificationType","getShuffledChoices","reshuffle","returnedType","getChoices","getRenderers","getLocations","getAbsoluteUrl","relUrl","warn","absUrl","runtimeLocations","runtimeLocation","baseUrl","build","defaultOptions","NewRenderer","urlUtil","assetManagerFactory","strategies","parseUrl","_strategies","addStrategy","strategy","handle","setStrategies","newStrategies","setData","resolved","inputUrl","hasOwnProperty","resolveBy","clearCache","prependToUrl","slashcat","directory","encodeURIComponent","file","isRelative","itemCssNoCache","bust","Date","now","external","isAbsolute","toString","base64","isBase64","taomedia","eventifier","_requirejs","methods","_loaded","__providers","_registry","version","last","registerProvider","moduleName","resetProviders","loadProviders","providerLoadingStack","provider","getAllVersions","all","versions","getRuntime","runtime","getCreator","creator","getBaseUrl","loadRuntimes","loadPromise","loadStack","requireConfigAliases","acc","_pcis","paths","loadCreators","requiredCreators","pciModel","hook","creators","creatorHook","getTypeIdentifier","findIndex","module","QtiElements","classes","itemBody","parents","abstract","atomicBlock","atomicInline","simpleBlock","simpleInline","flowStatic","blockStatic","inlineStatic","flow","tableCell","caption","xhtml","col","colgroup","div","dl","dt","dd","hr","li","ol","ul","param","table","tbody","tfoot","thead","td","th","tr","a","abbr","acronym","b","big","cite","dfn","em","kbd","q","samp","small","span","strong","sub","sup","tt","var","blockquote","address","h1","h2","h3","h4","h5","h6","p","pre","br","textRun","blockInteraction","inlineInteraction","printedVariable","templateElement","templateBlock","templateInline","drawingInteraction","graphicInteraction","containable","getAllowedContainersElements","getAllowedContainers","jqSelector","substring","getParentClasses","aClass","intersect","getChildClasses","getAllowedContents","checked","contain","child","isAllowedClass","qtiContainerClass","qtiContentClass","allowedClasses","cacheType","isBlock","isInline","topClass","getAvailableAuthoringElements","description","short","tags","portableElementRegistry","qtiElements","getAuthoringData","ciRegistry","registry","providers","icRegistry","getBaseUrlByIdentifier","source","relative","fullmatch","relPath","context","assetStrategies","portableAssetStrategy","itemThemes","moduleConfig","root_url","locations","simpleChoice.choiceInteraction","simpleChoice.orderInteraction","simpleAssociableChoice.matchInteraction","simpleAssociableChoice.associateInteraction","enableDragAndDrop","associate","associateDragAndDrop","gapMatch","gapMatchDragAndDrop","graphicGapMatch","graphicGapMatchDragAndDrop","order","orderDragAndDrop","loadItem","qtiJsonFile","urlTokens","extension","fullpath","s","contexts","loader","itemData","end","performance","appendTo","_second","_defaultTimeout","_defaultOccurrencesCount","_defaultSamples","_sampleBaseId","performancesTester","samples","occurrences","timeout","idx","_samples","sample","nb","tests","partial","iterations","series","measures","_kilo","_mega","_downloadData","10KB","100KB","1MB","10MB","download","timeoutId","XMLHttpRequest","setRequestHeader","onload","bytes","seconds","speed","clearTimeout","onerror","delay","send","bandwidthTester","bind","urlHelper","generateStr","possible","str","xhr","startTime","addEventListener","evt","lengthComputable","passedTime","loaded","uploadTester","jqXHR","omit","getConfig","getTesterUrl","controller","navigator","screen","params","ua","userAgent","ActiveXObject","opera","chrome","createElement","Worker","applicationCache","history","pushState","documentElement","webkitRequestFullScreen","w","h","height","browserTester","header","button","legend","wide","program9","details","statusFactory","mainTpl","resultTpl","diagnosticFactory","controls","$start","$component","$status","$results","run","$result","$details","actionStore","actionCheck","_defaultsBrowser","_defaultsBandwidth","ideal","_defaultsPerformances","optimal","changeStatus","store","post","storeParams","checkBrowser","browser","information","browserVersion","os","osVersion","addResult","checkPerformances","range","cursor","performancesMin","performancesMax","performancesAverage","checkBandwidth","bandwidthMin","bandwidthMax","bandwidthAverage","bandwidthUnit","maxTestTakers","st","checkUpload","avgSpeed","totalSpeed","maxSpeed","uploadAvg","uploadMax","$indicator","fadeIn","animate","left","outerWidth","prepare","finish","doCheck","method","scores","total","actionbar","diagnosticTpl","taoProctoringDiagnosticRunnerCtlr","installTester","workstation","$workstation","which","removeProp","$panel","indexUrl","workstationUrl","formatNumber","number","digits","factor","taoProctoringDiagnosticCtlr","installedExtension","diagnosticUrl","deliveryUrl","performancesConfig","performancesOptimal","performancesRange","diagnosticStatus","IrregularityCtlr","$form","from","to","exportUrl","fileDownload","successCallback","failCallback","parseJSON","form","users","formTpl","renderFormFromData","formData","checkLogin","loginId","proctorLoginCheckUrl","_ns","proctorFormUrl","off","$element","fields","serializeArray","testCenterList","testCenters","getSelection","field","created","partially","dialogConfirm","datalist","proctorForm","counterTpl","statusTpl","proctorsDataUrl","authorizeUrl","unauthorizeUrl","_modes","EMPTY","LIST","FORM","proctors","$containerList","revoke","processMode","pageMode","$noSelection","$containerForm","$panelSelection","labelText","lines","line","dateRangeFactory","dateRange","getStart","getEnd","$periodStart","$periodEnd","$filterBtn","datepicker","dateFormat","autoSize","change","renderDetails","historyTableFactory","historyTable","service","sortBy","sortOrder","concat","taoProctoringReportCtlr","sessions","monitoringAllUrl","detailedHistory","tool","detailed","manageProctorMenu","adminLinkTpl","taoProctoringIndexCtlr","admin","adminUrl","taoProctoringTestSiteCtlr","editingMode","deliveryTreeId","subjectTreeId","GenerisTreeSelectClass","layoutTpl","_modalDefaults","dataUrl","eligibilityEditorFactory","eligibilityEditor","testTakerTreeId","uniqueId","buildTestTakerTree","selected","actionId","saveUrl","saveData","checkedNodes","serverParameters","openParentNodes","rootNode","paginate","buildDeliveryTree","destroyModal","initModal","modalConfig","api","add","deliveryTree","testTakerTree","getChecked","edit","byPassProctor","eligibilityTableFactory","eligibilities","dataSet","$button","itemId","parameters","addEligibilities","eligibility","responseText","editEligibility","removeEligibility","shieldEligibility","eligibilityId","unshieldEligibility","eligibilityProvider","editCenterCtlr","eligibilityTable","$tableContainer","$editorContainer","handleError","failed","updated","d","getElementsByTagName","cssText","createTextNode"],"mappings":"AAAAA,OAAA,mCACAC,YACAC,SACAC,MAAA,8BACAC,WAAA,qCAGAC,mBACAH,SACAI,WAAA,4CAGAC,gBACAL,SACAC,MAAA,oCAGAK,YACAN,SACAC,MAAA,8BACAM,WAAA,mCACAC,oBAAA,8CAGAC,WACAT,SACAU,eAAA,iCAGAC,cACAX,SACAC,MAAA,kCAGAW,UACAZ,SACAC,MAAA,4BACAY,OAAA;AACAC,WAAA,iCACAC,cAAA,iCACAC,WAAA,qCCtBAlB,OAAA,+BAAA,SAAA,QAAA,SAAAmB,EAAAC,IACA,YAwFA,SAAAC,WAAAC,YACA,MAAAC,SAAAD,YAQA,QAAAE,iBAAAC,YACA,MAAAN,GAAAO,KAAAH,SAAAI,KAAAF,aASA,QAAAG,iBAAAC,cAAAC,YACA,GAAAC,YACAC,GAAAH,cAAAG,GACAC,MAAAJ,cAAAK,UAAA,IAAAL,cAAAM,UAEAC,OAAAb,QAAAC,gBAAAK,cAAAQ,MAAAD,OAOA,OANAA,UACAL,UAAAO,QAAAF,OAAAG,IAAAT,eAAA,EACAC,UAAAO,UACAP,UAAAS,OAAAJ,OAAAG,IAAAT;AAGAC,UAOA,QAAAU,eACA,MAAAtB,GAAAuB,IAAAnB,QAAA,SAAAoB,IACA,OAAAhB,KAAAgB,GAAAhB,KAAAM,MAAAU,GAAAV,SA/HA,GAAAW,WAAA,+EACAC,YAAA,iFACAC,YAAA,6EACAC,QAAA,6EACAC,WAAA,+EACAC,YAAA,iFAEA1B,SACA2B;AACAvB,KAAAiB,UACAX,MAAAb,GAAA,YACAmB,KACAY,WAAA,EACAC,MAAAhC,GAAA,mBACAiC,WAAA,EACAC,QAAA,EACAC,MAAAnC,GAAA,gBACAoC,MAAA,IAGAC,YACA9B,KAAAkB,YACAZ,MAAAb,GAAA,8BACAmB,KACAY,UAAA/B,GAAA,sBACAiC,WAAA,EACAC,QAAA,EACAF,MAAAhC,GAAA,eACAmC,MAAAnC,GAAA,gBACAoC,MAAA,IAGAE,YACA/B,KAAAmB,YACAb,MAAAb,GAAA,eACAmB,KACAY,UAAA/B,GAAA,sBACAgC,OAAA,EACAC,WAAA,EACAC,QAAA,EACAC,MAAAnC,GAAA,gBACAoC,MAAA,IAGAG,QACAhC,KAAAoB,QACAd,MAAAb,GAAA,UACAmB,KACAY,UAAA/B,GAAA,aACAgC,MAAAhC,GAAA,qBACAiC,WAAA,EACAC,QAAA,EACAC,MAAAnC,GAAA,gBACAoC,MAAA,IAGAI,WACAjC,KAAAqB;AACAf,MAAAb,GAAA,aACAmB,KACAY,UAAA/B,GAAA,gBACAgC,MAAAhC,GAAA,gBACAiC,UAAAjC,GAAA,gBACAkC,QAAA,EACAC,OAAA,EACAC,MAAA,IAGAK,YACAlC,KAAAsB,YACAhB,MAAAb,GAAA,cACAmB,KACAY,UAAA/B,GAAA,iBACAgC,MAAAhC,GAAA,iBACAiC,UAAAjC,GAAA,iBACAkC,QAAA,EACAC,OAAA,EACAC,MAAA,IAsDA,QACAf,YAAAA,YACApB,UAAAA,UACAG,gBAAAA,gBACAI,gBAAAA,gBACAkC,kBAAAjB,YACAkB,kBAAAjB,YACAkB,cAAAjB,QACAkB,iBAAAjB,WACAkB,kBAAAjB,eC9IAjD,OAAA,uCAAA,kBAAA,SAAAmE,aASA,MAAA,UAAAC,WAAAC;AACA,MAAAF,cACAA,YAAAE,QAAAD,WAAAE,KAAA,eACAC,SAAAH,WAAA1C,KAAA,WACA8C,SAAA,EACAC,IAAA,wCC/BAzE,OAAA,uDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MACAU,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAC,QAAAC,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,iBAAAC,cAAAX,QAAAW,aAYA,OATAH,SAAA,kFACAF,OAAAN,QAAA9C,IAAAmD,OAAAC,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA7C,GAAAmD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,+CACAK,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,QAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,QAAAQ,WACA,yFACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,UAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,UAAAQ,WACA;KCfArF,OAAA,qDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAa,QAAAC,OAAAC,QAAAC,OAAA,EAcA,OAbAA,SAAA,qEACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,QAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,QAAAQ,WACA,cACAD,OAAAN,QAAAe,aAAAV,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAgB,YAAAV,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,yCACAK,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,MAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,MAAAQ,WACA,cACAD,OAAAN,QAAAgB,WAAAX,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAiB,UAAAX,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,uBAnBAH,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAE,OAAA,GAAAG,cAAAX,QAAAW,cAAAD,iBAAAR,KAAAQ,iBAAAD,aAAA,WAAAQ,KAAAf;AAoCA,MAfAG,QAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAmB,gBAAAL,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,yFACAF,OAAAN,QAAAuB,QAAAlB,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAwB,OAAAlB,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,qEACAC,OAAAN,QAAAwB,YAAAnB,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAyB;AAAAnB,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,sEACAC,OAAAN,QAAAnB,QAAAwB,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAlB,OAAAwB,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,oBCpBAnF,OAAA,2CACA,SACA,SACA,OACA,UACA,qBACA,aACA,cACA,cACA,qBACA,uBACA,8BACA,sCACA,sDACA,qDACA,SAAAmB,EAAAoF,EAAAnF,GAAA0D,QAAA0B,WAAAC,eAAAC,OAAAC,SAAAC,gBAAAC,kBAAAtF,QAAAuF,mBAAAC,WAAAC;AACA,YAMA,IAAAC,UAAA,kBAOAC,mBAIAC,MAAA,WAyBA,QAAAC,QAAA9C,MACA,MAAAnD,GAAAkG,UAAA/C,KAAA,SAAAgD,OAAAC,UACA,GAAAC,OAAAD,SAAAE,WACAC,SACArB,OAAAkB,SAAAI,MAAAC,iBACAtB,WAAAiB,SAAAI,MAAArB,WACA3C,OAAA4D,SAAAI,MAAAhE,OAGA6D,QAAAA,MAAA3B,aAAA2B,MAAA1B,YACA4B,QAAA1B,gBAAA,EACA0B,QAAA7B,YAAA2B,MAAA3B,YACA6B,QAAA5B,UAAA0B,MAAA1B,UAGAyB,SAAA9C,IAAA,4BAEA8C,SAAAM,KAAAd,YACA/E,GAAAuF,SAAAvF,KAEAuF,SAAAO,QAAAd,SAAAU,SAEAJ,OAAAC,SAAAvF,IAAAuF,cAKA,QAAAQ,kBAAA/F,IACA,MAAAgG,YAAAhG,KAAAgG,WAAAhG,IAAAC,MAIA,QAAAgG,QAAA3D;AACA0D,WAAAZ,OAAA9C,MACA4D,QAAAD,OAAA3D,MACAkC,WAAA2B,OAIA,QAAAC,WACA5B,WAAAW,QACAe,QAAAG,YAAA,GAEA9B,EAAA+B,MACAC,IAAAC,WACAC,OAAA,EACAC,SAAA,OACAC,KAAA,QACAC,KAAA,SAAAtE,MACA2D,OAAA3D,QAKA,QAAAlB,OAAAyF,WAAAC,UAAAC,oBAEA,GAAAzG,SAAAnB,EAAAuB,IAAAoG,UAAA,SAAAxE,MACA,OACAtC,GAAAsC,KAAAtC,GACAC,MAAAqC,KAAA0E,UAAAC,UAAA,IAAA3E,KAAA0E,UAAAE,WAIAtC,kBACArC,SAAAH,WACAtC,WAAAV,GAAA,iBACAoB,QAAA,EACA2G,aAAA,aACAC,mBAAAvC,mBACAwC,sBAAAC,WAAAlG,MAAAiG,sBACAC,WAAAA,WAAAlG,MAAAkG,aAEAC,iBAAAjH;GACAkH,GAAA,KAAA,SAAAhH,QAEA+D,EAAA+B,MACAC,IAAAzD,QAAA2E,KAAA,kBAAA,WAAA,iBACAnF,MACAiD,SAAAsB,WACAzI,WAAAsJ,aACAC,UAAAxI,EAAAyI,MAAAd,UAAA,MACAtG,OAAAA,QAEAkG,SAAA,OACAC,KAAA,OACAkB,MAAA,WACArD,WAAA2B,UAEAS,KAAA,SAAAkB,UACA,GAAAC,gBAAAC,WAEAxD,YAAA2B,OAEA2B,UAAAA,SAAAG,SACAtD,WAAAsD,QAAA,2CACA7B,YAEA2B,eAAA,GACAD,WACAE,eACA7I,EAAA+I,QAAAJ,SAAAE,YAAA,SAAAhI,IACA,GAAA2H,WAAAZ,mBAAA/G,IACAmI,IAAAR,WAAAA,UAAApC,UAAAoC,UAAApC,SAAA4C,GACAA,OACAH,YAAAG,MAAAH,YAAAG,MAAA,GAAA;GAIAH,YAAA7I,EAAAuB,IAAAsH,YAAA,SAAAI,MAAAD,KACA,MAAAC,OAAA,EACAhJ,GAAA,sDAAAgJ,MAAArC,iBAAAoC,MAEA/I,GAAA,oDAAA2G,iBAAAoC,QAGAH,YAAAK,SACAN,gBAAA,OAAAC,YAAAM,KAAA,SAEAR,SAAAD,QACAE,gBAAA,OAAArD,OAAAmB,KAAAiC,SAAAD,SAGAlD,WAAA4D,QAAAnJ,GAAA,4BAAA,OAAA2I,gBAAAS,YAAA,SAlJA,GAAApG,YAAAmC,EAAAU,UACAwD,KAAArG,WAAAE,KAAA,QACA0D,WAAAZ,OAAAqD,MACApG,OAAAD,WAAAE,KAAA,eACAgF,WAAAlF,WAAAE,KAAA,cACAoF,aAAAtF,WAAAE,KAAA,cACAkE,WAAA1D,QAAA2E,KAAA,aAAA,WAAA;AAAArJ,WAAAsJ,eACAxB,QAAAzB,gBACAiE,MAAAtJ,GAAA,YACAuJ,UAAAvJ,GAAA,yBACAwJ,WAAAxJ,GAAA,aACAyJ,YAAAzJ,GAAA,WACAmD,SAAAH,WAAA1C,KAAA,YACA8C,SAAA,EACAiG,KAAAA,KACAK,MAAA,GAGAC,cAAA,SAAAX,OACA,MAAAA,OAAA,IAqIAtD,oBAAA1C,WAAAC,QAEAD,WAAAoF,GAAA,QAAA,SAAA,SAAAwB,GAEA,GAAAnC,YAAAtC,EAAAvB,MAAAV,KAAA,YACA2G,SAAA,QAAApC,WACA/D,QAAA2E,KAAA,0BAAA,WAAA,iBAAArJ,WAAAsJ,eACA5E,QAAA2E,KAAA,qBAAA,WAAA,iBACAlC,SAAAsB,WACAzI,WAAAsJ,cAIAsB,GAAAE,kBACAF,EAAAG,iBAGA5E,EAAA6E,IAAAH,SAAA,SAAAI;AACA,GACAC,iBADAvC,qBAGA5H,GAAAoK,cAAAF,MAAAlK,EAAAqK,QAAAH,IAAA/G,QACAgH,gBAAAnK,EAAAsK,OAAAJ,IAAA/G,KAAA,SAAAA,MAEA,MADAyE,oBAAAzE,KAAAtC,IAAAsC,KACAA,KAAAjC,OAAAiC,KAAAjC,MAAAD,SAAAb,QAAAF,UAAA,cAAAM,OAGA2J,gBAAAjB,OACAjH,MAAAyF,WAAAyC,gBAAAvC,oBAEApC,WAAA+E,KAAAtK,GAAA,0CAMAqJ,KAGAjE,WAAA2B,OAFAC,WAUA,OAFA5B,YAAAW,QAEAD,oBCzOAlH,OAAA,4CACA,SACA,OACA,UACA,qBACA,cACA,cACA,YACA,sCACA,gBACA,SAAAuG,EAAAnF,GAAA0D,QAAA0B,WAAAE,OAAAC,SAAAgF,OAAA7E;AACA,YAMA,IAAAG,UAAA,mBAGAT,YAAAW,OAOA,IAAAyE,2BAIAzE,MAAA,WACA,GAAA/C,YAAAmC,EAAAU,UACA4E,MAAAzH,WAAA1C,KAAA,SACA2C,OAAAD,WAAAE,KAAA,eACAwH,QAAA1H,WAAAE,KAAA,OACAuE,WAAAzE,WAAAE,KAAA,YACAoF,aAAAtF,WAAAE,KAAA,cACAyH,UAAAjH,QAAA2E,KAAA,aAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACAsC,UAAAlH,QAAA2E,KAAA,mBAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACAlB,WAAA1D,QAAA2E,KAAA,qBAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACAuC,cAAAnH,QAAA2E,KAAA,aAAA,WAAA;AAAAlC,SAAAsB,WAAAzI,WAAAsJ,eAKAwC,SAHApF,mBAAA1C,WAAAC,QAGA,SAAAkE,IAAAO,UAAAqD,SACArD,WAAAA,UAAAuB,SACA7D,WAAAW,QAEAZ,EAAA+B,MACAC,IAAAA,IACAjE,MACA8H,UAAAtD,WAEAJ,SAAA,OACAC,KAAA,OACAkB,MAAA,WACArD,WAAA2B,UAEAS,KAAA,SAAAkB,UACAtD,WAAA2B,OAEA2B,UAAAA,SAAAG,SACAkC,SACAxF,WAAAsD,QAAAkC,SAEAN,MAAAQ,UAAA,YAEA1F,WAAAkD,MAAAzI,GAAA,4BAAA,OAAAsF,OAAAmB,KAAAiC,SAAAD,QAAAW,YAAA,SAOA8B,OAAA,SAAAxD,WACAoD,QAAAF,UAAAlD,UAAA1H,GAAA,kCAGAyK,OACArC,GAAA,kBAAA,WACAhD,WAAAW;GAEAqC,GAAA,iBAAA,WACAhD,WAAA2B,SAEAkE,WACA9D,IAAAC,WACApG,QACAmK,MAAAnL,GAAA,2BACAoL,UAAApL,GAAA,wBACAqL,QAAArL,GAAA,YAEAsL,QACA1K,GAAA,UACA2K,KAAA,QACAjC,MAAAtJ,GAAA,oBACAa,MAAAb,GAAA,WACAwL,OAAA,WACAf,MAAAQ,UAAA,cAGArK,GAAA,OACA2K,KAAA,UACAjC,MAAAtJ,GAAA,oCACAa,MAAAb,GAAA,cACAwL,OAAA,WACAC,OAAAC,SAAAC,KAAAd,iBAGAjK,GAAA,SACA2K,KAAA,MACAjC,MAAAtJ,GAAA,2CACAa,MAAAb,GAAA,mBACAwL,OAAA,WACAC,OAAAC,SAAAC,KAAAhB,aAGA/J,GAAA,SACA2K,KAAA,SACAjC,MAAAtJ,GAAA;AACAa,MAAAb,GAAA,UACA4L,YAAA,EACAJ,OAAA,SAAA9D,WACA6C,QACAQ,QAAA/K,GAAA,iEACA6L,YAAA,EACAC,aAAA,EACAC,QAAA,WACAb,OAAAxD,iBAKA5I,UACA8B,GAAA,SACA2K,KAAA,SACAjC,MAAAtJ,GAAA,0CACAwL,OAAA,SAAA5K,IACA2J,QACAsB,YAAA,EACAC,aAAA,EACAf,QAAA/K,GAAA,gEACA+L,QAAA,WACAb,QAAAtK,WAKAoL,YAAA,EACAC,QACArL,GAAA,YACAC,MAAAb,GAAA,gBAEAY,GAAA,WACAC,MAAAb,GAAA,eAEAY,GAAA,aACAC,MAAAb,GAAA,gBAEAY,GAAA,SACAC,MAAAb,GAAA,aAEA0K,UAIA,OAAAF;GCxKA5L,OAAA,6CACA,cACA,qBACA,SAAAoH,OAAAkG,aACA,YAUA,SAAAC,iBAAAC,UAAAC,aAAAC,QAAAC,MACA,GAAAC,SAAA,EAeA,OAbAF,SAAAA,SAAA,KACAC,KAAAA,MAAA,EAEAH,YAEAI,QADAH,aACAH,YAAA5G,OAAAmH,KAAAC,IAAAL,aAAAD,YAAA,IAAAF,YAAA5G,OAAA8G,WAEApG,OAAAsG,QAAAF,UAAAG,MAGAC,QAAA,KAAAA,SAGAA,QAGA,MAAAL,mBCpDAvN,OAAA,mDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAa,QAAAC,OAAAC,QAAAC,OAAA;AAUA,MATAA,SAAA,4CACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,sDAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,sDAAAQ,WACA,8DACAF,OAAAL,QAAAiJ,KAAArI,KAAAb,OAAAA,QAAAA,OAAA0E,kBAAA5D,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAA4H,SAAA1J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,sCACAH,OAAAL,QAAA,GAAAY,KAAAb,QAAAM,OAAAN,QAAAA,OAAAoJ;AAAA,MAAA9I,QAAAA,UAAA,EAAAA,OAAAA,OAAAkF,SAAA1E,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAA8H,SAAA5J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,WAGA,QAAA0I,UAAAnJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAgBA,OAfAA,SAAA,qCACAF,OAAAN,QAAA9C,IAAAmD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA7C,GAAAmD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,qDACAC,OAAAN,QAAA7C,OAAAkD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA5C,MAAAkD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,4BACAA,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAsJ,cAAAxI,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAgI,SAAA9J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,qBACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAwJ,cAAA1I,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAkI,SAAAhK,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,oCAGA,QAAA8I,UAAAvJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,4BACAF,OAAAN,QAAAqJ,cAAAhJ,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA;IACAc,OAAAP,QAAAA,OAAAsJ,aAAAhJ,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,UAIA,QAAAmJ,UAAAzJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,wBACAF,OAAAN,QAAAuJ,cAAAlJ,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAwJ,aAAAlJ,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,WAIA,QAAA+I,UAAArJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAC,QAAAC,OAAA,EAOA,OANAA,SAAA,YACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM;AAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,oEAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,oEAAAQ,WACA,yDACAF,OAAAL,QAAAiJ,KAAArI,KAAAb,OAAAA,QAAAA,OAAAoJ,iBAAAtI,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAmI,SAAAjK,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,oBAGA,QAAAiJ,UAAA1J,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAcA,OAbAA,SAAA,iCACAF,OAAAN,QAAA9C,IAAAmD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA7C;AAAAmD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,iDACAC,OAAAN,QAAA7C,OAAAkD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA5C,MAAAkD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,+CACAC,OAAAN,QAAAtC,QAAA2C,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAArC,OAAA2C,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA;CAIA,QAAAqJ,WAAA3J,OAAAP,MAEA,GAAAc,QAAAC,QAAAC,OAAA,EAIA,OAHAA,SAAA,YACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,2DAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,2DAAAQ,WACA,aA/FAL,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAC,QAAAC,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,iBAAAO,KAAAf,KAAAS,cAAAX,QAAAW,aA+HA,OA9BAH,SAAA,0DACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,SAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,SAAAQ,WACA,MACAD,OAAAN,QAAAhD,YAAAqD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA/C,WAAAqD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,gBACAA,OAAAL,QAAA,GAAAY,KAAAb,QAAAM,OAAAN,QAAAA,OAAA0E,iBAAA,MAAApE,QAAAA,UAAA,EAAAA,OAAAA,OAAAkF,SAAA1E,QAAAM,QAAAF,KAAAK,QAAA,GAAAoI,UAAAlK,MAAA6B,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,sFACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,aAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,aAAAQ,WACA,+FACAD,OAAAN,QAAAtB,MAAA2B,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAArB,KAAA2B,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,0EACAK,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,UAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,UAAAQ,WACA,gEACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,OAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,OAAAQ,WACA,2BACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,6DAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,6DAAAQ,WACA,kGACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,kCAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,kCAAAQ,WACA,sFACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,KAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,KAAAQ,WACA,mEACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,oBAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,oBAAAQ,WACA,2BACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,SAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,SAAAQ,WACA,mCC/GArF,OAAA,+CACA,SACA,SACA,OACA,oBACA,eACA,WACA,4CACA,kDACA,YACA,SAAAuG,EAAApF,EAAAC,GAAAkM,YAAAmB,UAAAC,MAAAnB,gBAAAoB;AACA,YAuBA,SAAAC,kBAAAC,QACA,GAAAC,YAAA3N,EAAA4N,SAAAF,WAAAG,WACAC,SAAAH,WAAAnB,MAAAqB,UAAArB,IAcA,OAZAxM,GAAA+I,QAAA4E,WAAAvF,iBAAA,SAAA2F,UACA,GAAAC,WAAAC,WAAAF,SAAAC,YAAA,EACA3B,UAAA4B,WAAAF,SAAA1B,WACAC,aAAA2B,WAAAF,SAAAzB,aAEA0B,aACAD,SAAAf,aAAAb,YAAA5G,OAAAyI,YAGAD,SAAAb,aAAAd,gBAAAC,UAAAC,aAAArM,GAAA,mBAAA6N,YAGAR,YACAY,YAAAV,cACAnF,GAAA,SAAA,WAWA,QAAA8F,mBACA,GAAAC,OAAAC,MAAAC,MAAAC,OAIAlM,KAAAmM,OAAAJ,OAIA1F,MAAA+F,MAAApM,OAAAA,OAAA4L,WAAAG;AAWA,MATA1F,QACA6E,MAAAmB,KAAAC,QACAC,IAAAC,KAAA,YAAA,GACAC,UAEAF,IAAAG,WAAA,YACAxB,MAAAyB,KAAAL,SAGAjG,MAMA,QAAAuG,UACAd,oBAMAvJ,KAAAsK,QAAA,KAAAjB,WAAAI,MAAAC,OAAAR,UACAqB,KAAAC,MAAA,UAOA,QAAAC,UAKAzK,KAAAsK,QAAA,UACAC,KAAAC,MAAA,SAMA,QAAAN,SACAT,MAAAS,QAAAQ,SAhEA,GAAA1K,MAAAf,KACAsL,KAAAtL,KAAA0L,aACAlB,MAAAc,KAAA5O,KAAA,yBACAoO,OAAAQ,KAAA5O,KAAA,mBACAqO,IAAAO,KAAA5O,KAAA,wBAgEA8N,OAAAC,IAAAtO,EAAAwP,OAAA7B,WAAAvF,iBAAA,SAAA/F,KAAAwF,WACA,MAAA6E,MAAA+C,IAAApN,KAAAwF,WAAAA,UAAAwE,WAAA,IACA,GAAAyB,UAEAqB,KACAO,SAAA,SACArH,GAAA,eAAA;AACAzD,KAAA+K,YAEAtH,GAAA,SAAAgG,MAAA,WACAF,oBAEA9F,GAAA,QAAA,SAAAuH,OACA,KAAAA,MAAAC,QACAZ,SAEAd,oBAGA9F,GAAA,QAAA,UAAA,SAAAuH,OACA,GAAAE,MAAA1K,EAAAwK,MAAAG,QAAAC,QAAA,WACAC,QAAAH,KAAA3M,KAAA,UAEAyM,OAAA5F,iBAEA,SAAAiG,QACAhB,SAEAI,WAGAD,OACAzF,MAAA,MAGAmF,UAEAzG,GAAA,UAAA,WACAxE,KAAA0L,aACAW,YAAA,SACAd,MAAA,aAEAe,KAAAxC,YAjJA,GAAAE,YACArB,KAAA,GACAM,mBAkJA,OAAAW,oBCzLA5O,OAAA,qDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MACAU,KAAAC,cAAA,EAAA;AACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAE,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,gBAgBA,OAbAF,SAAA,6BACAF,OAAAN,QAAAyD,KAAApD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA0D,IAAApD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,aACAC,OAAAN,QAAA7C,OAAAkD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA5C,MAAAkD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,SACAD,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,MACAF,OAAAN,QAAA7C,OAAAkD,OAAAC,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA5C,MAAAkD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,SACAD,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,WCnBAtF,OAAA,qDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAUA,OATAA,SAAA,yBACAF,OAAAN,QAAAnD,MAAAwD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAlD,KAAAwD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,MACAC,OAAAN,QAAA7C,OAAAkD,OAAAC,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA5C,MAAAkD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,kBAfAH,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAG,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,iBAAAO,KAAAf,IAqBA,OAJAM,SAAA,wFACAH,OAAAL,QAAAiJ,KAAArI,KAAAb,OAAAA,QAAAA,OAAA0M,UAAA5L,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA;ACxBAtF,OAAA,0DAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAYA,OAXAA,SAAA,sCACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA2M,OAAA7L,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAA4H,SAAA1J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,MACAF,OAAAN,QAAA2M,OAAAtM,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA4M,MAAAtM,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA;AACAA,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA2M,OAAA7L,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAsL,SAAApN,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,KAGA,QAAA0I,UAAAnJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,YACAF,OAAAN,QAAA0M,OAAArM,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA2M,MAAArM,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,IAIA,QAAAuM,UAAA7M,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,sCACAF,OAAAN,QAAA0M,OAAArM,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA2M;AAAArM,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,YAtCAH,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAG,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,iBAAAO,KAAAf,IA2CA,OAHAG,QAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA4M,OAAA9L,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,SC3BAtF,OAAA,gDACA,SACA,SACA,OACA,UACA,SACA,qBACA,oBACA,cACA,cACA,YACA,qBACA,uBACA,8CACA,4CACA,sCACA,8BACA,oDACA,oDACA,yDACA,eACA,WACA,SACAuG,EACApF,EACAC,GACA0D,QACA6M,OACAnL,WACA8G,YACA5G,OACAC,SACAgF,OACA/E,gBACAC,kBACA+K,eACArE,gBACAzG,mBACAvF,QACAsQ,gBACAC,gBACAC;AAEA,YAMA,IAAA9K,UAAA,uBAMA+K,cAAA,EAUA,OAPAxL,YAAAW,SAWAA,MAAA,WAgCA,QAAA+E,SAAA3D,IAAAO,UAAAxE,KAAA6H,SACArD,WAAAA,UAAAuB,SACA7D,WAAAW,QAEAZ,EAAA+B,MACAC,IAAAA,IACAjE,KAAAnD,EAAA+D,OACAyE,UAAAb,WACAxE,MACAoE,SAAA,OACAC,KAAA,OACAkB,MAAA,WACArD,WAAA2B,UAEAS,KAAA,SAAAkB,UACA,GAAAC,gBAAAC,WAEAxD,YAAA2B,OAEA2B,UAAAA,SAAAG,SACAkC,SACAxF,WAAAsD,QAAAkC,SAEAN,MAAAQ,UAAA,aAEAtC,eAAA,GACAD,WACAE,YAAA7I,EAAAuB,IAAAoH,SAAAE,YAAA,SAAAhI,IACA,GAAA2H,WAAAsI,iBAAAjQ,GACA,IAAA2H,UACA,MAAAvI,IAAA,yCAAAuI,UAAApC,SAAAoC,UAAAuI;GAIAlI,YAAAK,SACAN,gBAAA,OAAAC,YAAAM,KAAA,SAEAR,SAAAD,QACAE,gBAAA,OAAArD,OAAAmB,KAAAiC,SAAAD,SAIAlD,WAAAkD,MAAAzI,GAAA,4BAAA,OAAA2I,gBAAAS,YAAA,QAOA,QAAA2H,WAAArJ,WACAsJ,eAAA,YAAAhR,GAAA,qBAAA0H,UAAA,SAAAuJ,IAAA7P,QACA0J,QAAAoG,aAAAD,KAAA7P,OAAAA,QAAApB,GAAA,0BAKA,QAAAgC,OAAA0F,WACAsJ,eAAA,QAAAhR,GAAA,iBAAA0H,UAAA,SAAAuJ,IAAA7P,QACA0J,QAAAjB,SAAAoH,KAAA7P,OAAAA,QAAApB,GAAA,sBAKA,QAAAiC,WAAAyF,WACAsJ,eAAA,YAAAhR,GAAA,qBAAA0H,UAAA,SAAAuJ,IAAA7P;AACA0J,QAAAqG,aAAAF,KAAA7P,OAAAA,QAAApB,GAAA,0BAKA,QAAAkC,QAAAwF,WACAsJ,eAAA,SAAAhR,GAAA,uBAAA0H,UAAA,SAAAuJ,IAAA7P,QACA0J,QAAAsG,UAAAH,KAAA7P,OAAAA,QAAApB,GAAA,wBAIA,QAAAmC,OAAAuF,UAAAH,MACAyJ,eAAA,QAAAhR,GAAA,eAAA0H,UAAA,SAAAuJ,KACAxF,OAAA4F,KAAA3N,QAAA2E,KAAAd,KAAA,YAAA,iBAAA3G,GAAAqQ,MAAA,cAAAK,KAAAC,UAAAN,QAIA,QAAAO,0BAAA9J,WACA6C,QACAQ,QAAA/K,GAAA,+BACA6L,YAAA,EACAC,aAAA,EACA2F,UACA7Q,GAAA,YACA2G,KAAA,QACA1G,MAAAb,GAAA,qBACAuL,KAAA,OACAmG,OAAA,EACAlG,OAAA;AAAAvJ,UAAAyF,cAEA9G,GAAA,eACA2G,KAAA,OACA1G,MAAAb,GAAA,uBACAuL,KAAA,iBACAmG,OAAA,EACAlG,OAAA,WAAAtJ,OAAAwF,gBAMA,QAAAiK,aAAAjK,WACA,GAAAkK,YACA5S,WAAAsJ,aACAuJ,QAAAnK,UAEAD,cACAmK,UAAAzL,SAAAsB,YAEAgE,OAAAC,SAAAC,KAAAjI,QAAA2E,KAAA,iBAAA,YAAA,gBAAAuJ,WAIA,QAAAE,aAAApK,WACAvF,MAAAuF,UAAA,eAIA,QAAAqK,cAAArK,WACAvF,MAAAuF,UAAA,eAIA,QAAAsK,cAAAtK,WACA,GAAAuK,YAAAlS,EAAAqK,QAAA1C,WAAAA,WAAAA,WACA+F,OAAA1N,EAAA+D,MAAAoO,aAAA,OAAAD,aACA9O,SAAAgP,SACAzR,WAAAV,GAAA;AACAuM,KAAAqE,eAGAJ,gBAAA/C,QAAArF,GAAA,KAAA,SAAAhG,MACA0I,QAAAsH,aAAAH,YAAA7P,KAAAA,MAAApC,GAAA,yBAUA,QAAAqS,OAAAC,KAAArR,OACA,GAAAD,OACA,UAAAC,QAAAA,MAAAD,UACAA,OAAAb,QAAAC,gBAAAa,MAAAD,QACAA,QAAAA,OAAAG,IAAAmR,SAAA,GAWA,QAAAC,gBAAA9R,cAAAC,YACA,GAAA8R,cAAA7R,UAAAK,MAwBA,OArBAwR,cADAzS,EAAA0S,SAAAhS,cAAA0F,UACA1F,cAAA0F,SAAAtF,MAEAsE,EAAA1E,cAAA0F,UAAAuM,OAEA/R,WACAC,GAAAH,cAAAG,GACAC,MAAA2R,aAAA,KAAA/R,cAAAqQ,KAAA,KAAArQ,cAAAK,UAAA,IAAAL,cAAAM,UAEAC,OAAAb,QAAAC,gBAAAK,cAAAQ,MAAAD;AAEAA,SACAL,UAAAO,QAAAF,OAAAG,IAAAT,eAAA,EACAC,UAAAO,UACAP,UAAAS,OAAAJ,OAAAG,IAAAT,cAGAD,cAAA4P,QACA1P,UAAAyL,UAAA3L,cAAA4P,MAAAjE,UACAzL,UAAA0L,aAAA5L,cAAA4P,MAAAsC,kBACAhS,UAAAoN,UAAAtN,cAAA4P,MAAAtC,WAEApN,UASA,QAAAkQ,kBAAA9H,KACA,MAAAhJ,GAAAO,KAAAoK,QAAAxH,MAAAtC,GAAAmI,MASA,QAAAmJ,cAAAxR,WAAAgH,WACA,GAAAkL,sBACAC,sBAeA,OAbA9S,GAAA4M,KAAAjF,UAAA,SAAAqB,KACA,GACA+J,iBADArS,cAAAoQ,iBAAA9H,IAEAtI,iBACAqS,gBAAAP,eAAA9R,cAAAC,YACAoS,gBAAA5R,QACA0R,kBAAAG,KAAAD,iBAEAD,oBAAAE,KAAAD;IAMA/K,aAAA,UACAI,iBAAAyK,kBACA/F,gBAAAgG,qBAYA,QAAA7B,gBAAAtQ,WAAAsS,YAAAtL,UAAAuL,IACA,GAEAxF,QAFAwE,WAAAlS,EAAAqK,QAAA1C,WAAAA,WAAAA,WACAwL,aAAAhL,WAAAxH,aAAAwH,WAAAxH,YAAAuH,uBAAAC,WAAAxH,YAAAuH,sBAAAgB,MAIAwE,QAAA1N,EAAA+D,MAAAoO,aAAAxR,WAAAuR,aACA9O,SAAAgP,SACAzR,WAAAsS,YACA5R,OAAA8R,aACAC,gBAAA,EACAnL,mBAAAvC,kBAAAyC,WAAAxH,mBAGA+M,OAAAtF,iBAAAc,OAOAzD,gBAAAiI,QAAArF,GAAA,KAAA,SAAAhH,QAEArB,EAAAqT,WAAAH,KACAA,GAAAhB,WAAA7Q;GATA6Q,WAAAhJ,OAAA,EACA1D,WAAA4D,QAAAnJ,GAAA,gDAEAuF,WAAA4D,QAAAnJ,GAAA,8CAgBA,QAAAqT,qBACA,MAAA3C,kBAAAP,SAAAhQ,QAAAkB,gBAOA,QAAAiS,qBAAAC,KACAA,IAAAC,SACAC,mBAAA,EACAC,YAAA1T,GAAA,UACA2T,wBAAAC,EAAAA,EACAC,YAAA,IA5TA,GA0BAC,eAEAC,WA5BA/Q,WAAAmC,EAAAU,UACAsM,SAAAnP,WAAA1C,KAAA,YACAmK,MAAAzH,WAAA1C,KAAA,SACA2C,OAAAD,WAAAE,KAAA,eACAwH,QAAA1H,WAAAE,KAAA,OACA8Q,YAAAhR,WAAAE,KAAA,eACAgF,WAAAlF,WAAAE,KAAA,cACAuE,WAAAzE,WAAAE,KAAA,YACA+Q,aAAAjR,WAAAE,KAAA,gBACAoF,aAAAtF,WAAAE,KAAA,cACAgR,iBAAAlR,WAAAE,KAAA,oBACAiR,wBAAAnR,WAAAE,KAAA,2BACAkR,mBAAApR,WAAAE,KAAA,gBACAmR,kBAAArR,WAAAE,KAAA,qBACAoR,WAAAtR,WAAAE,KAAA,cACAqR,YAAAvR,WAAAE,KAAA,eACAsR,UAAA9Q,QAAA2E,KAAA,SAAA,WAAA;AAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACA6I,aAAAzN,QAAA2E,KAAA,sBAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACAuB,SAAAnG,QAAA2E,KAAA,kBAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACA4I,aAAAxN,QAAA2E,KAAA,sBAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACA8J,aAAA1O,QAAA2E,KAAA,YAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACA8I,UAAA1N,QAAA2E,KAAA,mBAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACAlB,WAAA1D,QAAA2E,KAAA,qBAAA,WAAA;AAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACAmM,cAAA/Q,QAAA2E,KAAA,0BAAA,WAAA,iBAAArJ,WAAAsJ,eACAgD,SACAW,SAEAyI,gBAqSAhP,oBAAA1C,WAAAC,QAKAqR,YAEAhJ,MAAAyH,MACAnS,GAAA,UACA2K,KAAA,QACAjC,MAAAtJ,GAAA,oBACAa,MAAAb,GAAA,WACAwL,OAAA,WACAf,MAAAQ,UAAA,cAKAsJ,aACAI,YAAA,WACAlK,MAAAQ,UAAA,YACAsJ,aAIA9M,YAAAwM,cACA3I,MAAAyH,MACAnS,GAAA,SACA2K,KAAA,oBACAjC,MAAAtJ,GAAA,mBACAa,MAAAb,GAAA,UACAwL,OAAA,WACAC,OAAAC,SAAAC,KAAA6I,aAMAlJ,MAAAyH,MACAnS,GAAA,YACA2K,KAAA,OACAjC,MAAAtJ,GAAA;AACAa,MAAAb,GAAA,aACA4L,YAAA,EACAJ,OAAAuF,YAIAzF,MAAAyH,MACAnS,GAAA,QACA2K,KAAA,QACAjC,MAAAtJ,GAAA,kBACAa,MAAAb,GAAA,SACA4L,YAAA,EACAJ,OAAAxJ,QAIAsJ,MAAAyH,MACAnS,GAAA,YACA2K,KAAA,OACAjC,MAAAtJ,GAAA,sBACAa,MAAAb,GAAA,aACA4L,YAAA,EACAJ,OAAAvJ,YAIAqJ,MAAAyH,MACAnS,GAAA,eACA2K,KAAA,iBACAjC,MAAAtJ,GAAA,yBACAa,MAAAb,GAAA,UACA4L,YAAA,EACAJ,OAAAtJ,SAIAoJ,MAAAyH,MACAnS,GAAA,UACA2K,KAAA,UACAjC,MAAAtJ,GAAA,qCACAa,MAAAb,GAAA,WACA4L,YAAA,EACAJ,OAAAmG,cAIArG,MAAAyH,MACAnS,GAAA,cACA0I,MAAAtJ,GAAA,0BACAuL,KAAA,QACA1K,MAAAb,GAAA;AACA4L,YAAA,EACAJ,OAAAuG,eAIAsC,mBACA/I,MAAAyH,MACAnS,GAAA,cACA0I,MAAAtJ,GAAA,gCACAuL,KAAA,SACA1K,MAAAb,GAAA,iBACA4L,YAAA,EACAJ,OAAAsG,cAKAsC,oBACA9I,MAAAyH,MACAnS,GAAA,eACA0I,MAAAtJ,GAAA,yBACAuL,KAAA,OACA1K,MAAAb,GAAA,QACA4L,YAAA,EACAJ,OAAAwG,eAKAvK,YACAwE,MAAA8G,MACAnS,GAAA,WACAC,MAAAb,GAAA,WACA4U,UAAA,EACA3O,UAAA,SAAAkI,MAAA0G,KACA,GAAA1O,UAAA0O,KAAAA,IAAA1O,QAKA,OAJAA,YACAA,SAAAgB,IAAAzD,QAAA2E,KAAA,aAAA,WAAA,iBAAAlC,SAAAA,SAAA4C,IAAA/J,WAAAsJ,eACA6F,MAAAsC,gBAAAtK,WAEAgI,SAMAlC,MAAA8G;AACAnS,GAAA,YACAC,MAAAb,GAAA,cACA4U,UAAA,EACA3O,UAAA,SAAAkI,MAAA0G,KACA,MAAAA,MAAAA,IAAAjN,WAAAiN,IAAAjN,UAAAC,WAAA,MAMAoE,MAAA8G,MACAnS,GAAA,WACAC,MAAAb,GAAA,aACA4U,UAAA,EACA3O,UAAA,SAAAkI,MAAA0G,KACA,MAAAA,MAAAA,IAAAjN,WAAAiN,IAAAjN,UAAAE,UAAA,MAMA/H,EAAA4M,KAAAqH,YAAA,SAAAc,YACA7I,MAAA8G,MACAnS,GAAAkU,WAAAlU,GACAC,MAAAiU,WAAAjU,MACA+T,UAAA,EACA3O,UAAA,SAAAkI,MAAA0G,KACA,MAAAA,MAAAA,IAAAb,aAAAa,IAAAb,YAAAc,WAAAlU,KAAA,QAMAqL,MAAA8G,MACAnS,GAAA,OACAgU,UAAA,EACA/T,MAAAb,GAAA,gBAIAiM,MAAA8G,MACAnS,GAAA,SACAC,MAAAb,GAAA,UACA4U,UAAA,EACAG,YAAA,EACAC,cACAzR,SAAA8P,oBACA4B,SAAA3B;EAGArN,UAAA,SAAAkI,MAAA0G,KACA,GACA7T,QADAkF,OAAA,EAeA,OAZA2O,MAAAA,IAAA5T,OAAA4T,IAAA5T,MAAAD,SACAA,OAAAb,QAAAC,gBAAAyU,IAAA5T,MAAAD,QACAA,SACAkF,OAAAlF,OAAAH,MACA,eAAAgU,IAAA5T,MAAAD,SACAkF,OAAAlF,OAAAH,OAEA,aAAAqF,QACAwO,cAAA3B,KAAA8B,IAAAjU,MAIAsF,UAKA+F,MAAA8G,MACAnS,GAAA,cACAC,MAAAb,GAAA,aACAuH,KAAA,UACAzI,UACA8B,GAAA,YACA2K,KAAA,OACAjC,MAAAtJ,GAAA,qBACAkV,SAAA,WACA,OAAA7C,MAAA,YAAAzO,KAAA3C,QAEAuK,OAAAuF,cAKA9E,MAAA8G,MACAnS,GAAA,UACAC,MAAAb,GAAA,SACAuH,KAAA,UACAzI,UACA8B,GAAA,QACA2K,KAAA,QACAjC,MAAAtJ,GAAA,iBACAkV,SAAA,WACA,OAAA7C,MAAA,QAAAzO,KAAA3C;EAEAuK,OAAAxJ,UAKAiK,MAAA8G,MACAnS,GAAA,YACAgU,UAAA,EACA/T,MAAAb,GAAA,aACAiG,UAAA,SAAAkI,MAAA0G,KACA,GAAAxE,OAAAtQ,EAAA0S,SAAAoC,IAAAxE,OAAAwE,IAAAxE,SACA8E,aAAAjB,iBAAA7D,MAAA+E,sBAAA/E,MAAAtC,UACAA,UAAAsH,SAAAF,aAAA,IACA/E,MAAAiF,SAAAhF,MAAAD,MAAA,GA+BA,QA7BArC,WAAAhO,EAAAuV,SAAAvH,cACAA,UAAA,GAAAsC,MAAAjE,YACAiE,MAAAsC,oBAAA5E,UACAA,UAAA,GAIAoH,aADApH,UACA7B,YAAA5G,OAAAyI,WAEA,IAGAA,WAAAsC,MAAAjE,WAAAiE,MAAAjE,WAAAiE,MAAAsC,kBACAwC,aAAAnV,GAAA,aAEAmV,cAAAhJ,gBAAAkE,MAAAjE,UAAAiE,MAAAsC,kBAAA3S,GAAA,UAAA4Q;AAIAsD,mBACAiB,aAAAxE,sBACAN,MAAA8E,aACA/E,MAAA+D,yBAAApU,EAAAuV,SAAAlF,QAAAA,OAAA+D,wBACAnU,GAAA,iCAAAuQ,OAAAgF,UAAAnF,MAAA,WAAAoF,UAAA,IACA,SAKAL,gBAGAf,oBACAnI,MAAA8G,MACAnS,GAAA,YACAC,MAAAb,GAAA,cACAuH,KAAA,UACAzI,UACA8B,GAAA,eACA0I,MAAAtJ,GAAA,yBACAuL,KAAA,OACAC,OAAAwG,aACAyD,OAAA,WACA,OAAApD,MAAA,OAAAzO,KAAA3C,YAOAgL,MAAA8G,MACAnS,GAAA,eACAgU,UAAA,EACA/T,MAAAb,GAAA,gBACAiG,UAAA,SAAAkI,MAAA0G,KACA,MAAAA,KAAA5T,MAAAD,SAAAb,QAAAwC,kBACA3C,GAAA6U,IAAAa,OAAA,SAAA,WAEA;IAKAzJ,MAAA8G,MACAnS,GAAA,WACAC,MAAAb,GAAA,YACAiG,UAAA,SAAAkI,MAAA0G,KACA,MAAAA,MAAAA,IAAA5T,OAAA4T,IAAA5T,MAAA0U,UAAA,MAKA5B,aACAnT,GAAA,2BACA2K,KAAA,iBACAjC,MAAAtJ,GAAA,8BACAwL,OAAAgG,2BAEA5Q,GAAA,UACA2K,KAAA,UACAjC,MAAAtJ,GAAA,qCACAwL,OAAAmG,cAEA/Q,GAAA,cACA0I,MAAAtJ,GAAA,0BACAuL,KAAA,QACAC,OAAAuG,eAEAsC,mBACAN,WAAAhB,MACAnS,GAAA,cACA0I,MAAAtJ,GAAA,gCACAuL,KAAA,SACAC,OAAAsG,cAIA7F,MAAA8G,MACAnS,GAAA,mBACAC,MAAAb,GAAA,kBACAuH,KAAA,UACAzI,QAAAiV;GAIAtJ,MACArC,GAAA,kBAAA,WACAhD,WAAAW,QACA2O,mBAEAtM,GAAA,iBAAA,SAAAwB,EAAAgM,YAEAlL,QAAAkL,WAGA9B,cAAA/T,GACAgC,UAAA0I,MAAAnK,KAAA,eAAAuV,SAAA,mBACA7T,MAAAyI,MAAAnK,KAAA,eAAAuV,SAAA,eACA5T,UAAAwI,MAAAnK,KAAA,eAAAuV,SAAA,mBACA3T,OAAAuI,MAAAnK,KAAA,eAAAuV,SAAA,wBAIAnB,cAAAzL,QACAlJ,EAAA+I,QAAA4L,cAAA,SAAAoB,GACArL,MAAAQ,UAAA,eAAA6K,KAIA1Q,WAAA2B,SAEAqB,GAAA,mBAAA,WAEA0L,cAAAnH,KAAA,SAAAkD,MACAA,KAAAd,SAEAhP,EAAA0K,MAAAQ,UAAA,cAAA3J,IAAA,SAAAyH,KACA,GAAA8L,KAAAhE,iBAAA9H;AACA,MAAA8L,KAAA5T,MAAAD,SACA+U,OAAApJ,KAAA,SAAAtM,YACA,GAAAW,QAAAb,QAAAC,gBAAAC,WACAyT,eAAAkC,MAAA,SAAAnG,KAAArE,QACAxK,QAAAA,OAAAG,IAAAqK,WAAA,GACAqE,KAAApB,aAKAxD,WACA9D,IAAAM,WAAAL,WAAAqN,cACAzT,QACAmK,MAAAnL,GAAA,eACAoL,UAAApL,GAAA,oBACAqL,QAAArL,GAAA,YAEAqK,QAAA,EACA4L,eAAA,UACA3K,MAAAA,MACAW,MAAAA,MACAD,YAAA,EACAkK,UAAA,OACAC,OAAA,QACAzL,aCryBA9L,OAAA,gDACA,SACA,OACA,UACA,qBACA,cACA,cACA,sCACA,gBACA,SAAAuG,EAAAnF,GAAA0D,QAAA0B,WAAAE,OAAAC,SAAAG;AACA,YAMA,IAAAG,UAAA,sBAGAT,YAAAW,OAOA,IAAAqQ,4BAIArQ,MAAA,WACA,GAAA/C,YAAAmC,EAAAU,UACA4E,MAAAzH,WAAA1C,KAAA,SACA2C,OAAAD,WAAAE,KAAA,eACAwH,QAAA1H,WAAAE,KAAA,OACAuE,WAAAzE,WAAAE,KAAA,YACAoF,aAAAtF,WAAAE,KAAA,cACAkE,WAAA1D,QAAA2E,KAAA,sBAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACAqC,UAAAjH,QAAA2E,KAAA,mBAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eACA+N,WAAA3S,QAAA2E,KAAA,SAAA,WAAA,iBAAAlC,SAAAsB,WAAAzI,WAAAsJ,eAKAgO,QAHA5Q,mBAAA1C,WAAAC;AAGA,SAAAyE,WACAA,WAAAA,UAAAuB,SACA7D,WAAAW,QAEAZ,EAAA+B,MACAC,IAAAwD,UACAzH,MACA8H,UAAAtD,WAEAJ,SAAA,OACAC,KAAA,OACAkB,MAAA,WACArD,WAAA2B,UAEAS,KAAA,SAAAkB,UACAtD,WAAA2B,OAEA2B,UAAAA,SAAAG,SACAtD,WAAAsD,QAAA7I,GAAA,gCACAyL,OAAAC,SAAAC,KAAA0K,YAEA9Q,WAAAkD,MAAAzI,GAAA,4BAAA,OAAAsF,OAAAmB,KAAAiC,SAAAD,QAAAW,YAAA,QAMAqB,OACArC,GAAA,kBAAA,WACAhD,WAAAW,UAEAqC,GAAA,iBAAA,SAAAuH,MAAAjH,UACAtD,WAAA2B,SAEAkE,WACA9D,IAAAC,WACApG,QACAmK,MAAAnL,GAAA,sCACAoL,UAAApL,GAAA;AACAqL,QAAArL,GAAA,YAEAsL,QACA1K,GAAA,OACA2K,KAAA,OACAjC,MAAAtJ,GAAA,iCACAa,MAAAb,GAAA,QACAwL,OAAA,WACAC,OAAAC,SAAAC,KAAA0K,cAGAzV,GAAA,UACA2K,KAAA,QACAjC,MAAAtJ,GAAA,oBACAa,MAAAb,GAAA,WACAwL,OAAA,WACAf,MAAAQ,UAAA,cAGArK,GAAA,SACA2K,KAAA,MACAjC,MAAAtJ,GAAA,kDACAa,MAAAb,GAAA,mCACA4L,YAAA,EACAJ,OAAA,SAAA9D,WACA4O,OAAA5O,cAGA5I,UACA8B,GAAA,SACA2K,KAAA,MACAjC,MAAAtJ,GAAA,wCACAwL,OAAA,SAAA5K,IACA0V,QAAA1V,QAGAoL,YAAA,EACAC,QACArL,GAAA,YACAC,MAAAb,GAAA,gBAEAY,GAAA;AACAC,MAAAb,GAAA,eAEAY,GAAA,aACAC,MAAAb,GAAA,iBAEA0K,UAIA,OAAA0L,6BCtIAxX,OAAA,4DAAA,WACA,YAMA,IAAA2X,qBAAA,SAAAtS,SAqBA,QAAAuS,UACA,GAAA,OAAAC,UACA,KAAA,IAAAC,WAAA,8BAEAD,WAAA9B,YAAA,WACAgC,oBAAAC,sBAAAC,YACAA,WAGA,QAAAC,SACAC,cAAAN,WACAA,UAAA,KAGA,QAAAO,UACAF,QACAG,oBAGA,QAAAC,SACAL,UAAA5S,SAAAA,QAAAkT,UAAA,IASA,QAAAR,qBAAAtI,KACA5C,OAAA2L,aAAAC,QAAAC,YAAAjJ;CAOA,QAAAuI,uBACA,GAAA1T,MAAAuI,OAAA2L,aAAAG,QAAAD,aACApR,OAAAoL,KAAAkG,MAAAtU,OAAA,CACA,OAAAgD,QAMA,QAAA+Q,qBACAxL,OAAA2L,aAAAK,WAAAH,aAnEA,GACAT,WADAS,YAAA,0BAEAb,UAAA,KAEAiB,cAEAC,MAAA,WACAX,UAGAY,QAAA,WACAZ,SACAR,UAGAqB,YAAA,WACA,MAAAjB,wBAsDA,OA3BAM,SA2BAQ,aAGA,OAAAnB,uBCpGA3X,OAAA,mEAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MACAU,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE;AAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAE,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,gBAQA,OALAF,SAAA,kCACAF,OAAAN,QAAAqH,SAAAhH,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAsH,QAAAhH,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,kDCQAnF,OAAA,oDACA,SACA,SACA,OACA,UACA,qBACA,aACA,kBACA,eACA,yDACA,mEACA,SAAAmB,EAAAoF,EAAAnF,GAAA0D,QAAA0B,WAAA0B,QAAAgR,YAAAC,QAAAC,gBAAAC;AACA,YAMA,IAAAC,gBAAA,IAMArS,SAAA,0BAOAsS,2BAIApS,MAAA,SAAA0H,QA4DA,QAAApL,cACA+C,WAAA2B,OACA/D,WAAAyM,SAAA,yBAAAQ,YAAA,6BACAkC,SAAA1L,KAAAwR,gBAAAlN,QAAA/K,GAAA,kCAMA,QAAAoY,QACA3M,OAAAC,SAAAC,KAAA8B,OAAA4K,UApEA,GAAArV,YAAAmC,EAAAU,UACAyS,gBAAA5U,QAAA2E,KAAA,eAAA,iBAAA,iBAAAkQ,kBAAA9K,OAAA8K,oBACAC,eAAA9U,QAAA2E,KAAA,uBAAA,iBAAA,iBAAAkQ,kBAAA9K,OAAA8K,oBACAE,QACA7X,GAAA;AACAC,MAAA4M,OAAAiL,cACAvR,IAAAqR,eACA9R,QAAA1G,GAAA,6CACA0S,KAAA1S,GAAA,aAWAmS,UATArL,SACAwC,MAAAtJ,GAAAyN,OAAAkL,aAAA,aAAA,eACApP,UAAA,GACAC,WAAA,GACAC,YAAA,GACAtG,SAAAH,WACAqG,KAAAoP,MACA/O,MAAA,KAEA1G,WAAA1C,KAAA,qBAGA0X,mBAAAL,QAEAvS,WAAAW,QAEAgS,SACAvM,OAAA,WACA,GAAAoN,OAAAhV,KAAAgV,OACAzT,GAAA6E,IAAAsO,gBAAA,SAAApS,QACA,GAAAa,OAAA,CAEAb,QAAA2C,QAOA3C,OAAA7D,aACA0E,MAAA,EACA1E,eARA0E,MAAA,EACAb,OAAA6E,QACA+M,YAAA5R,OAAA6E,QAAAqN,MAEAA,QAOArR,KACA6R,MAAAC,SAEAD,MAAAE,aAIAC,SAAAb,eACAc,WAAA;CAqBA,OAAAb,6BC9GAvZ,OAAA,sCACA,SACA,SACA,cACA,eACA,YACA,SAAAuG,EAAApF,EAAAiG,OAAAiT,QAAA9R,KACA,YA4CA,SAAA+R,0BAgBA,MAfAC,kBACAA,eAAA,GAAAF,SAAA,SAAAH,QAAAD,QACA1T,EAAA+B,MACAC,IAAAA,IAAAiS,MAAA,SAAA,gBAAA,iBACA7R,KAAA,OACAD,SAAA,SAEAE,KAAA,SAAAtE,MACAmW,OAAAnW,KAAAoW,aACAR,QAAAS,oBAEAC,KAAAX,WAIAM,eAtDA,GAgCAA,gBAhCAE,OAAA,KAMAE,kBAOAvP,IAAA,SAAAe,SACA0O,QAAAJ,OAAAtO,UACA2O,QAAAC,IAAA5O,QAEA,IAAA6O,WAAAP,OAAAtO,SAAAsO,OAAAtO,SAAAA,OAOA,OALA8O,WAAA5Q,OAAA,IACA4Q,UAAA,GAAAD;AACAA,UAAA5T,OAAA8T,MAAA,KAAAD,YAGAD,WAiCA,OAAAV,0BCtEAta,OAAA,2DACA,SACA,OACA,UACA,qBACA,aACA,sCACA,sCACA,SAAAuG,EAAAnF,GAAA0D,QAAA0B,WAAA0B,QAAApB,mBAAAqU,eACA,YAMA,IAAAlU,UAAA,wBAUA,OAPAT,YAAAW,SAWAA,MAAA,WAEAgU,gBAAAC,KAAA,SAAAX,QAEA,GAAArW,YAAAmC,EAAAU,UACA4S,MAAAzV,WAAAE,KAAA,QACAD,OAAAD,WAAAE,KAAA,eACAmG,KAAAvC,SACAwC,MAAAtJ,GAAA,wBACAuJ,UAAAvJ,GAAA;AACAwJ,WAAAxJ,GAAA,aACAyJ,YAAAzJ,GAAA,WACAmD,SAAAH,WAAA1C,KAAA,YACA8C,SAAA,IAGAgE,YADA1B,mBAAA1C,WAAAC,QACAS,QAAA2E,KAAA,sBAAA,aAAA,kBAGAxB,OAAA,SAAA4R,OACApP,KAAAxC,OAAA4R,OACArT,WAAA2B,QAIAC,QAAA,WACA5B,WAAAW,QACAsD,KAAApC,YAAA,GAEA9B,EAAA+B,MACAC,IAAAC,WACAC,OAAA,EACAC,SAAA,OACAC,KAAA,QACAC,KAAA,SAAAkB,UACA+P,MAAA/P,UAAAA,SAAAW,KACAxC,OAAA4R,SAIAA,OAGA5R,OAAA4R,OAFAzR,YAKAiT,MAAA,SAAAC,KACAR,QAAAC,IAAAO,WC3EAtb,OAAA,+CACA,SACA,SACA,QACA,SAAAuG,EAAApF,EAAAC,IACA,YA8EA,SAAAma;AACA,OAIAC,YACAC,aAAAC,uBACAC,UAAAC,oBACAC,OAAAC,iBACAC,QAAAC,mBAQAC,cAAA,SAAAC,MACA,MAAAlX,MAAAwW,WAAAU,OASA7a,UAAA,SAAA8a,WAAAX,YACA,GAAAY,KAAAzV,SAAA0V,EAAAC,KAAAla,MAUA,IAPA+Z,WAAAtO,KAAA+C,IAAA,EAAA/C,KAAAC,IAAA,IAAAD,KAAA0O,MAAA9F,SAAA0F,WAAA,OAEAhb,EAAAqb,SAAAhB,cACAA,WAAAxW,KAAAiX,cAAAT,aAIAA,WAOA,IANAra,EAAAqK,QAAAgQ,cACAA,YAAAA,aAGAY,IAAAZ,WAAAnR,OACA1D,SAAA6U,WAAA,GACAa,EAAA,EAAAA,EAAAD,MACAE,KAAAd,WAAAa,GACAC,MAAAH,YAAAG,KAAAG,WAFAJ,IAGA1V,SAAA2V,IAiBA,OATAla,SACA+Z,WAAAA,WACAO,YAGA/V,WACAvE,OAAAuE,SAAAxF,EAAAwb,MAAAhW;AAGAvE,SAzIA,GAAAsZ,0BACAe,UAAA,EACAtQ,QAAA/K,GAAA,0BACAuH,KAAA,UAEA8T,UAAA,GACAtQ,QAAA/K,GAAA,wBACAuH,KAAA,YAEA8T,UAAA,GACAtQ,QAAA/K,GAAA,qBACAuH,KAAA,YAOAiT,sBACAa,UAAA,EACAtQ,QAAA/K,GAAA,iBACAuH,KAAA,UAEA8T,UAAA,GACAtQ,QAAA/K,GAAA,qBACAuH,KAAA,YAEA8T,UAAA,GACAtQ,QAAA/K,GAAA,kBACAuH,KAAA,YAOAmT,mBACAW,UAAA,EACAtQ,QAAA/K,GAAA,oBACAuH,KAAA,UAEA8T,UAAA,GACAtQ,QAAA/K,GAAA,wBACAuH,KAAA,YAEA8T,UAAA,GACAtQ,QAAA/K,GAAA,qBACAuH,KAAA,YAOAqT,oBACAS,UAAA,EACAtQ,QAAA/K,GAAA;AACAuH,KAAA,UAEA8T,UAAA,GACAtQ,QAAA/K,GAAA,yEACAuH,KAAA,YAEA8T,UAAA,GACAtQ,QAAA/K,GAAA,mCACAuH,KAAA,WA6EA,OAAA4S,2BC1JAvb,OAAA,6CAAA,WACA,YAQA,IAAA4c,eAAA,SAAArN,MAAAsN,UACA,GAAAC,OAAAjP,KAAAkP,IAAA,GAAAlP,KAAAmP,IAAAH,UAAA,GACA,OAAAhP,MAAA0O,MAAA5M,OAAAJ,OAAAuN,OAAAA,OAAA,EAGA,OAAAF,iBCdA5c,OAAA,mCACA,SACA,2CACA,SAAAmB,EAAAyb,eACA,YASA,IAAAjV,OAAA,SAAA8C,KAAAwS,UAAAJ,UACA,GAIAK,UAGAC,IACAC,IACAC,OACAC,SACAC,QAXAC,IAAA,EACAC,KAAA,EACA3P,IAAA6B,OAAA+N,UACA9M,IAAA,EAEAxG,MAAA,EACAuT;AA8DA,MAtDAL,UADAnc,EAAAqT,WAAAyI,WACAA,UAEA,SAAAW,MACA,MAAAA,OAAAA,KAAAX,YAAA,GAKA9b,EAAA+I,QAAAO,KAAA,SAAAmT,MACA,GAAArO,MACAsL,UAAA+C,OACArO,MAAA+N,SAAAM,MACAD,OAAAxJ,KAAA5E,OACAzB,IAAAD,KAAAC,IAAAA,IAAAyB,OACAqB,IAAA/C,KAAA+C,IAAAA,IAAArB,OACAiO,KAAAjO,MACAnF,WAKA+S,IAAAK,KAAApT,OAAA,GAGAjJ,EAAA+I,QAAAyT,OAAA,SAAApO,OACA,GAAAsO,MAAAtO,MAAA4N,GACAM,OAAAI,KAAAA,OAIAX,SAAA9S,MAAA,EAAAyD,KAAAiQ,KAAAL,MAAArT,MAAA,IAAA,EAGAuT,OAAAI,OACAV,OAAAjT,MAAA,EACAgT,KAAAO,OAAA9P,KAAAmQ,MAAAX,SAAAM,OAAA9P,KAAAoQ,KAAAZ,UAAA,EAEAE,SACAzP,IAAAA,IACA8C,IAAAA,IACA4M,IAAAA,IACApT,MAAAA,MACA8T,QAAAf,IACAgB,OAAAf,IACAF,SAAAA,UAGAL,UACA1b,EAAA+I,QAAAqT,QAAA,SAAAhO,MAAA6O,KACAb,QAAAa,KAAAxB,cAAArN,MAAAsN;AAIAU,QAAAI,OAAAlT,KACA8S,QAGA,OAAA5V,SAGA3H,OAAA,wCAAA,WC3GA,OACAqe,WAAA,oCACAC,eAAA,+BACAC,mBAAA,6CACAC,oBAAA,sDACAC,WAAA,qCACAC,KAAA,+BACAC,IAAA,8BACAC,OAAA,iCACAC,mBAAA,uDACAC,oBAAA,wDACAC,YAAA;AACAC,kBAAA,oDACAC,IAAA,sCACAC,OAAA,yCACAC,QAAA,0CACAC,cAAA,gDACAC,QAAA,0CACAC,aAAA,+CACAC,uBAAA,yDACAC,aAAA,+CACAC,qBAAA,4DACAC,kBAAA;AACAC,sBAAA,6DACAC,wBAAA,+DACAC,oBAAA,2DACAC,4BAAA,mEACAC,2BAAA,kEACAC,wBAAA,+DACAC,mBAAA,0DACAC,mBAAA;AACAC,wBAAA,+DACAC,iBAAA,wDACAC,iBAAA,wDACAC,iBAAA,wDACAC,OAAA,8CACAC,uBAAA,8DACAC,kBAAA,yDACAC,qBAAA,4DACAC,kBAAA;AACAC,cAAA,kDACAC,eAAA,mDACAC,cAAA,kDACAC,kBAAA,yDACAC,YAAA,8CACAC,QAAA,qCCxBAjhB,OAAA,kCAAA,UAAA,SAAAmB,GACA,YAEA,IAAA+f,OAEAC,YAAA,SAAAC,QAGA,IAAA,GAFApf,IAAAof,QAAA,GACAC,MAAA,uCACAhF,EAAA,EAAAA,EAAA,GAAAA,IACAra,IAAAqf,MAAAC,OAAAzT,KAAAmQ,MAAAnQ,KAAA0T,SAAAF,MAAAhX,QAEA,OAAArI,KAUAwf,QAAA,SAAA5D,KAAAwD,QACA,GAAApf,IACAyf,QACApF,EAAA,EACAqF,OAAA,GACAC,QAAA;AAEA,IAAA/D,KACA,KAAA,IAAA9F,WAAA,qDAGA2J,SAAA7D,KAAAgE,YAEA,GACAD,SAAA,EACA3f,GAAAof,OAAAM,OACAvgB,EAAA0gB,SAAAJ,QAAAzf,MACA2f,QAAA,EACAD,OAAA,IAAArF,EACAA,WAEAsF,OAEA,OAAA3f,KAWA8f,gBAAA,SAAAlE,KAAAwD,OAAAW,WAEA,GAAA/f,IACAyf,QACAC,OAAA,GACArF,EAAA,EACAsF,QAAA,CAEA,KAAA/D,KACA,KAAA,IAAA9F,WAAA,qDAGA,KAAAsJ,OACA,KAAA,IAAAtJ,WAAA,4CAGA2J,SAAA7D,KAAAoE,qBACAD,YAAA5gB,EAAA8gB,YAAAF,YAAAA,UAEAX,SACAA,OAAAA,OAAA5c,QAAA,aAAA,KACAA,QAAA,kBAAA,KACAA,QAAA,SAAA,KACAud,YACAL,OAAA,IAAArF;AAIA,EACAsF,SAAA,EACA3f,GAAAof,OAAAM,OACAD,QAAAzf,MACA2f,QAAA,EACAD,OAAA,IAAArF,EACAA,WAEAsF,OAEA,OAAA3f,KAGAkgB,iBAAA,SAAAC,QAAAC,gBAAAC,gBAEA,GAAAC,OAAA,IAMA,IAJAnhB,EAAAqb,SAAA4F,mBACAA,iBAAAA,mBAGAjhB,EAAAqK,QAAA4W,iBAoCA,KAAA,IAAAG,OAAA,kEAGA,OArCAphB,GAAA4M,KAAAqU,gBAAA,SAAAI,gBAGA,GAAAC,YAAAN,OACAhhB,GAAA4M,KAAAyU,eAAAE,MAAA,KAAA,SAAAC,WACAF,WAAAA,WAAAE,YAEA,IAAAC,KAAAH,WAAAJ,eAEA,OAAAO,MACAN,OAAAO,OAAAV,QAAAA,QAAAS,MACA,IAIAzhB,EAAA4M,KAAA0U,WAAA,SAAAG,KAEA,GAAAzhB,EAAAqT,WAAAoO,IAAAlhB,QACA4gB,MAAAM,IAAAlhB,KAAA2gB,iBAEA,OAAA;IAMAC,OAAA,UAWAA,OAEAQ,mBAAA,SAAAC,OAAAC,IACA,MAAAA,IACAD,OAAAA,OAAAve,QAAA,iCAAA,SAAAye,GAAAC,GAAAC,GAAAC,GAAAC,IACA,MAAAF,IAAAG,QAAA,KAAA,EACAL,IAEAC,GAAAA,IAAA,GACAE,GAAAA,IAAA,GACA,IAAAF,GAAAF,GAAA,IAAAG,GAAAC,GAAAC,GAAA,OAIAN,QAGAQ,uBAAA,SAAAR,QACA,MAAAA,QAAAve,QAAA,wBAAA,WAEAgf,wBAAA,SAAAT,QACA,GAAAU,cAKA,OAJAV,QAAAve,QAAA,wBAAA,SAAAkf,SAAAC,MAAAX,GAAAY,MAEA,MADAH,YAAAtP,KAAA6O,IACA,IAAAW,MAAAC,KAAA,MAEAziB,EAAAgW,KAAAsM,aAIA,OAAAvC,QAGAlhB,OAAA,4CAAA,SAAA,UAAA,SAAAmB,EAAAoF,GCpMA,GAAAsd;AA8BA,MA5BAA,sBAAAC,wBAAA,SAAAC,MAEA,GAAA1e,UACAf,QACAwQ,YAAA,KACAkP,SAAA,GACAC,SAAA,KAmBA,OAhBA9iB,GAAA4M,KAAAgW,KAAA,SAAAG,KACAA,MACAA,IAAAC,WACA9e,QAAA4e,SAAAC,IACAA,cAAA3d,IAAA2d,IAAA7Z,OACAhF,QAAAyP,YAAAoP,IACA/iB,EAAAqb,SAAA0H,KACA7e,QAAA2e,SAAAE,IACA/iB,EAAAoK,cAAA2Y,KACA7e,QAAAf,KAAA4f,IAEApJ,QAAAC,IAAA,cAAAmJ,IAAAH,SAKA1e,SAGAwe,uBCdA7jB,OAAA,mCACA,SACA,SACA,QACA,iCACA,4CACA,SAAAuG,EAAApF,EAAAijB,MAAAlD,KAAAmD,gBACA,YAEA,IAAAC,eAEAC,QAAAH,MAAAI,QACAC,SAAA,GACAC,OAAA,GACAC,YAAA;AACArT,KAAA,SAAAoT,OAAAE,YAkBA,GAfA5f,KAAA4f,cAGA5f,KAAA6f,YAGA,gBAAA,UACAD,WAAAF,OACAA,OAAA,IAGAA,SACAA,OAAAxD,KAAAC,YAAAnc,KAAAyf,SAAA,MAGAC,SAAA,gBAAAA,UAAAA,OAAAI,MAAA,kBACA,KAAA,+BAAAJ,QAAA,KAAAA,MAGA,IAAAJ,WAAAI,QAKA,KAAA,qDAAAA,MAJAJ,YAAAI,QAAA1f,KACAA,KAAA0f,OAAAA,OACA1f,KAAA+f,cAAAH,gBAKA,kBAAA5f,MAAAggB,eACAhgB,KAAAggB,cAAA/J,UAAA,IAAA,IAEA,kBAAAjW,MAAAigB,YACAjgB,KAAAigB,cAGAC,GAAA,SAAAT,UACA,MAAAA,YAAAzf,KAAAyf,UAEA3P,YAAA;AACA,MAAA,KAAA9P,KAAA0f,OAAA,MAEAS,UAAA,WACA,MAAAngB,MAAA0f,QAEA1C,mBAAA,WACA,GAAAP,YACA2D,KAAApgB,KAAAqgB,sBACA,KAAA,GAAAhJ,KAAA+I,MAAA,CACA,GAAAxC,KAAAwC,KAAA/I,GACAra,GAAA4gB,IAAA5S,KAAA,aACAhO,MAEAyf,QAAAzf,IAAA4gB,KAGA,MAAAnB,UAOAG,WAAA,WACA,GAAAH,WAOA,OANAtgB,GAAA+I,QAAAlF,KAAAqgB,uBAAA,SAAAzC,KACA,GAAA5gB,IAAA4gB,IAAA5S,KAAA,KACAhO,MAAAb,EAAA0gB,SAAAJ,QAAAzf,KACAyf,QAAAtN,KAAAnS,MAGAyf,SAGAzR,KAAA,SAAAkM,KAAA3M,OACA,GAAA2M,KACA,GAAArB,SAAAtL,MACAvK,KAAA4f,WAAA1I,MAAA3M,UAEA,IAAA,gBAAA,MACA,IAAA,GAAA+V,QAAApJ,MACAlX,KAAAgL,KAAAsV,KAAApJ,KAAAoJ,WAEA,IAAA,gBAAA,MACA,MAAAzK,UAAA7V,KAAA4f,WAAA1I,MACA,OAEAlX,KAAA4f,WAAA1I;AAKA,MAAAlX,OAEAV,KAAA,SAAA4X,KAAA3M,OACA,GAAA2M,KACA,GAAArB,SAAAtL,MACAvK,KAAA6f,SAAA3I,MAAA3M,MACAhJ,EAAAgf,UAAAlV,QAAA,yBAAA8R,QAAAnd,KAAAoZ,IAAAlC,KAAA3M,MAAAA,YAEA,IAAA,gBAAA,MACA,IAAA,GAAA+V,QAAApJ,MACAlX,KAAAV,KAAAghB,KAAApJ,KAAAoJ,WAEA,IAAA,gBAAA,MACA,MAAAzK,UAAA7V,KAAA6f,SAAA3I,MACA,OAEAlX,KAAA6f,SAAA3I,KAKA,OAAAlX,OAEAwgB,WAAA,SAAAtJ,MAEA,aADAlX,MAAA6f,SAAA3I,MACAlX,MAEAkL,WAAA,SAAAgM,MACA,MAAAlX,MAAAygB,iBAAAvJ,OAEA6I,cAAA,SAAAH,YAEA,MADA5f,MAAA4f,WAAAA,WACA5f,MAEA0gB,cAAA,WACA,MAAAvkB,GAAAwb,MAAA3X,KAAA4f,aAEAa,iBAAA,SAAAE,WACA,gBAAA,aACAA,WAAAA;AAEA,IAAA,GAAAtJ,KAAAsJ,iBACA3gB,MAAA4f,WAAAe,UAAAtJ,GAEA,OAAArX,OAEAqgB,qBAAA,WAEA,QAAAO,QAAAzD,SACAiD,KAAAjD,QAAAgD,aAAAhD,QACAiD,KAAAjkB,EAAAqjB,OAAAY,KAAAjD,QAAAkD,wBAHA,GAAAD,QAsBA,OAjBA,kBAAApgB,MAAAggB,eACAY,OAAA5gB,KAAA6gB,WAEA,kBAAA7gB,MAAAigB,YACAW,OAAA5gB,KAAA8gB,aAEA3kB,EAAA4M,KAAA/I,KAAA6f,SAAA,SAAA3N,GACAqN,QAAAwB,IAAA7O,EAAA,cACA0O,OAAA1O,GACA/V,EAAAqK,QAAA0L,IACA/V,EAAA4M,KAAAmJ,EAAA,SAAAA,GACAqN,QAAAwB,IAAA7O,EAAA,eACA0O,OAAA1O,OAKAkO,MAEAY,eAAA,WAEA,GAAAC,MAAAjhB,KAAAyf,UACAyB,cAAAlhB,KAAAqgB,sBAMA,OAJAlkB,GAAA4M,KAAAmY,cAAA,SAAAtD,KACAqD,IAAA9R,KAAAyO,IAAA6B;GAGAtjB,EAAAgW,KAAA8O,MAEAvkB,KAAA,SAAAgjB,QAEA,GAAApC,OAAA,IAEA,IAAA,kBAAAtd,MAAAigB,WAAA,CACA,GAAArG,QAAA5Z,KAAA8gB,WACAlH,QAAA8F,SAAAA,SACApC,OAAAO,OAAA7d,KAAAmd,QAAAvD,OAAA9R,SAAA,WAQA,MAJAwV,QAAA,kBAAAtd,MAAAggB,gBACA1C,MAAAtd,KAAA6gB,UAAAnkB,KAAAgjB,OAAA1f,OAGAsd,OAEAO,OAAA,WACA,GAAAjF,MAAA5Y,KAAAmhB,gBACA,IAAAvI,KAAA,CACA,GAAA0E,OAAA1E,KAAAlc,KAAAsD,KAAAmgB,YACA,IAAA7C,MACA,MAAAA,OAAAO,OAGA,MAAA,OAEAuD,eAAA,SAAAxI,KAAAyI,WAIA,GAFAA,UAAA,mBAAAA,YAAAA,UAEA9B,QAAAwB,IAAAnI,KAAA,kBAAA,CACA5Y,KAAA2f,YAAA/G,IACA,IAAAsI,eAAAlhB,KAAAqgB,sBACA,KAAA,GAAAhJ,KAAA6J,eACAA,cAAA7J,GAAA+J,eAAAxI,MAAA;GAKAuI,eAAA,WACA,GAAAF,KAAA,IAIA,OAHA1B,SAAAwB,IAAA/gB,KAAA2f,YAAA,oBACAsB,IAAAjhB,KAAA2f,aAEAsB,KAEAK,YAAA,SAAArC,UACA,IAAAA,WAAAA,SAAAE,WAOA,KAAA,8BANAnf,MAAAif,SAAAA,QACA,IAAAmB,MAAApgB,KAAAqgB,sBACA,KAAA,GAAAX,UAAAU,MACAA,KAAAV,QAAA4B,YAAArC,WAMAsC,YAAA,WACA,MAAAvhB,MAAAif,UAEAuC,OAAA,WAEA,GAAAzC,MAAAM,eAAAP,wBAAA7I,WACAwL,UAAA1C,KAAAE,UAAAjf,KAAAuhB,cAEA7e,WACAgf,aACAC,IAAA3hB,KAAAyf,SACAC,OAAA1f,KAAA0f,OACAE,WAAA5f,KAAA0gB,gBAGA,KAAAe,UACA,KAAA,6CAAAzhB,KAAAyf,SAAA,IAAAzf,KAAA0f;AAGA,kBAAA1f,MAAAggB,gBAEA0B,YAAAE,KAAA5hB,KAAA6gB,UAAAW,OAAAzC,KAAAE,WAEA,kBAAAjf,MAAAigB,aACAyB,YAAA9H,QACAgG,WAAA5f,KAAA4Z,OAAA8G,iBAEAgB,YAAA9H,OAAAgG,WAAAtgB,KAAAmiB,UAAAI,WAAA7hB,KAAA4Z,OAAA5O,KAAA,UAGAtI,QAAAvG,EAAA+D,MAAAwhB,YAAA3C,KAAAzf,UACAoD,QAAA+e,UAAAK,QAAA9hB,KAAA0C,QAAAqc,KAAAC,SACA,IAAA+C,WAAAN,UAAAO,UAAAhiB,KAAA0C,QAAAqc,KAAAC,SAKA,OAJAD,MAAAjP,aACAiP,KAAAjP,YAAAmS,YAAAF,WAGAA,WAEAG,WAAA,SAAA5iB,KAAA6iB,aAAAlD,UAEA,GAAAmD,kBACAX,UAAAxC,UAAAjf,KAAAuhB,aAOA,IALA,kBAAAvhB,MAAAggB,gBAEAoC,cAAApiB,KAAA6gB,UAAAqB,cAAA,GAAAjD;CAGAwC,UAGA,KAAA,iDAAAzhB,KAAAyf,SAAA,IAAAzf,KAAA0f,MAGA,OALA0C,eAAAjT,KAAAsS,UAAAS,WAAAliB,KAAAV,KAAA6iB,eAKAhmB,EAAAkmB,QAAAD,gBAEAE,aAAA,SAAAC,OAAAvD,UACA,GAAAC,UAAAjf,KAAAuhB,aACA,IAAAtC,SACA,MAAAA,UAAAqD,aAAAtiB,KAAAuiB,OAAAvD,SAEA,MAAA,mDAAAhf,KAAAyf,SAAA,IAAAzf,KAAA0f,QAGA8C,QAAA,WACA,GAAAC,MACA/C,OAAA1f,KAAA0f,OACA/b,KAAA3D,KAAAyf,SACAG,WAAA5f,KAAA0gB,gBAUA,OAPA,kBAAA1gB,MAAAggB,gBACAyC,IAAAb,KAAA5hB,KAAA6gB,UAAA2B,WAEA,kBAAAxiB,MAAAigB,aACAwC,IAAA7I,OAAA5Z,KAAA4Z,OAAA4I,WAGAC;EAEAC,QAAA,WAEA,OAAA,GAEA7W,SAAA,SAAA8W,WACA,GAAAC,OAAA5iB,KAAAgL,KAAA,UAAA,EACA6X,eAAAD,MAAAD,YACA3iB,KAAAgL,KAAA,QAAA4X,OAAAA,MAAAvd,OAAA,IAAA,IAAAsd,YAGAG,SAAA,SAAAH,WACA,MAAAE,eAAA7iB,KAAAgL,KAAA,SAAA2X,YAEAtW,YAAA,SAAAsW,WAEA,GAAAC,OAAA5iB,KAAAgL,KAAA,UAAA,EACA,IAAA4X,MAAA,CAEA,GAAAG,OAAA,GAAAC,QAAA,YAAAL,UAAA,YACAC,OAAAA,MAAApjB,QAAAujB,MAAA,KAAArY,OAEAkY,MACA5iB,KAAAgL,KAAA,QAAA4X,OAEA5iB,KAAAkL,WAAA,WAWA+X,YAAA,SAAAN,UAAAtlB,OAEA,MAAA,iBAAAA,OACAA,MAAA2C,KAAA6L,SAAA8W,WAAA3iB,KAAAqM,YAAAsW,WAGA3iB,KAAA8iB,SAAAH,WACA3iB,KAAAqM,YAAAsW,WAEA3iB,KAAA6L,SAAA8W;EAEAO,MAAA,WACA,MAAA3D,SAAA4D,aAAAnjB,KAAA0f,SAEA0D,MAAA,WACA,MAAA7D,SAAA8D,aAAArjB,KAAA0f,WAIAmD,cAAA,SAAAS,YAAAX,WACA,GAAAI,OAAA,GAAAC,QAAA,YAAAL,UAAA,YAAA,GACA,OAAAW,cAAAP,MAAAQ,KAAAD,aAsCA,OAlCA/D,SAAAwB,IAAA,SAAAyC,WAAA/D,UACA,MAAA+D,sBAAAjE,UAAAiE,WAAAtD,GAAAT,WAGAF,QAAAkE,mBAAA,SAAA/D,QACA,MAAAJ,YAAAI,SAGAH,QAAA4D,aAAA,SAAAzD,QACA,QAAAJ,WAAAI,SAQAH,QAAA8D,aAAA,SAAA3D,QAEA,GAAAvC,SAAAoC,QAAAkE,mBAAA/D,OAEA,IAAAvC,QAAA,CAEA,GAAAuG,mBAAAvG,QAAAkD;AAMA,MALAlkB,GAAA4M,KAAA2a,kBAAA,SAAA9F,WACA0B,YAAA1B,IAAA8B,gBAEAJ,YAAAnC,QAAAuC,SAEA,EAEA,OAAA,GAGAH,UCtaAvkB,OAAA,kCAAA,SAAA,QAAA,qCAAA,mCAAA,SAAAmB,EAAAijB,MAAAuE,WAAApE,SA+XA,QAAAqE,+BAAAC,gBAAAvkB,MACAukB,gBAAAC,eAAAxkB,KAAAwkB,eACAD,gBAAA9F,OAAAze,KAAAye,OACA8F,gBAAAE,WAAAzkB,KAAAykB,WACAF,gBAAAphB,WAAAnD,KAAAmD,WACAohB,gBAAAG,UAAA1kB,KAAA0kB,UAlYA,GAAAC,QAAA7E,MAAAI,QACAlT,KAAA,SAAAsM,KAAAsL,iBAEAlkB,KAAAmkB,OACAnkB,KAAAkkB;AAEAlkB,KAAA4Y,KAAAA,MAAA,KACA5Y,KAAAokB,mBAAAF,iBAAAP,aAEAS,mBAAA,SAAAT,YAEA,MADAxnB,GAAAqjB,OAAAxf,KAAAkkB,gBAAAP,YACA3jB,MAEAqkB,mBAAA,SAAA/kB,MACA,GAAA2hB,OACA,KAAA,GAAA5J,KAAA/X,MACA,aAAA+X,GAAA,eAAA/X,KAAA+X,IAAA,gBAAAA,EACA4J,IAAA9R,KAAA7P,KAAA+X,IACA,gBAAA/X,MAAA+X,IAAA,kBAAAA,IACA4J,IAAA9kB,EAAAmoB,MAAArD,IAAAjhB,KAAAqkB,mBAAA/kB,KAAA+X,KAGA,OAAA4J,MAEAsD,oBAAA,SAAAjlB,KAAA+R,SAAAmT,QAEA,GAAAC,iBAAAzkB,KAAAqkB,mBAAA/kB,KAAAklB,QAAAE,WAEA,KAAA,GAAArN,KAAAoN,iBAAA,CACA,GAAAE,eAAAF,gBAAApN,EACA,KAAArX,KAAAkkB,gBAAAS,eAGA,KAAA,IAAApH,OAAA,4CAAAoH;AAFAD,SAAAvV,KAAAnP,KAAAkkB,gBAAAS,gBAMA,GAAAC,OAAA5kB,IACA6kB,SAAAH,SAAA,WACAvoB,EAAA4M,KAAAkN,UAAA,SAAA6O,UACAF,MAAAT,IAAAW,SAAAC,UAAAtF,UAAAqF,WAEAzT,SAAA3Q,KAAAkkB,MAAAA,MAAAT,QAGAa,iBAAA,WACA,MAAA7oB,GAAA8oB,KAAAjlB,KAAAmkB,MAEAe,aAAA,SAAA5lB,KAAA+R,UAEA,GAAAuT,OAAA5kB,IACA4kB,OAAAL,oBAAAjlB,KAAA,SAAA6lB,KACA,GAAA9N,EACA,IAAA,gBAAA,OAAA,mBAAA/X,KAAAmgB,SAAA,CAGAngB,KAAAogB,QACAH,QAAA8D,aAAA/jB,KAAAogB,QAGAkF,MAAAhM,KAAA,GAAAuM,KAAA7L,eAAAha,KAAAogB,OAAApgB,KAAAsgB,gBACAgF,MAAAQ,cAAAR,MAAAhM,KAAAiI,UAAAvhB,KAAAsiB,KAEA,KAAAvK,IAAA/X,MAAA+lB,SAAA,CACA,GAAAC,SAAAV,MAAAW,aAAAjmB,KAAA+lB,SAAAhO;AACAiO,SACAV,MAAAhM,KAAA4M,sBAAAF,SAGA,IAAAjO,IAAA/X,MAAAmmB,UAAA,CACA,GAAA9jB,UAAAijB,MAAAc,aAAApmB,KAAAmmB,UAAApO,GACA1V,WACAijB,MAAAhM,KAAA+M,iBAAAhkB,UAGA,IAAA0V,IAAA/X,MAAAsmB,YAAA,CACA,GAAAnM,YAAAmL,MAAAc,aAAApmB,KAAAsmB,YAAAvO,GACAoC,aACAmL,MAAAhM,KAAAiN,cAAApM,YAKA,IAAApC,IAAA/X,MAAAwmB,UAAA,CACA,GAAAhhB,UAAA8f,MAAAmB,cAAAzmB,KAAAwmB,UAAAzO,GACA,IAAAvS,SAAA,CACA8f,MAAAhM,KAAAoN,uBAAAlhB,SAEA,IAAAmhB,eAAA3mB,KAAAwmB,UAAAzO,GAAA4O,aACAA,gBACA9pB,EAAAiW,MAAA6T,cAAA,SAAAC,OAAAxG,QACA5a,SAAAmhB,cAAAvG,QAAAkF,MAAAuB,wBAAAD,OAAAphB,aAMAxF,KAAAia,oBACAqL,MAAAhM,KAAAwN,sBAAAxB,MAAAyB,wBAAA/mB,KAAAia;AAEAqL,MAAAhM,KAAA0N,cAAAhnB,KAAAmf,YACAmG,MAAAhM,KAAA2N,mBAAAjnB,KAAAknB,iBACA5B,MAAAhM,KAAA6N,qBAAAnnB,KAAAonB,mBAGA,kBAAA,WACArV,SAAA3Q,KAAAkkB,MAAAA,MAAAhM,SAIA+N,oBAAA,SAAArnB,KAAA+R,UAEA,GAAAuT,OAAA5kB,IAEA4kB,OAAAL,oBAAAjlB,KAAA,SAAA6lB,KAEA,GAAAhI,SAAAyH,MAAAc,aAAApmB,KAEA,mBAAA,WACA+R,SAAA3Q,KAAAkkB,MAAAzH,YAIAyJ,YAAA,SAAAzJ,QAAA7d,KAAA+R,UAEA,GAAAuT,OAAA5kB,IACAA,MAAAukB,oBAAAjlB,KAAA,WACAslB,MAAAiC,gBAAA1J,QAAA7d,MACA,kBAAA,WACA+R,SAAA3Q,KAAAkkB,MAAAzH,YAYA2J,aAAA,SAAAxnB,KAAA+R,UAEA,GAAAuT,OAAA5kB,IAEA,KAAA4kB,MAAAhM,KAqBA,KAAA;AAnBA5Y,KAAAukB,oBAAAjlB,KAAA,WAEA,GAAAynB,aAAAnC,MAAAhM,KAAAyH,sBAEA,KAAA,GAAAhJ,KAAA/X,MAAA,CACA,GAAA0nB,aAAA1nB,KAAA+X,EACA2P,cAAAA,YAAAvH,UAAAuH,YAAAtH,QAEAqH,YAAAC,YAAAtH,SACAkF,MAAAiC,gBAAAE,YAAAC,YAAAtH,QAAAsH,aAKA,kBAAA,WACA3V,SAAA3Q,KAAAkkB,MAAAA,MAAAhM,SAQAmN,cAAA,SAAAzmB,MAEA,GAAAwF,UAAA9E,KAAA0lB,aAAApmB,KAgBA,OAdAwF,UAAAnF,SAAAL,KAAA2nB,UAAA,KACAniB,SAAAoiB,aAAA5nB,KAAA4nB,cAAA,KACApiB,SAAAqiB,gBAAA7nB,KAAA8nB,kBAAA,KAEAjrB,EAAAkrB,KAAA/nB,KAAAgoB,SACAxiB,SAAAyiB,WAAAjoB,KAAAgoB,QACAnrB,EAAAkrB,KAAA/nB,KAAAkoB,aACA1iB,SAAAyiB,WAAAjoB,KAAAkoB,YAEA1iB,SAAAyiB;AAGAziB,SAAA2iB,kBAAAnoB,KAAAmoB,sBAEA3iB,UAEAqhB,wBAAA,SAAA7mB,KAAAwF,UAEA,GAAA4iB,cAAA1nB,KAAA0lB,aAAApmB,KAEAooB,cAAAC,aAAA7iB,SAAAxF,KAAAsoB,UAAAtoB,KAAAuoB,eAAA,MAGAH,aAAAI,gBAAA9nB,KAAA4Y,KAAAyM,SAAA/lB,KAAAwoB,kBAAA,KACAJ,aAAAK,aAAA/nB,KAAA4Y,KAAAoP,eAAA1oB,KAAAyoB,eAAA,KACAL,aAAAO,aAAAjoB,KAAA4Y,KAAAoP,eAAA1oB,KAAA2oB,eAAA,IAGA,IAAAnjB,UAAA4iB,aAAAQ,eAQA,OAPAR,cAAAK,cACAL,aAAAK,aAAAzoB,KAAA,kBAAAwF,UAEA4iB,aAAAO,cACAP,aAAAO,aAAA3oB,KAAA,kBAAAwF;AAGA4iB,cAEAnC,aAAA,SAAAjmB,MACA,GAAAgmB,SAAAtlB,KAAA0lB,aAAApmB,KAEA,OADAgmB,SAAA4B,aAAA5nB,KAAA4nB,cAAA,KACA5B,SAEAe,wBAAA,SAAA/mB,MACA,GAAA6oB,IAAAnoB,KAAA0lB,aAAApmB,KASA,OARAA,OAAAA,KAAA8oB,iBACA,WAAA9oB,KAAA8oB,gBACAD,GAAAE,IAAA/oB,KAAAA,KACA6oB,GAAAC,eAAA,UAEAD,GAAAC,eAAA,kBAGAD,IAEA/C,cAAA,SAAAkD,WAAAC,UACA,IAAAhJ,QAAAwB,IAAAuH,WAAA,cACA,KAAA,oCAGA,KAAAC,UAAA,gBAAAA,UAAA3G,MAAA,eAAA2G,UAAAC,UAAA,gBAAAD,UAAAC,SAWA,KAAA,uBAVA,KAAA,GAAA9I,UAAA6I,UAAAC,SAAA;AACA,GAAAC,SAAAF,SAAAC,SAAA9I,QAEAvC,QAAAnd,KAAA0lB,aAAA+C,QACAtL,UACAmL,WAAAI,WAAAvL,QAAAoL,SAAA3G,MAGA0G,WAAA1G,KAAA2G,SAAA3G,OAKA8D,aAAA,SAAAsB,aACA,GAAApJ,KAAA,IACA,MAAAoJ,aAAAA,YAAAvH,UAAAuH,YAAAtH,QASA,KAAA,0BARA,IAAAiD,WAAAqE,YAAAvH,QACA,KAAAzf,KAAAmkB,IAAAxB,WAIA,KAAA,yCAAAA,SAKA,OARA/E,KAAA,GAAA5d,MAAAmkB,IAAAxB,WAAAqE,YAAAtH,QACA1f,KAAA6mB,gBAAAjJ,IAAAoJ,aAOApJ,KAEAiJ,gBAAA,SAAA1J,QAAA7d,MAGA,GAAAsgB,YAAAzjB,EAAA4N,SAAAzK,KAAAsgB,eAAAzC,QAAAyC,eAyBA,OAxBAzC,SAAA4C,cAAAH,YAEAzC,QAAAyE,MAAAtiB,KAAAsiB,MACAzE,QAAAwL,KACA3oB,KAAAolB,cAAAjI,QAAA0D,UAAAvhB,KAAAsiB;AAIAzE,QAAAvD,QAAAta,KAAAsa,QACAuD,QAAAvD,QACA5Z,KAAA4oB,eAAAzL,QAAAvD,OAAAta,KAAAsa,QAIA2F,QAAAwB,IAAA5D,QAAA,eACAnd,KAAA6oB,oBAAA1L,QAAA7d,MACAigB,QAAAwB,IAAA5D,QAAA,UACAnd,KAAA8oB,eAAA3L,QAAA7d,MACAigB,QAAAwB,IAAA5D,QAAA,QACAnd,KAAA+oB,aAAA5L,QAAA7d,MACAigB,QAAAwB,IAAA5D,QAAA,gBACAnd,KAAAgpB,YAAA7L,QAAA7d,MAGA6d,SAEA0L,oBAAA,SAAAI,YAAA3pB,MACAigB,QAAAwB,IAAAkI,YAAA,qBACA3pB,KAAAic,QACAvb,KAAAolB,cAAA6D,YAAA1N,OAAAsF,UAAAvhB,KAAAic,QAIAvb,KAAAkpB,wBAAAD,YAAA3pB,MAEAigB,QAAAwB,IAAAkI,YAAA,sBACAjpB,KAAAmpB,YAAAF,YAAA3pB,OAGA4pB,wBAAA,SAAAD,YAAA3pB;AAGA,GAAAA,KAAA8pB,QAAA,CACA,GAAA7J,QAAAwB,IAAAkI,YAAA,oBACA,IAAA,GAAAI,KAAA,EAAAA,IAAA,EAAAA,MAAA,CACA,IAAA/pB,KAAA8pB,QAAAC,KACA,KAAA,sBAAAA,GAEA,IAAAC,UAAAhqB,KAAA8pB,QAAAC,IACA,KAAA,GAAA3J,UAAA4J,UAAA,CACA,GAAAC,QAAAvpB,KAAA0lB,aAAA4D,SAAA5J,QACA6J,SACAN,YAAAO,UAAAD,OAAAF,UAKA,KAAA,GAAA3J,UAAApgB,MAAA8pB,QAAA,CACA,GAAAG,QAAAvpB,KAAA0lB,aAAApmB,KAAA8pB,QAAA1J,QACA6J,SACAN,YAAAO,UAAAD,QAKA,GAAAhK,QAAAwB,IAAAkI,YAAA,+BACA3pB,KAAAmqB,QACA,IAAA,GAAA/J,UAAApgB,MAAAmqB,QAAA,CACA,GAAAvP,QAAAla,KAAA0lB,aAAApmB,KAAAmqB,QAAA/J,QACAxF,SACA+O,YAAAS,UAAAxP,WASA4O,eAAA,SAAAS,OAAAjqB,MACAigB,QAAAwB,IAAAwI,OAAA,sBACAA,OAAA9e,IAAAnL,KAAAwP,MACAyQ,QAAAwB,IAAAwI,OAAA,WAEAhK,QAAAwB,IAAAwI,OAAA;EAIAX,eAAA,SAAAhP,OAAAta,MACAsa,OAAAmG,cAAAzgB,KAAAsgB,YAEAtgB,KAAAqqB,OACA,WAAArqB,KAAAqqB,KAAAlK,SACA7F,OAAA+P,KAAA1F,OAAAyB,aAAApmB,KAAAqqB,MAEA/P,OAAA+P,KAAArqB,KAAAqqB,OAIAZ,aAAA,SAAArP,KAAApa,MACAoa,KAAAsE,GAAA1e,KAAA0e,OACAtE,KAAAkQ,UAAAtqB,KAAAuqB,QAAA,IACA1tB,EAAAiW,MAAA9S,KAAAwqB,gBAAA,SAAAvf,MAAAwf,UACArQ,KAAAsQ,cAAAD,SAAAxf,UAGA4e,YAAA,SAAAc,IAAA3qB,MACAskB,8BAAAqG,IAAA3qB,OAEA0pB,YAAA,SAAAkB,IAAA5qB,MACAskB,8BAAAsG,IAAA5qB,QAYA,OAAA2kB,UCvZAjpB,OAAA,+CAAA,SAAA,mCAAA,SAAAmB,EAAAojB,SACA,OACA4K,eAAA,SAAAf,QAAAgB;AAEA,GAAAnJ,QAAA2D,MAAA5kB,IAoBA,OAlBA7D,GAAA4M,KAAAqgB,QAAA,SAAAiB,GACA,GAAA9K,QAAAwB,IAAAsJ,EAAA,UACA,OAAAD,YACA,IAAA,SACAnJ,IAAA9R,KAAAkb,EAAAlK,YACA,MACA,KAAA,aACAc,IAAA9R,KAAAkb,EAAArtB,KACA,MACA,SACAikB,IAAA9R,KAAAkb,OAGAluB,GAAAqK,QAAA6jB,IACApJ,IAAA9R,KAAAyV,MAAAuF,eAAAE,EAAAD,eAIAnJ,KAEAqJ,YAAA,SAAArB,YAAAG,QAAAmB,WAEA,GAAAtJ,QAAA2D,MAAA5kB,IAyBA,OAvBA7D,GAAA4M,KAAAqgB,QAAA,SAAAiB,GACA,GAAAd,OACAptB,GAAAqb,SAAA6S,GACA,WAAAE,WACAhB,OAAAN,YAAAuB,UAAAH,GACAd,QACAtI,IAAA9R,KAAAoa,SAEA,eAAAgB,WACAhB,OAAAN,YAAAwB,sBAAAJ,GACAd,QACAtI,IAAA9R,KAAAoa,SAGAtI,IAAA9R,KAAAkb,GAEAluB,EAAAqK,QAAA6jB,GACApJ,IAAA9R,KAAAyV,MAAA0F,YAAArB,YAAAoB,EAAAE,YAEAtJ,IAAA9R,KAAAkb;GAIApJ,KAEAyJ,eAAA,SAAAtB,SACA,GAAAuB,MACAC,KACAC,EAAA,CAEA,KAAA,GAAAxT,KAAA+R,SAAA,CACA,IAAA7J,QAAAwB,IAAAqI,QAAA/R,GAAA,UAQA,KAAA,+CAPA,IAAAkS,QAAAH,QAAA/R,EACAkS,QAAAve,KAAA,WACA4f,EAAAC,GAAAtB,QAEAoB,EAAAxb,KAAAoa,QACAsB,IAMA,IAAA,GAAAC,GAAA,EAAAA,EAAAH,EAAAtlB,OAAA,EAAAylB,IACA,IAAAF,EAAAE,GAAA,CAGA,GAAAC,IAAA,CACA,GACAA,GAAAD,EAAAjiB,KAAAmQ,MAAAnQ,KAAA0T,UAAAoO,EAAAtlB,OAAAylB,UACAF,EAAAG,GACA,IAAAC,KAAAL,EAAAI,EACAJ,GAAAI,GAAAJ,EAAAG,GACAH,EAAAG,GAAAE,IAGA,MAAAL,IAEAM,mBAAA,SAAAhC,YAAAiC,cACA,GAAA3B,QAAAN,YAAAuB,UAAAU,aACA,OAAA3B,QACAA,OAAAvsB,KAEA,OCvEAhC,OAAA,sCACA,SACA,SACA,aACA,eACA,kCACA,8CACA,kBACA,SAAAmB,EAAAoF,EAAA3B,WAAAyV,QAAAkK,QAAA4L,kBAAAC;AACA,YA0HA,SAAAC,sBACA,MAAAxjB,QAAAC,SAAAwjB,SAAA,KAAAzjB,OAAAC,SAAAyjB,KAAA1jB,OAAAC,SAAA0jB,SAAAhsB,QAAA,YAAA,IAzHA,GAAAisB,kBAAA,SAAAxM,UAEA,GAAAyM,QAAA,CAEA,IAAA,gBAAA,UACA,OAAA,CAGA,IAAAC,eAAA,CACA,IAAA1M,SAAAQ,SACA,GAAAtjB,EAAAmiB,QAAAsN,mBAAA3M,SAAAQ,WAAA,EACAkM,cAAA,MACA,CACA,GAAAE,KAAA5M,SAAAQ,SAAAnB,QAAA,IACA,IAAAuN,IAAA,EAAA,CACA,GAAApM,UAAAR,SAAAQ,SAAAqM,MAAA,EAAAD,KACAE,SAAA9M,SAAAQ,SAAAqM,MAAAD,IAAA,EACAG,uBAAAvM,WAAAtjB,EAAAmiB,QAAA0N,sBAAAvM,UAAAsM,WAAA,IACAJ,cAAA,IAKA,IAAAA,aAEA,KADAD,QAAA,EACA,GAAAnO,OAAA,oDAAA0B,SAAAQ;AAGA,IAAAR,SAAAtf,SAEA,KADA+rB,QAAA,EACA,GAAAnO,OAAA,8CAAA0B,SAAAQ,SAGA,OAAAiM,QAGAE,oBACA,aACA,iBACA,aACA,sBACA,qBACA,qBACA,sBACA,MACA,OACA,SACA,gBACA,cACA,uBACA,oBACA,0BACA,sBACA,8BACA,6BACA,0BACA,qBACA,qBACA,0BACA,mBACA,mBACA,mBACA,yBACA,oBACA,uBACA,oBACA,wBACA,oBACA,SACA,oBACA,MACA,SACA,UACA,gBACA,UACA,eACA,yBACA,eACA,cACA,WAMAK;AACA3S,gBAAA,aAAA,aAAA,SAAA,iBACAS,aAAA,cACAU,sBAAA,0BACAC,mBAAA,gBACAG,qBAAA,MAAA,WACAC,6BAAA,qBACAC,4BAAA,oBAAA,UACAC,yBAAA,iBACAC,oBAAA,iBACAC,oBAAA,WACAC,yBAAA,gBACAC,kBAAA,0BACAE,kBAAA,iBAMA0Q,uBACAzR,wBAAA,uBAAA,oBACAC,cAAA,oBAAA;EAMAxQ,WACA0gB,gBAAA,GAqBAwB,SAAA,SAAA7rB,SA+CA,QAAA8rB,uBAAA1M,SAAAha,MACA,GAAAR,UAAA,CASA,OARAmnB,YAAA3M,aAAA,GAEA4M,WAAA5M,WAAA,EACAxa,SAAA,GACAmnB,WAAA3M,YACAha,KAAA0J,KAAAid,WAAA3M,WACAxa,SAAA,GAEAA,QApDA,GAAAmnB,eAKAC,aAEAhsB,SAAAlE,EAAA4N,SAAA1J,YAAA2J,WAEAhK,KAAAmf,YAAA,EAEAnf,KAAAkX,KAAA,GAGAlX,KAAAssB,kBAMA,IAAAC,mBAAA,SAAA9M,UACA,GAAAwB,KAAA,IACA,IAAAoL,WAAA5M,UACAwB,IAAAoL,WAAA5M,cACA,CACA,GAAAoM,KAAApM,SAAAnB,QAAA,IACAuN,KAAA,IACApM,SAAAA,SAAAqM,MAAA,EAAAD,KACAQ,WAAA5M,YACAwB,IAAAoL,WAAA5M,YAIA,MAAAwB,KA4BAjhB,MAAAwsB,UAAA,SAAApT,IAAA7O;AAIA,MAHA,gBAAA,OACAlK,QAAA+Y,KAAA7O,OAEAvK,MAQAA,KAAAysB,WAAA,SAAAC,MAEA,MADArsB,SAAAlE,EAAAqjB,OAAAnf,QAAAqsB,MACA1sB,MAQAA,KAAA2sB,UAAA,SAAAvT,KACA,MAAA,gBAAA,MAAA/Y,QAAA+Y,KACA/Y,QAAA+Y,KAEA,MAGApZ,KAAA4sB,iBAAA,SAAAC,YAAAC,YACA,GAAAC,UAAA/sB,KAAA2sB,UAAA,WACA,OAAAI,WACAF,aACAE,SAAAF,cACA1wB,EAAAqb,SAAAuV,SAAAF,aAAAC,aAEAltB,WAAAotB,QAAAD,SAAAF,aAAAC,aAEA,MAQA9sB,KAAAitB,gBAAA,WACA,MAAA5sB,SAAA6sB,cAOAltB,KAAAmtB,eAAA,WACA,MAAAntB,MAAAorB,aAYAprB,KAAAgiB,UAAA,SAAA7E,QAAA7d,KAAA8tB,aAEA,GAAA/mB,KACA4a,IAAA,GAEAxB,SAAA2N,aAAAjQ,QAAAsC,SACAR,SAAAsN,kBAAA9M,UACA4N,WAAArtB,KAAA2sB,UAAA;AAEA,IAAA1N,WAAA9iB,EAAAqT,WAAAyP,SAAAtf,UACA,KAAA,IAAA4d,OAAA,sDAAAkC,SAoCA,OAhCAtjB,GAAA0S,SAAAwe,aAAAlxB,EAAAqT,WAAA6d,WAAAC,UAQAjnB,IAAAgnB,WAAAC,OAAAnQ,QAAAiQ,aACAjxB,EAAAqb,SAAAnR,OACA4a,KAAA5a,MAKA4a,KAAAhC,SAAAtf,SAAAL,MAIAnD,EAAA0S,SAAAwe,aAAAlxB,EAAAqT,WAAA6d,WAAAE,SAQAlnB,IAAAgnB,WAAAE,MAAApQ,QAAAiQ,aACAjxB,EAAAqb,SAAAnR,OACA4a,KAAA5a,MAGA4a,KAGAjhB,KAAA8hB,QAAA,SAAA3E,QAAA7d,KAAA8tB,aAEA,GAAAnM,KAAA3hB,KACAmgB,SAAA2N,aAAAjQ,QAAAsC,SACAR,SAAAsN,kBAAA9M,SAQA,OANAR,WACA,kBAAAA,UAAA,UACAgC,IAAAhC,SAAA6C,QAAAphB,KAAAV,KAAAmd,QAAA7d,OAIA2hB;EAGAjhB,KAAAwtB,aAAA,SAAAC,IAAAnuB,MACA,MAAAM,YAAAotB,QAAAS,KAAAnuB,OAGAU,KAAAsiB,aAAA,SAAAkB,WAAAjB,OAAA6K,aAEA,GAAAnM,KAAA,KACAxB,SAAA2N,aAAA5J,WAAA/D,SACAR,SAAAsN,kBAAA9M,SAEA,KAAAR,SAGA,KAAA,qCAAAuE,WAAA/D,QAEA,OAJAwB,KAAAhC,SAAAqD,aAAAkB,WAAAjB,SAOAviB,KAAAkiB,WAAA,SAAAsB,WAAAlkB,KAAA8tB,aAEA,GAAA3N,UAAA2N,aAAA5J,WAAA/D,SACAR,SAAAsN,kBAAA9M,SAEA,IAAAR,UAAA,kBAAAA,UAAA,OACA,MAAAA,UAAAuC,OAAA9gB,KAAAV,KAAAwjB,WAAAlkB,OAIAU,KAAA0tB,YAAA,SAAAC,eAAA7oB,SAAAsoB,aAEA,GAAAnM,MAAA,EACAxB,SAAA2N,aAAAO,eAAAlO,SACAR,SAAAsN,kBAAA9M;AAEA,IAAAR,SASA,KAAA,2CAAAQ,QARA,IAAA,kBAAAR,UAAA,YAAA,CACAgC,IAAAhC,SAAAyO,YAAAhtB,KAAAV,KAAA2tB,eAAA7oB,SACA,IAAA1F,YAAA6f,SAAAqD,aAAA5hB,KAAAV,KAAA2tB,eACAvuB,sBAAAmC,IAAAnC,WAAAiG,QACAjG,WAAAiM,QAAA,eAAAsiB,eAAA7oB,WAMA,MAAAmc,MAGAjhB,KAAA4tB,YAAA,SAAAD,eAAAP,aAEA,GAAAnM,MAAA,EACAxB,SAAA2N,aAAAO,eAAAlO,SACAR,SAAAsN,kBAAA9M,SAEA,KAAAR,SAKA,KAAA,2CAAAQ,QAEA,OANA,kBAAAR,UAAA,cACAgC,IAAAhC,SAAA2O,YAAAltB,KAAAV,KAAA2tB;AAKA1M,KAGAjhB,KAAA6tB,cAAA,SAAAF,eAAAP,aAEA,GAAAnM,MAAA,EACAxB,SAAA2N,aAAAO,eAAAlO,SACAR,SAAAsN,kBAAA9M,SAEA,KAAAR,SAKA,KAAA,2CAAAQ,QAEA,OANA,kBAAAR,UAAA,gBACAgC,IAAAhC,SAAA4O,cAAAntB,KAAAV,KAAA2tB,iBAKA1M,KAaAjhB,KAAA8tB,SAAA,SAAAH,eAAAP,aAEA,GAAAnM,MAAA,EACAxB,SAAA2N,aAAAO,eAAAlO,SACAR,SAAAsN,kBAAA9M,SAEA,KAAAR,SAOA,KAAA,2CAAAQ,QAEA,OAPAwB,KADA9kB,EAAAqT,WAAAyP,SAAA6O,UACA7O,SAAA6O,SAAAptB,KAAAV,KAAA2tB,gBAEA1O,SAAA2O,YAAAltB,KAAAV,KAAA2tB;EAkBA3tB,KAAA+tB,SAAA,SAAAJ,eAAAtwB,MAAA+vB,aAEA,GAAA3N,UAAA2N,aAAAO,eAAAlO,SACAR,SAAAsN,kBAAA9M,SAEA,KAAAR,SAQA,KAAA,2CAAAQ,QAPAtjB,GAAAqT,WAAAyP,SAAA8O,UACA9O,SAAA8O,SAAArtB,KAAAV,KAAA2tB,eAAAtwB,QAEA4hB,SAAA4O,cAAAntB,KAAAV,KAAA2tB,gBACA1O,SAAAyO,YAAAhtB,KAAAV,KAAA2tB,eAAAtwB,SAaA2C,KAAA8L,QAAA,SAAA6hB,eAAAP,aAEA,GAAAnM,MAAA,EACAxB,SAAA2N,aAAAO,eAAAlO,SACAR,SAAAsN,kBAAA9M,SAEA,KAAAR,SAKA,KAAA,2CAAAQ,QAEA,OANAtjB,GAAAqT,WAAAyP,SAAAnT,WACAmV,IAAAhC,SAAAnT,QAAApL,KAAAV,KAAA2tB;AAKA1M,KAGAjhB,KAAAguB,mBAAA,WACA,MAAA3B,aAGArsB,KAAAiuB,SAAA,SAAAC,oBACA/xB,EAAAqjB,OAAA4M,WAAA8B,qBAGAluB,KAAAmuB,KAAA,SAAA9c,SAAAoT,iBACA,GAAA1jB,MAAAf,KACA0kB,WAYA,IAVArkB,QAAA+tB,SAGA/tB,QAAA+tB,OAAAC,KAAAruB,KAAA6hB,WAAAxhB,QAAA+tB,OAAAC,MACAlyB,EAAA+I,QAAA7E,QAAA+tB,OAAA5mB,UAAA,SAAA8mB,MAAAnzB,OACAkF,QAAA+tB,OAAA5mB,UAAArM,OAAAozB,KAAAxtB,KAAA8gB,WAAAyM,MAAAC,QAEAvuB,KAAAorB,YAAAA,YAAA/qB,QAAA+tB,QAAAD,QAGA1J,gBAAA,CACA,IAAAtoB,EAAAqK,QAAAie,iBA6BA,KAAA,IAAAlH,OAAA,iEA1BAkH,iBAAAtoB,EAAAqyB,aAAA/J,gBAAAmH,oBAGAzvB,EAAA4M,KAAA0b,gBAAA,SAAAgK;AACA,GAAAC,MAAAzC,cAAAwC,SACAC,QACAjK,gBAAAtoB,EAAAmoB,MAAAG,gBAAAiK,SAIAvyB,EAAA+I,QAAAuf,gBAAA,SAAAhF,UAEA,GAAAuM,sBAAAvM,UAAA,CACA,GAAAkP,oBAAAxyB,EAAAqyB,aAAA/J,gBAAAuH,sBAAAvM,UACAtjB,GAAA4M,KAAA4lB,mBAAA,SAAA3P,UACA,IAAAmN,sBAAA1M,SAAA,IAAAT,SAAA0F,YAAAyH,sBAAA1M,SAAAiF,UACA,KAAA,IAAAnH,OAAAxc,KAAAmW,KAAA,8CAAAuI,SAAA,eAAAT,gBAIA,KAAAmN,sBAAA1M,SAAAiF,UACA,KAAA,IAAAnH,OAAAxc,KAAAmW,KAAA,8CAAAuI,gBASAiF,UAAAvoB,EAAAwc,OAAAyT;AAGA,GAAAxH,OAAA5kB,IAcA,OAbA6kB,SAAAH,SAAA,WAEAvoB,EAAA4M,KAAAkN,UAAA,SAAA2M,OACA6I,iBAAA7I,SACAyJ,WAAAzJ,MAAAnD,UAAAmD,SAIA,kBAAA,WACAvR,SAAA3Q,KAAAkkB,MAAAyH,cAIArsB,MAMAA,KAAA4uB,OAAA,WAIA,MAHA5uB,MAAAorB,aACAA,YAAA/qB,QAAA+tB,QAAAQ,SAEA5uB,MAUAA,KAAA6uB,mBAAA,SAAA5F,YAAAG,QAAA0F,oBACAvP,QAAAwB,IAAAkI,YAAA,iBACAjpB,KAAAssB,gBAAArD,YAAA9I,aAAAhkB,EAAAyI,MAAAumB,kBAAAb,YAAArB,YAAAG,QAAA0F,oBAAA,YAYA9uB,KAAA+uB,mBAAA,SAAA9F,YAAA+F,UAAAC,cACA,GAEAvP,QAAArI,EAFA+R,UAIA,IAAA7J,QAAAwB,IAAAkI,YAAA,eAAA;AAIA,GAHAvJ,OAAAuJ,YAAA9I,aAGAngB,KAAAssB,gBAAA5M,SAAAsP,UACA,GAAAzP,QAAAwB,IAAAkI,YAAA,oBAEA,IADAjpB,KAAAssB,gBAAA5M,WACArI,EAAA,EAAAA,EAAA,EAAAA,IACA+R,QAAA/R,GAAA8T,kBAAAT,eAAAzB,YAAAiG,WAAA7X,IACArX,KAAAssB,gBAAA5M,QAAArI,GAAAlb,EAAAyI,MAAAwkB,QAAA/R,GAAA,cAGA+R,SAAA+B,kBAAAT,eAAAzB,YAAAiG,cACAlvB,KAAAssB,gBAAA5M,QAAAvjB,EAAAyI,MAAAwkB,QAAA,cAKA7J,SAAAwB,IAAAkI,YAAA,oBACA9sB,EAAA+I,QAAAkkB,QAAA,SAAAG,OAAApuB,OACAA,MAAA,GACAgB,EAAA+I,QAAAlF,KAAAssB,gBAAA5M,QAAArI,GAAA,SAAA6T,cACA3B,OAAApa,KAAA8Z,YAAAuB,UAAAU,mBAKA/uB,EAAA+I,QAAAlF,KAAAssB,gBAAA5M,QAAA,SAAAwL;AACA9B,QAAAja,KAAA8Z,YAAAuB,UAAAU,gBAMA,OAAA,WAAA+D,cAAA,eAAAA,aACA9D,kBAAAhB,eAAAf,QAAA6F,cAIA9yB,EAAAwb,MAAAyR,SAGA,UAGAppB,KAAAmvB,aAAA,WACA,MAAA9C,aAGArsB,KAAAovB,aAAA,WACA,MAAAhD,aAQApsB,KAAA6hB,WAAA,SAAAte,KACA,MAAAlD,SAAA6sB,aAGA,gBAAA3pB,MAAAA,IAAA8B,OAAA,EACAhF,QAAA6sB,aAAAhY,QAAA3R,KADA,OAFAA,KAUAvD,KAAAqvB,eAAA,SAAAC,QAMA,GAHAxZ,QAAAyZ,KAAA,uCAAAtZ,WAGAjW,KAAA2sB,UAAA,mBACA,MAAA2C,QAAA9vB,QAAA,SAAA,GAGA,IAAA,kBAAA+jB,KAAA+L,SAAA,+CAAA/L,KAAA+L,QAEA,MAAAA;AAGA,GAAAE,QAAA,GACAC,iBAAAzvB,KAAA2sB,UAAA,mBAWA,IATA8C,kBAAAtzB,EAAAkrB,KAAAoI,mBACAtzB,EAAAiW,MAAAqd,iBAAA,SAAAC,gBAAA5L,gBACA,GAAA,IAAAwL,OAAAhR,QAAAwF,gBAEA,MADA0L,QAAAF,OAAA9vB,QAAAskB,eAAA4L,kBACA,IAKAF,OACA,MAAAA,OAEA,IAAAG,SAAA3vB,KAAA2sB,UAAA,YAAAtB,oBACA,OAAAsE,SAAAL,QAWA,QAQAM,MAAA,SAAA1B,mBAAAhX,KAAA2Y,gBACA,GAAAC,aAAA,WACA,GAAAzvB,SAAAlE,EAAAoK,cAAA0P,UAAA,IAAAA,UAAA,KAEAiW,UAAAhW,MAAAlW,MAEAA,KAAAiuB,SAAAC,oBACAluB,KAAAkX,KAAAA,MAAA,GACAlX,KAAAysB,WAAAtwB,EAAA4N,SAAA1J,QAAAwvB,qBAGA,OADAC,aAAA/K,UAAAmH,SAAAnH;AACA+K,gBCtuBA90B,OAAA,2BACA,SACA,YACA,SAAAmB,EAAA4zB,SACA,YAkDA,IAAAC,qBAAA,SAAAC,WAAA3wB,KAAAe,SAEA,GAAAoD,SAEAwsB,YAAA9zB,EAAAqK,QAAAypB,YAAAA,YAAAA,YACA3wB,KAAAA,SACAe,QAAAlE,EAAA4N,SAAA1J,aACA6vB,UAAA,GAMA,IAAAhD,eAMAiD,eAQAC,YAAA,SAAAC,UAEA,IAAAl0B,EAAAoK,cAAA8pB,YAAAl0B,EAAAqT,WAAA6gB,SAAAC,UAAAn0B,EAAAqb,SAAA6Y,SAAAnZ,MACA,KAAA,IAAApE,WAAA,4EAGA9S,MAAAmwB,YAAAhhB,KAAAkhB,WAQAE,cAAA,SAAAC,eACA,GAAAzvB,MAAAf,IAEAA,MAAAmwB,eAGAh0B,EAAA+I,QAAAsrB,cAAA,SAAAH;AAGAl0B,EAAAoK,cAAA8pB,UACAnD,aAAAkD,YAAAC,UAGAl0B,EAAAqT,WAAA6gB,WACAtvB,KAAAqvB,aACAlZ,KAAA,aAAAnW,KAAAovB,YAAA9qB,OAAA,GACAirB,OAAAD,cAWAI,QAAA,SAAArX,IAAA7O,OACApO,EAAAqb,SAAA4B,MAAA,mBAAA7O,OACAjL,KAAA8Z,KAAA7O,MACApO,EAAAoK,cAAA6S,OACA9Z,KAAA8Z,MASA0I,QAAA,SAAA1I,KACA,MAAAjd,GAAAqb,SAAA4B,KACA9Z,KAAA8Z,KAEA9Z,MAQA4V,QAAA,SAAA3R,KACA,GAAAmtB,UACAC,QAGA,OAAAtwB,SAAAoD,OAAAA,MAAAmtB,eAAArtB,KACAE,MAAAF,MAIAotB,SAAAtwB,QAAA6vB,SAAAH,QAAAnc,MAAArQ,KAAAA,IAGApH,EAAA+I,QAAAlF,KAAAmwB,YAAA,SAAAE,UACA,GAAA/tB,QAAA+tB,SAAAC,OAAAK,SAAArxB,KACA,IAAAgD,OAEA,MADAouB,UAAApuB,QACA,IAIAouB,SAAAA,UAAA,GAEArwB,QAAAoD,QACAA,MAAAF,KAAAmtB;AAGAA,WASAG,UAAA,SAAA3Z,KAAA3T,KACA,GAAAotB,UACAD,SAAA,GACAL,SAAAl0B,EAAAO,KAAAsD,KAAAmwB,aAAAjZ,KAAAA,MAMA,OALAmZ,YAEAM,SAAAtwB,QAAA6vB,SAAAH,QAAAnc,MAAArQ,KAAAA,IACAmtB,SAAAL,SAAAC,OAAAK,SAAArxB,OAEAoxB,UAMAI,WAAA,WACAzwB,QAAAoD,QACAA,WAOA,OAFAypB,cAAAqD,cAAAN,YAEA/C,aAGA,OAAA8C,uBClNAh1B,OAAA,8BACA,YACA,SAAA+0B,SACA,YASA,IAAAgB,cAAA,SAAAxtB,IAAA8qB,KAAA2C,UAGA,MAAAA,aAAA,EACA3C,KAAA7uB,QAAA,MAAA,IAAA,IAAA+D,IAAA0tB,UAAAzxB,QAAA,QAAA,IAAAA,QAAA,MAAA,IACA0xB,mBAAA3tB,IAAA4tB,KAAA3xB,QAAA,QAAA,IAAAA,QAAA,MAAA,KAGA6uB,KAAA9qB,IAAA0tB,UAAAzxB,QAAA,SAAA,IAAA0xB,mBAAA3tB,IAAA4tB,KAAA3xB,QAAA,SAAA;EASAywB,YAGAN,SACAzY,KAAA,UACAoZ,OAAA,SAAA/sB,IAAAjE,MACA,GAAA,gBAAAA,MAAAqwB,SAAAI,QAAAqB,WAAA7tB,KACA,MAAAwtB,cAAAxtB,IAAAjE,KAAAqwB,QAAArwB,KAAA0xB,YAMAK,gBACAna,KAAA,iBACAoZ,OAAA,SAAA/sB,IAAAjE,MACA,GAAA,gBAAAA,MAAAqwB,SAAAI,QAAAqB,WAAA7tB,MAAA,SAAAggB,KAAAhgB,IAAA4tB,MACA,MAAApB,SAAAH,MAAAmB,aAAAxtB,IAAAjE,KAAAqwB,QAAArwB,KAAA0xB,WAAAM,KAAAC,KAAAC,UAMAC,UACAva,KAAA,WACAoZ,OAAA,SAAA/sB,KACA,GAAAwsB,QAAA2B,WAAAnuB,KACA,MAAAA,KAAAouB,aAMAC,QACA1a,KAAA,SACAoZ,OAAA,SAAA/sB,KACA,GAAAwsB,QAAA8B,SAAAtuB,KACA,MAAAA,KAAAouB,aAMAG,UACA5a,KAAA,WACAoZ,OAAA,SAAA/sB,IAAAjE,MAEA,GAAAqwB,SAAArwB,KAAAqwB,SAAA;AACA,GAAA,gBAAApsB,MAAA,aAAAA,IAAA+nB,UACA,iBAAA/H,KAAAhgB,IAAAouB,YACA,MAAAhC,SAAApsB,IAAAouB,aAKA,OAAA1B,cC3FAj1B,OAAA,sDAAA,SAAA,eAAA,mBAAA,SAAAmB,EAAAkZ,QAAA0c,YACA,YAEA,IAAAC,YAAAnqB,OAAAgd,OAEA,OAAA,UAAAoN,SAEA,GAAAC,UAAA,EACAC,cAEA,OAAAJ,YAAA51B,EAAA4N,SAAAkoB,aACAG,aACAhsB,IAAA,SAAA0d,eAAAuO,SAEA,GAAAryB,KAAAoyB,UAAAtO,gBAEA,MAAAuO,SACAl2B,EAAAO,KAAAsD,KAAAoyB,UAAAtO,gBAAAuO,SAGAl2B,EAAAm2B,KAAAtyB,KAAAoyB,UAAAtO,kBAIAyO,iBAAA,SAAAC,YAEA,MADAL,aAAAK,YAAA;AACAxyB,MAEAyyB,eAAA,WAEA,MADAN,gBACAnyB,MAEA0yB,cAAA,WACA,GAAA3xB,MAAAf,IACA,OAAA,IAAAqV,SAAA,SAAAH,QAAAD,QACA,GAAA0d,wBACAx2B,GAAAiW,MAAA+f,YAAA,SAAAS,SAAA51B,IACA,OAAA41B,UACAD,qBAAAxjB,KAAAnS,MAGAg1B,WAAAW,qBAAA,WACAx2B,EAAA4M,QAAA+iB,MAAAprB,KAAAuV,WAAA,SAAA2c,UACAA,UAAAz2B,EAAAqT,WAAAojB,SAAAzE,QACAgE,YAAAQ,qBAAA7a,SAAA8a,YAGA1d,UACAnU,KAAAsK,QAAA,oBACA4J,WAGA4d,eAAA,WACA,GAAAC,OAIA,OAHA32B,GAAAiW,MAAApS,KAAAoyB,UAAA,SAAAW,SAAA/1B,IACA81B,IAAA91B,IAAAb,EAAAuB,IAAAq1B,SAAA,aAEAD,KAEAE,WAAA,SAAAlP,eAAAuO;AACA,GAAApI,KAAAjqB,KAAAoG,IAAA0d,eAAAuO,QACA,OAAApI,KACA9tB,EAAAuW,OAAAuX,IAAAgJ,SACAj2B,GAAAitB,IAAAnG,eACA7mB,MAAAgtB,IAAAhtB,MACA0yB,QAAA1F,IAAA0F,cAGA3vB,MAAAqL,QAAA,SACAlE,QAAA,oCACA2c,eAAAA,eACAuO,QAAAA,WAIAa,WAAA,SAAApP,eAAAuO,SACA,GAAApI,KAAAjqB,KAAAoG,IAAA0d,eAAAuO,QACA,OAAApI,MAAAA,IAAAkJ,QACAh3B,EAAAuW,OAAAuX,IAAAkJ,SACAn2B,GAAAitB,IAAAnG,eACA7mB,MAAAgtB,IAAAhtB,MACA0yB,QAAA1F,IAAA0F,QACA7qB,SAAAmlB,IAAAnlB,eAGA9E,MAAAqL,QAAA,SACAlE,QAAA,oCACA2c,eAAAA,eACAuO,QAAAA,WAIAe,WAAA,SAAAtP,eAAAuO,SACA,GAAAY,SAAAjzB,KAAAoG,IAAA0d,eAAAuO;AACA,MAAAY,SACAA,QAAAtD,QAEA,IAEA0D,aAAA,SAAA7O,QACA,GACA8O,aADAvyB,KAAAf,IA6CA,OA1CAszB,aADApB,UAAA1N,OACAnP,QAAAH,UAEAnU,KAAA2xB,gBAAAtc,KAAA,WAEA,GAAAmd,aASA,OAPAp3B,GAAA4M,KAAAopB,YAAA,SAAAS,UACAA,UACAW,UAAApkB,KAAAyjB,SAAAzE,UAKA9Y,QAAAyd,IAAAS,WAAAnd,KAAA,SAAAmC,SAEA,GAAAib,wBAGAzyB,MAAAqxB,UAAAj2B,EAAAwP,OAAA4M,QAAA,SAAAkb,IAAAC,OACA,MAAAv3B,GAAA+D,MAAAuzB,IAAAC,YAIAv3B,EAAAiW,MAAArR,KAAAqxB,UAAA,SAAAW,SAAAjP,gBAEA0P,qBAAA1P,gBAAA/iB,KAAAqyB,WAAAtP,kBAEAkO,WAAAnoB,QAAA8pB,MAAAH,uBAEAtB,SAAA,MAKAoB,YACAld,KAAA,WACArV,KAAAsK,QAAA;GAEAgL,MAAA,SAAAC,KACAvV,KAAAsK,QAAA,QAAAiL,OAGAgd,aAEAM,aAAA,SAAApP,QAEA,GAAAzjB,MAAAf,KAEAszB,YAAAvyB,KAAAsyB,aAAA7O,QAAApO,KAAA,WACA,GAAAyd,oBASA,OAPA13B,GAAAiW,MAAArR,KAAAqxB,UAAA,SAAAW,SAAAjP,gBACA,GAAAgQ,UAAA/yB,KAAAqF,IAAA0d,eACAgQ,UAAAX,SAAAW,SAAAX,QAAAY,MACAF,iBAAA1kB,KAAA2kB,SAAAX,QAAAY,KAAAv0B,QAAA,QAAA,OAIAq0B,iBAAAxuB,OACA,GAAAgQ,SAAA,SAAAH,QAAAD,QAEA+c,WAAA6B,iBAAA,WACA,GAAAG,YACA73B,GAAA4M,KAAAkN,UAAA,SAAAge,aACA,GAAAj3B,IAAAi3B,YAAAC,oBACAJ,SAAA/yB,KAAAqF,IAAApJ,IACAqa,EAAAlb,EAAAg4B,UAAApzB,KAAAqxB,UAAAp1B,KAAAq1B,QAAAyB,SAAAzB;EACAhb,GAAA,EACAtW,KAAAsK,QAAA,QAAA,mCAAArO,GAAA,IAAA82B,SAAAzB,UAEAtxB,KAAAqxB,UAAAp1B,IAAAqa,GAAA8b,QAAAiB,OAAAH,YACAD,SAAAh3B,IAAAi3B,eAGA/e,QAAA8e,WACA/e,UAGAI,QAAAH,aAcA,OATAoe,aACAld,KAAA,SAAA4d,UAEA,MADAjzB,MAAAsK,QAAA,iBAAA2oB,UACAA,WAEA3d,MAAA,SAAAC,KACAvV,KAAAsK,QAAA,QAAAiL,OAGAgd,mBC/LAt4B,OAAA,4CAAA,SAAA,SAAA,QAAA,SAAAuG,EAAApF,EAAAC,IACA,YAEA,IAAAi4B,eAgbA,OA9aAA,aAAAC,SAEAC,UAAAC,SAAA,eAAA3X,UAAA,SAAA4X,UAAA,GACAC,aAAAF,SAAA,cAAA,cAAA;AAAA3X,UAAA,UAAA4X,UAAA,GACAE,cAAAH,SAAA,cAAA,aAAA,gBAAA3X,UAAA,UAAA4X,UAAA,GACAG,aAAAJ,SAAA,cAAA,cAAA,cAAA3X,UAAA,SAAA4X,UAAA,GACAI,cAAAL,SAAA,cAAA,aAAA,gBAAA3X,UAAA,UAAA4X,UAAA,GACAK,YAAAN,SAAA,QAAAC,UAAA,GACAM,aAAAP,SAAA,SAAAC,UAAA,GACAO,cAAAR,SAAA,UAAAC,UAAA,GACAQ,MAAAT,SAAA,cAAAC,UAAA,GACAS,WAAAV,SAAA,eAAA3X,UAAA,QAAA4X,UAAA,GAEAU,SAAAX,SAAA,eAAA3X,UAAA,UAAAuY,OAAA,GACAC,KAAAb,SAAA,eAAAY,OAAA;EACAE,UAAAd,SAAA,eAAA3X,UAAA,OAAAuY,OAAA,GACAG,KAAAf,SAAA,cAAA,cAAA,cAAA3X,UAAA,QAAAuY,OAAA,GACAI,IAAAhB,SAAA,cAAA,cAAA,cAAA3X,UAAA,aAAAuY,OAAA,GACAK,IAAAjB,SAAA,aAAA3X,UAAA,UAAAuY,OAAA,GACAM,IAAAlB,SAAA,aAAA3X,UAAA,QAAAuY,OAAA,GACAO,IAAAnB,SAAA,cAAA,cAAA,cAAAY,OAAA,GACA1b,MAAA8a,SAAA,cAAA,aAAA,gBAAAY,OAAA,GACAQ,IAAApB,SAAA,eAAA3X,UAAA,QAAAuY,OAAA,GACAS,IAAArB,SAAA,cAAA,cAAA,cAAA3X,UAAA,MAAAuY,OAAA,GACAU,IAAAtB,SAAA,cAAA,cAAA;AAAA3X,UAAA,MAAAuY,OAAA,GACAxb,QAAA4a,SAAA,cAAA,aAAA,gBAAA3X,UAAA,cAAAuY,OAAA,GACAW,OAAAvB,SAAA,cAAAY,OAAA,GACAY,OAAAxB,SAAA,cAAA,cAAA,cAAA3X,UAAA,UAAA,MAAA,WAAA,QAAA,QAAA,SAAAuY,OAAA,GACAa,OAAAzB,SAAA,eAAA3X,UAAA,MAAAuY,OAAA,GACAc,OAAA1B,SAAA,eAAA3X,UAAA,MAAAuY,OAAA,GACAe,OAAA3B,SAAA,eAAA3X,UAAA,MAAAuY,OAAA,GACAgB,IAAA5B,SAAA,aAAAY,OAAA,GACAiB,IAAA7B,SAAA,aAAAY,OAAA,GACAkB,IAAA9B,SAAA,eAAA3X,UAAA,aAAAuY,OAAA,GACAmB,GAAA/B,SAAA,gBAAAY,OAAA,GACAoB,MAAAhC,SAAA,gBAAAY,OAAA;EACAqB,SAAAjC,SAAA,gBAAAY,OAAA,GACAsB,GAAAlC,SAAA,gBAAAY,OAAA,GACAuB,KAAAnC,SAAA,gBAAAY,OAAA,GACAwB,MAAApC,SAAA,gBAAAY,OAAA,GACAz4B,MAAA63B,SAAA,gBAAAY,OAAA,GACAyB,KAAArC,SAAA,gBAAAY,OAAA,GACA0B,IAAAtC,SAAA,gBAAAY,OAAA,GACA/d,GAAAmd,SAAA,gBAAAY,OAAA,GACA2B,KAAAvC,SAAA,gBAAAY,OAAA,GACA4B,GAAAxC,SAAA,gBAAAY,OAAA,GACA6B,MAAAzC,SAAA,gBAAAY,OAAA,GACA8B,OAAA1C,SAAA,gBAAAY,OAAA,GACA+B,MAAA3C,SAAA,gBAAAY,OAAA,GACAgC,QAAA5C,SAAA,gBAAAY,OAAA,GACAiC,KAAA7C,SAAA,gBAAAY,OAAA,GACAkC,KAAA9C,SAAA,gBAAAY,OAAA,GACAmC,IAAA/C,SAAA;AAAAY,OAAA,GACAoC,KAAAhD,SAAA,gBAAAY,OAAA,GACAqC,YAAAjD,SAAA,eAAAY,OAAA,GACAsC,SAAAlD,SAAA,eAAAY,OAAA,GACAuC,IAAAnD,SAAA,eAAAY,OAAA,GACAwC,IAAApD,SAAA,eAAAY,OAAA,GACAyC,IAAArD,SAAA,eAAAY,OAAA,GACA0C,IAAAtD,SAAA,eAAAY,OAAA,GACA2C,IAAAvD,SAAA,eAAAY,OAAA,GACA4C,IAAAxD,SAAA,eAAAY,OAAA,GACA6C,GAAAzD,SAAA,eAAAY,OAAA,GACA8C,KAAA1D,SAAA,eAAAY,OAAA,GACAzb,KAAA6a,SAAA,gBAAAY,OAAA,EAAAxV,YAAA,MAAA,MAAA,WAAA,SAAA,UACAuY,IAAA3D,SAAA,gBAAAY,OAAA,GAEApZ,aAAAwY,SAAA,cAAA,cAAA,cAAArQ,KAAA,GACAiU,SAAA5D,SAAA,eAAA;AAAArQ,KAAA,GACAtI,gBAAA2Y,SAAA,eAAA,mBAAArQ,KAAA,GACAvI,eAAA4Y,SAAA,eAAArQ,KAAA,GACApK,aAAAya,SAAA,eAAArQ,KAAA,GACAkU,kBAAA7D,SAAA,QAAA,OAAA,eAAArQ,KAAA,GACAmU,mBAAA9D,SAAA,SAAA,OAAA,eAAArQ,KAAA,GACAlK,KAAAua,SAAA,gBAAArQ,KAAA,GACA9J,SAAAma,SAAA,aAAA,gBAAA3X,UAAA,gBAAAsH,KAAA,GACAoU,iBAAA/D,SAAA,cAAA,aAAA,eAAA,kBAAArQ,KAAA,GACA5I,QAAAiZ,SAAA,eAAA3X,UAAA,gBAAAsH,KAAA,GACAqU,iBAAAhE,SAAA,eAAArQ,KAAA,GACAsU,eAAAjE,SAAA,cAAA,aAAA;AAAA3X,UAAA,eAAAsH,KAAA,GACAuU,gBAAAlE,SAAA,eAAA,aAAA,mBAAA3X,UAAA,gBAAAsH,KAAA,GACAzJ,mBAAA8Z,SAAA,oBAAArQ,KAAA,GACA1J,sBAAA+Z,SAAA,oBAAArQ,KAAA,GACA7I,kBAAAkZ,SAAA,oBAAArQ,KAAA,GACA/I,kBAAAoZ,SAAA,oBAAArQ,KAAA,GACAjJ,oBAAAsZ,SAAA,oBAAArQ,KAAA,GACAtJ,qBAAA2Z,SAAA,oBAAArQ,KAAA,GACA9I,kBAAAmZ,SAAA,oBAAArQ,KAAA,GACA1I,mBAAA+Y,SAAA,oBAAArQ,KAAA,GACAxI,mBAAA6Y,SAAA,oBAAArQ,KAAA,GACAwU,oBAAAnE,SAAA;AAAArQ,KAAA,GACAyU,oBAAApE,SAAA,oBAAArQ,KAAA,GACAlJ,oBAAAuZ,SAAA,sBAAArQ,KAAA,GACArJ,6BAAA0Z,SAAA,sBAAArQ,KAAA,GACAnJ,yBAAAwZ,SAAA,sBAAArQ,KAAA,GACApJ,4BAAAyZ,SAAA,sBAAArQ,KAAA,GACA3I,wBAAAgZ,SAAA,sBAAArQ,KAAA,GACAzI,sBAAA8Y,SAAA,oBAAA,qBAAArQ,KAAA,GACAvJ,yBAAA4Z,SAAA,oBAAA,oBAAArQ,KAAA,GACAhJ,yBAAAqZ,SAAA,qBAAArQ,KAAA,GACAxJ,uBAAA6Z,SAAA,qBAAArQ,KAAA;EACApI,mBAAAyY,SAAA,QAAA,OAAA,eAAArQ,KAAA,GACA9K,YAAAmb,SAAA,SAAArQ,KAAA,IAGAkQ,YAAA5wB,OAAAo1B,eAAA5mB,YAAAuiB,YAEAH,YAAAyE,6BAAA,SAAArZ,SAAArgB,YACA,GAAAk1B,SAAAD,YAAA0E,qBAAAtZ,UACAuZ,WAAA,EACA,KAAA,GAAA3hB,KAAAid,SACAA,QAAAjd,GAAA8M,MAEA6U,YAAA1E,QAAAjd,GAAA,KAQA,OAJA2hB,cACAA,WAAAA,WAAAC,UAAA,EAAAD,WAAA3zB,OAAA,IAGA9D,EAAAy3B,WAAA55B,WAAAA,WAAAmC,EAAAgf,WAAA9Z,OAAA,0BAGA4tB,YAAA0E,qBAAA,SAAAtZ,UACA,GAAAwB,IACA,IAAAoT,YAAA5wB,MAAAo1B,YAAApZ,UACAwB,IAAAoT,YAAA5wB,MAAAo1B,YAAApZ,cACA;AACAwB,MACA,IAAAuT,SAAAH,YAAA6E,iBAAAzZ,UAAA,EACA,KAAA,GAAA0Z,UAAA9E,aAAAC,QAAA,CACA,GAAAjsB,OAAAgsB,YAAAC,QAAA6E,OACA,IAAA9wB,MAAAwU,SAAA,CACA,GAAAuc,WAAAj9B,EAAAqyB,aAAAnmB,MAAAwU,SAAA2X,QACA4E,WAAA/zB,SACAgD,MAAAosB,UACAxT,IAAA9R,KAAAgqB,QAEAlY,IAAA9kB,EAAAmoB,MAAArD,IAAAoT,YAAAgF,gBAAAF,QAAA,MAIA9E,YAAA5wB,MAAAo1B,YAAApZ,UAAAwB,IAGA,MAAAA,MAGAoT,YAAAiF,mBAAA,SAAA7Z,SAAA4B,UAAAkY,SAEA,GAAAtY,OACAsY,SAAAA,WAEA,IAAAlxB,OAAAgsB,YAAAC,QAAA7U,SACA,IAAApX,OAAAA,MAAAwU,SACA,IAAA,GAAAxF,KAAAhP,OAAAwU,SAAA,CACA,GAAA2c,SAAAnxB,MAAAwU,SAAAxF,EACA,KAAAkiB,QAAAC,SAAA,CACAD,QAAAC,UAAA,EAGAvY,IAAA9R,KAAAqqB,QAGA,IAAAvnB,UAAAoiB,YAAAgF,gBAAAG,SAAA;AACA,IAAA,GAAAniB,KAAApF,UAAA,CACA,GAAAwnB,OAAAxnB,SAAAoF,EACAkiB,SAAAE,SACAF,QAAAE,QAAA,EAEAxY,IAAA9R,KAAAsqB,OAGApY,YACAJ,IAAA9kB,EAAAmoB,MAAArD,IAAAoT,YAAAiF,mBAAAG,OAAA,EAAAF,YAMAlY,YACAJ,IAAA9kB,EAAAmoB,MAAArD,IAAAoT,YAAAiF,mBAAAE,SAAA,EAAAD,YAQA,GAAA/E,SAAAH,YAAA6E,iBAAAzZ,UAAA,EACA,KAAA,GAAApI,KAAAmd,SACAvT,IAAA9kB,EAAAmoB,MAAArD,IAAAoT,YAAAiF,mBAAA9E,QAAAnd,GAAAgK,UAAAkY,SAGA,OAAAp9B,GAAAgW,KAAA8O,KAAA,IAGAoT,YAAAqF,eAAA,SAAAC,kBAAAC,iBACA,GAAAC,gBAAAxF,YAAAiF,mBAAAK,kBACA,OAAAx9B,GAAAmiB,QAAAub,eAAAD,kBAAA,GAGAvF,YAAA6E,iBAAA,SAAAzZ,SAAA4B;AACA,GAAAJ,IACA,IAAAI,WAAAgT,YAAA5wB,MAAA+wB,QAAA/U,UACAwB,IAAAoT,YAAA5wB,MAAA+wB,QAAA/U,cACA,CAEA,GADAwB,OACAoT,YAAAC,QAAA7U,YACAwB,IAAAoT,YAAAC,QAAA7U,UAAA+U,QACAnT,WAAA,CACA,IAAA,GAAAhK,KAAA4J,KACAA,IAAA9kB,EAAAmoB,MAAArD,IAAAoT,YAAA6E,iBAAAjY,IAAA5J,GAAAgK,WAEAJ,KAAA9kB,EAAAgW,KAAA8O,KAAA,GAGAoT,YAAA5wB,MAAA+wB,QAAA/U,UAAAwB,IAGA,MAAAA,MAGAoT,YAAAgF,gBAAA,SAAA5Z,SAAA4B,UAAA1d,MACA,GAAAsd,KACA6Y,UAAAn2B,KAAAA,KAAA,KACA,IAAA0d,WAAAgT,YAAA5wB,MAAAwO,SAAAwN,WAAA4U,YAAA5wB,MAAAwO,SAAAwN,UAAAqa,WACA7Y,IAAAoT,YAAA5wB,MAAAwO,SAAAwN,UAAAqa,eACA,CACA7Y,MACA,KAAA,GAAAkY,UAAA9E,aAAAC,QAAA,CACA,GAAAjsB,OAAAgsB,YAAAC,QAAA6E;AACAh9B,EAAAmiB,QAAAjW,MAAAmsB,QAAA/U,WAAA,IACA9b,KACA0E,MAAA1E,OACAsd,IAAA9R,KAAAgqB,QAGAlY,IAAA9R,KAAAgqB,QAEA9X,YACAJ,IAAA9kB,EAAAmoB,MAAArD,IAAAoT,YAAAgF,gBAAAF,OAAA9X,UAAA1d,SAIA0wB,YAAA5wB,MAAAwO,SAAAwN,YACA4U,YAAA5wB,MAAAwO,SAAAwN,cAEA4U,YAAA5wB,MAAAwO,SAAAwN,UAAAqa,WAAA7Y,IAGA,MAAAA,MAGAoT,YAAA0F,QAAA,SAAAta,UACA,MAAA4U,aAAAnU,GAAAT,SAAA,UAGA4U,YAAA2F,SAAA,SAAAva,UACA,MAAA4U,aAAAnU,GAAAT,SAAA,WAGA4U,YAAAnU,GAAA,SAAAT,SAAAwa,UACA,GAAAxa,WAAAwa,SACA,OAAA,CAEA,IAAAzF,SAAAH,YAAA6E,iBAAAzZ,UAAA,EACA,OAAAtjB,GAAAmiB,QAAAkW,QAAAyF,WAAA,GAIA5F,YAAA6F,8BAAA;AAEA,OACAxf,mBACAzd,MAAAb,GAAA,sBACA+9B,YAAA/9B,GAAA,+FACAuL,KAAA,cACAyyB,MAAAh+B,GAAA,UACAqjB,SAAA,oBACA4a,MAAA,sBAAA,QAEA/e,kBACAre,MAAAb,GAAA,qBACAuL,KAAA,aACAwyB,YAAA/9B,GAAA,mDACAg+B,MAAAh+B,GAAA,SACAqjB,SAAA,mBACA4a,MAAA,sBAAA,aAEA5f,sBACAxd,MAAAb,GAAA,yBACAuL,KAAA,iBACAwyB,YAAA/9B,GAAA,4CACAg+B,MAAAh+B,GAAA,aACAqjB,SAAA;AACA4a,MAAA,sBAAA,gBAEAjf,kBACAne,MAAAb,GAAA,qBACAuL,KAAA,aACAwyB,YAAA/9B,GAAA,4FACAg+B,MAAAh+B,GAAA,SACAqjB,SAAA,mBACA4a,MAAA,sBAAA,gBAEAnf,oBACAje,MAAAb,GAAA,uBACAuL,KAAA,eACAwyB,YAAA/9B,GAAA,0DACAg+B,MAAAh+B,GAAA,WACAqjB,SAAA,qBACA4a,MAAA,sBAAA,SAEAxf,qBACA5d,MAAAb,GAAA,yBACAuL,KAAA,iBACAwyB,YAAA/9B,GAAA;AACAg+B,MAAAh+B,GAAA,aACAqjB,SAAA,sBACA4a,MAAA,sBAAA,OAAA,gBAEA5e,mBACAxe,MAAAb,GAAA,sBACAuL,KAAA,cACAwyB,YAAA/9B,GAAA,4CACAg+B,MAAAh+B,GAAA,UACAqjB,SAAA,oBACA4a,MAAA,sBAAA,YAEAzf,yBACA3d,MAAAb,GAAA,6BACAuL,KAAA,qBACAwyB,YAAA/9B,GAAA,2FACAg+B,MAAAh+B,GAAA,iBACAqjB,SAAA,0BACA4a,MAAA,sBAAA,SAEA1e,mBACA1e,MAAAb,GAAA;AACAuL,KAAA,cACAwyB,YAAA/9B,GAAA,4DACAg+B,MAAAh+B,GAAA,eACAqjB,SAAA,oBACA4a,MAAA,sBAAA,YAEAhf,kBACApe,MAAAb,GAAA,qBACAuL,KAAA,aACAwyB,YAAA/9B,GAAA,gIACAg+B,MAAAh+B,GAAA,SACAqjB,SAAA,mBACA4a,MAAA,sBAAA,UAEAhhB,YACApc,MAAAb,GAAA,cACAuL,KAAA,YACAwyB,YAAA/9B,GAAA;AACAg+B,MAAAh+B,GAAA,SACAqjB,SAAA,aACA4a,MAAA,sBAAA,SAEAlf,yBACAle,MAAAb,GAAA,6BACAuL,KAAA,qBACAwyB,YAAA/9B,GAAA,0CACAg+B,MAAAh+B,GAAA,iBACAqjB,SAAA,0BACA4a,MAAA,sBAAA,sBAAA,QAEA3e,sBACAze,MAAAb,GAAA,0BACAuL,KAAA,kBACAwyB,YAAA/9B,GAAA,qFACAg+B,MAAAh+B,GAAA,cACAqjB,SAAA,uBACA4a,MAAA,sBAAA,sBAAA,SAEA1f,uBACA1d,MAAAb,GAAA;AACAuL,KAAA,mBACAwyB,YAAA/9B,GAAA,wCACAg+B,MAAAh+B,GAAA,eACAqjB,SAAA,wBACA4a,MAAA,sBAAA,sBAAA,SAAA,WAEApf,oBACAhe,MAAAb,GAAA,uBACAuL,KAAA,eACAwyB,YAAA/9B,GAAA,gEACAg+B,MAAAh+B,GAAA,WACAqjB,SAAA,qBACA4a,MAAA,uBAAA,QAEArf,yBACA/d,MAAAb,GAAA,6BACAuL,KAAA,qBACAwyB,YAAA/9B,GAAA,sDACAg+B,MAAAh+B,GAAA,SACAqjB,SAAA,0BACA4a,MAAA,uBAAA;EAEAvf,6BACA7d,MAAAb,GAAA,iCACAuL,KAAA,yBACAwyB,YAAA/9B,GAAA,0EACAg+B,MAAAh+B,GAAA,aACAqjB,SAAA,8BACA4a,MAAA,uBAAA,gBAEAtf,4BACA9d,MAAAb,GAAA,iCACAuL,KAAA,mBACAwyB,YAAA/9B,GAAA,8DACAg+B,MAAAh+B,GAAA,aACAqjB,SAAA,6BACA4a,MAAA,uBAAA,gBAEA7e,wBACAve,MAAAb,GAAA,4BACAuL,KAAA,oBACAwyB,YAAA/9B,GAAA;AACAg+B,MAAAh+B,GAAA,gBACAqjB,SAAA,yBACA4a,MAAA,2BAKAhG,cCvbAr5B,OAAA,yDACA,SACA,qDACA,4CACA,SAAAmB,EAAAm+B,wBAAAC,aACA,YAQA,OAAA,YAEA,MAAAD,0BACAE,iBAAA,SAAA1W,eAAAuO,SACA,GAAAyB,UAAA9zB,KAAAoG,IAAA0d,eAAAuO,QACA,IAAAyB,UAAAA,SAAAX,SAAAW,SAAAX,QAAAY,MAAAD,SAAAX,QAAAxrB,KACA,OACA1K,MAAA62B,SAAA72B,MACA0K,KAAAmsB,SAAAX,QAAAxrB,KAAAnI,QAAA,GAAAwjB,QAAA,IAAAc,eAAA,KAAAgQ,SAAAnE;AACAyK,MAAAtG,SAAAsG,MACAD,YAAArG,SAAAqG,YACA1a,SAAA,qBAAAqU,SAAAhQ,eACAuW,KAAAl+B,EAAAmoB,OAAA,uBAAAwP,SAAAuG,UAIA71B,GAAA,iBAAA,SAAAwvB,UACA73B,EAAA4M,KAAAirB,SAAA,SAAAb,SACAoH,YAAAjG,QAAA,qBAAAnB,QAAAe,sBAAAM,SAAA,qBAAArQ,KAAA,UC/BAnpB,OAAA,iDAAA,SAAA,wDAAA,UAAA,SAAAmB,EAAAs+B,WAAArG,QACA,YAGA,IAAAsG,UAAAD,aACAE,aACA9wB,OAAAuqB,OAAAvqB,QAYA,OAVAA,SAAAA,OAAA8wB,YACAA,UAAA9wB,OAAA8wB,WAGAx+B,EAAA4M,KAAA4xB,UAAA,SAAA/H;AACAA,SAAA1b,MAAA0b,SAAAwB,QACAsG,SAAAnI,iBAAAK,SAAAwB,UAIAsG,WClBA1/B,OAAA,yDACA,SACA,sDACA,SAAAmB,EAAAm+B,yBACA,YAOA,OAAA,YACA,MAAAA,8BCZAt/B,OAAA,iDAAA,SAAA,wDAAA,UAAA,SAAAmB,EAAAy+B,WAAAxG,QACA,YAGA,IAAAsG,UAAAE,aACAD,aACA9wB,OAAAuqB,OAAAvqB,QAYA,OAVAA,SAAAA,OAAA8wB,YACAA,UAAA9wB,OAAA8wB,WAGAx+B,EAAA4M,KAAA4xB,UAAA,SAAA/H,UACAA,SAAA1b,MAAA0b,SAAAwB,QACAsG,SAAAnI,iBAAAK,SAAAwB;GAIAsG,WClBA1/B,OAAA,yEACA,gDACA,iDACA,SAAAy/B,WAAAG,YACA,YAEA,SAAAC,wBAAA/W,gBACA,MAAA2W,YAAAr0B,IAAA0d,gBACA2W,WAAArH,WAAAtP,gBAEA8W,WAAAx0B,IAAA0d,gBACA8W,WAAAxH,WAAAtP,gBAEAA,eAKA,OACA5M,KAAA,0BACAoZ,OAAA,SAAA/sB,KAEA,MAAAA,KAAA4tB,OAAA5tB,IAAAgrB,KACAsM,uBAAAt3B,IAAA4tB,MACA5tB,IAAAu3B,SAAAv3B,IAAAw3B,SACAx3B,IAAAw3B,SAAAv7B,QAAA,8BAAA,SAAAw7B,UAAA9c,GAAA4F,eAAAmX;AACA,GAAAvL,iBAAAmL,uBAAA/W,eACA,OAAA4L,iBACAA,gBAAA,IAAAuL,QAEAD,YANA,WCxBAhgC,OAAA,iDACA,SACA,UACA,YACA,0BACA,6BACA,SACA,yEACA,SAAAmB,EAAA++B,QAAA9M,OAAA4B,oBAAAmL,gBAAA/G,OAAAgH,uBACA,YAEA,IAAAC,YAAAjN,OAAAhoB,IAAA,SACAk1B,aAAAlH,OAAAvqB,SAGAqjB,aAAA8C,sBAEA9Y,KAAA,QACAoZ,OAAA,SAAA/sB,KACA,GAAA83B,YAAA93B,IAAAgrB,OAAAhrB,IAAAgrB,OAAA8M,WAAAhN,MAAAlyB,EAAA0gB,SAAA1gB,EAAAyI,MAAAy2B,WAAA7zB,UAAA,QAAAjE,IAAAgrB,OACA,MAAA2M,SAAAK,SAAAh4B,IAAAouB;GAIAwJ,gBAAArJ,SACAqJ,gBAAA1J,SACA0J,gBAAAvJ,OACAuJ,gBAAA9J,eACA8J,gBAAAxL,QACAyL,wBACAzL,QAAA,KAGA6L,WACAliB,eAAA,8CACAD,WAAA,mDACAG,qBAAA,EACAC,WAAA,oDACAI,oBAAA,EACAC,qBAAA,EACAP,oBAAA,EACAI,IAAA,6CACAD,KAAA,8CACAE,OAAA,gDACAG,YAAA;AACA+B,cAAA,uDACAP,OAAA,6DACAb,kBAAA,wEACAE,wBAAA,8EACAU,iBAAA,uEACAb,qBAAA,2EACAW,iBAAA,uEACAM,qBAAA;AACAD,kBAAA,wEACAN,wBAAA,8EACAsgB,iCAAA,gFACAC,gCAAA,+EACArhB,QAAA,yDACAJ,IAAA,qDACAE,QAAA,yDACAwhB,0CAAA;AACAC,8CAAA,6FACAthB,aAAA,8DACAY,mBAAA,yEACAD,mBAAA,yEACAb,eAAA,EACAS,oBAAA,0EACAW,uBAAA,6EACAR,wBAAA;AACAK,iBAAA,uEACAM,kBAAA,wEACAZ,2BAAA,iFACAb,OAAA,wDACAY,4BAAA,kFACAd,mBAAA,EACA+B,kBAAA,gFACAC,YAAA,6DACAC,QAAA;AACAtB,sBAAA,4EAGA,QACAzD,KAAA,iBACAskB,UAAAA,UACAn7B,SACA6sB,aAAAA,aACAkB,OAAAiN,WACAQ,mBACAC,YAAAR,aAAAS,qBACAC,WAAAV,aAAAW,oBACAC,kBAAAZ,aAAAa,2BACAC,QAAAd,aAAAe,kBAEAtP,SAAAuO,aAAAvO,aC1FA/xB,OAAA,mDACA,qCACA,iDACA,SAAAkxB,SAAAriB,QACA,YAEA,OAAAqiB,UAAA0D,MAAA/lB,OAAA2xB,UAAA3xB,OAAAqN,KAAArN,OAAAxJ;GCPArF,OAAA,iDACA,SACA,SACA,QACA,UACA,UACA,kCACA,iCACA,kDACA,gCACA,SAAAuG,EAAApF,EAAA6Y,MAAAkmB,QAAAp7B,QAAA6C,MAAAshB,OAAAiI,UACA,YA6CA,SAAAoQ,UAAAh9B,KAAAsE,MAGA,GAAA24B,aAAAj9B,KAAAiE,IAAA,WACAi5B,UAAAl9B,KAAAiE,IAAAma,MAAA,KACA+e,UAAAD,UAAA,GACAE,SAAA7X,QAAA8X,EAAAC,SAAAzgC,EAAA0N,OAAA8pB,MAAA8I,WACA9M,QAAArwB,KAAAiE,IAAA/D,QAAAi9B,UAAAC,UACAG,OAAA,GAAA5Y,QACAhF,SAAA,GAAAiN,WACAyD,QAAAA,SAIA1Q,UAAAgO,iBACAhO,SAAAgO,kBAAAwD,QAAA,UAAAd;AAGA9K,SAAA,QAAA0X,aAAA,SAAAO,UAEAD,OAAA3X,aAAA4X,SAAA,SAAAlkB,MACAqG,SAAAkP,KAAA,WAEA,GAAA/uB,YACAuS,SACAxP,MACA46B,IACAz6B,MAGAH,OAAA0F,OAAAm1B,YAAAxL,MAGA5Y,KAAA0I,YAAAthB,MAGAZ,WAAAmC,EAAA,SAAA07B,SAAA,QACA79B,WAAAwhB,OAAAhI,KAAA4I,UAGA5I,KAAAsJ,aAGA9iB,WAAAkI,SAGAy1B,IAAAl1B,OAAAm1B,YAAAxL,MAEA7f,UAAAorB,IAAA56B,OAAA+6B,QAEA56B,QACAtF,GAAAsC,KAAAtC,GACAuG,IAAAjE,KAAAiE,IACAoO,SAAAA,UAGA/N,KAAA,KAAAtB,SAEAtC,KAAAglB,wBAhGA,GAAAkY,SAAA,IAOAC,gBAAA,GAAAD,QAOAE,yBAAA,GAMAC,iBACA,uDACA,uDACA,wDAQAC,cAAA,SAgFAC,mBAAA,SAAAC,QAAAC,YAAAC;AACA,GAAAC,KAAA,EACAC,SAAAzhC,EAAAuB,KAAAvB,EAAAumB,QAAA8a,UAAAA,SAAAH,gBAAA,SAAAQ,QAEA,MADAF,QAEA3gC,GAAAsgC,cAAAK,IACAp6B,IAAAs6B,OACAH,QAAAA,SAAAP,gBACAW,GAAAL,aAAAL,2BAOA,OAFAQ,UAAA,GAAAE,MAOA37B,MAAA,SAAAyB,MACA,GAAAm6B,SACA5hC,GAAA+I,QAAA04B,SAAA,SAAAt+B,MAGA,IAFA,GAAA+P,IAAAlT,EAAA6hC,QAAA1B,SAAAh9B,MACA2+B,WAAA3+B,KAAAw+B,IAAA,EACAG,cACAF,MAAA5uB,KAAAE,MAIA2F,MAAAkpB,OAAAH,MAAA,SAAAznB,IAAA6nB,UACA,GACA5lB,SADAV,SAAA,CAGA,IAAAvB,MAAA6nB,SAAA94B,OAEA,KAAAiR,IAIA6nB,UAAArmB,QAEAS,QAAA5V,MAAAw7B,SAAA,WAAAtmB,UAEAjU,KAAA2U,QAAAW,QAAAX,aAMA,OAAAglB,sBCtLAviC,OAAA,8CACA,SACA,QACA,UACA,kCACA,0CACA,gCACA,SAAAmB,EAAA6Y,MAAAkmB,QAAAv4B,MAAAiV;AACA,YAOA,IAAAwmB,OAAA,KAOAC,MAAAD,MAAAA,MAOAlB,QAAA,IAWAoB,eACAC,QACAvhC,GAAA,OACAm0B,KAAA,oBACA9J,KAAA,GAAA+W,MACAV,QAAAR,QACAzlB,UAAA,EACAqmB,GAAA,IAEAU,SACAxhC,GAAA,QACAm0B,KAAA,qBACA9J,KAAA,IAAA+W,MACAV,QAAA,EAAAR,QACAzlB,UAAA,EACAqmB,GAAA,GAEAW,OACAzhC,GAAA,MACAm0B,KAAA,mBACA9J,KAAAgX,MACAX,QAAA,GAAAR,QACAzlB,UAAA,EACAqmB,GAAA,GAEAY,QACA1hC,GAAA,OACAm0B,KAAA,oBACA9J,KAAA,GAAAgX,MACAX,QAAA,GAAAR,QACAzlB,UAAA,EACAqmB,GAAA,IAUAa,SAAA,SAAAr/B,KAAA+P,IACA,GACAlN,OAAA46B,IACA6B,UACAr7B,IACA2D,QAJAnG,KAAAf,IAMA,OAAAV,MAAAmY,WAAAzX,KAAA2W,UAAArX,KAAAmY,UACApI,GAAA,cAGA9L,IAAA23B,QAAAK,SAAA,iDAAAj8B,KAAA6xB,KAAA,IAAAI,KAAAC;AACAtqB,QAAA,GAAA23B,gBACA33B,QAAAuG,KAAA,MAAAlK,KAAA,GACA2D,QAAA43B,iBAAA,SAAA,4BAEA53B,QAAA63B,OAAA,WACA,GAAAptB,UACAqtB,MACAC,QACAC,KAcA,OAZAnC,KAAAl1B,OAAAm1B,YAAAxL,MACA2N,aAAAP,WAEAjtB,SAAAorB,IAAA56B,MACA68B,MAAA1/B,KAAA+nB,KACA4X,QAAAttB,SAAAurB,QAGAgC,MAAA,EAAAF,MAAAC,QAAAZ,MAEAt9B,KAAA4V,UAAA9N,KAAA+C,IAAA7K,KAAA4V,UAAAuoB,OAEA7vB,GAAA,MACArS,GAAAsC,KAAAtC,GACAm0B,KAAA7xB,KAAA6xB,KACA9J,KAAA/nB,KAAA+nB,KACA1V,SAAAA,SACAutB,MAAAA,SAGAh4B,QAAAk4B,QAAA,SAAA9oB,KACA6oB,aAAAP,WACAvvB,GAAAiH,MAGAsoB,UAAAziC,EAAAkjC,MAAAhwB,GAAA/P,KAAAo+B,QAAA,WACAv7B,MAAA0F,OAAAm1B,YAAAxL,UACAtqB,SAAAo4B,SAQAC,gBAAA,WACA,OAKAp9B,MAAA,SAAAyB;AACA,GAAA7C,MAAAf,KACA+9B,QACA5hC,GAAA+I,QAAAo5B,cAAA,SAAAh/B,MAGA,IAFA,GAAA+P,IAAAlT,EAAAqjC,KAAAb,SAAA59B,KAAAzB,MACA2+B,WAAA3+B,KAAAw+B,IAAA,EACAG,cACAF,MAAA5uB,KAAAE,MAIArP,KAAA2W,UAAA,EAEA3B,MAAAkpB,OAAAH,MAAA,SAAAznB,IAAA6nB,UACA,GAGA7lB,UACAC,QAJA5G,SAAA,EACA0V,KAAA,EACAxP,SAAA,CAIA,IAAAvB,MAAA6nB,SAAA94B,OAEA,KAAAiR,IAGAgC,UAAA,SAAA/N,OACA,GAAA20B,OAAA,CAUA,OARA30B,SACAoH,UAAApH,MAAAoH,SACA0V,MAAA9c,MAAA8c,KAEA6X,MAAA30B,MAAA20B,MACA30B,MAAA20B,MAAAtnB,cAAAsnB,MAAArnB,WAGAqnB,OAGA3mB,QAAA5V,MAAAw7B,SAAA7lB,SAAAT,UAEAU,QAAA5G,SAAAiG,cAAAjG,SAAAurB,QAAArlB,UACAU,QAAA8O,KAAAA,KAEAzjB,KAAA2U,QAAAW,QAAAX,aAMA,OAAAgnB,mBClMAvkC,OAAA,2CACA,SACA,SACA,QACA,YACA,SAAAuG,EAAApF,EAAA6Y,MAAAyqB;AACA,YAOA,IAAArB,OAAA,KAOAC,MAAAD,MAAAA,MAKA9+B,QAMAogC,YAAA,SAAAr6B,QAIA,IAAA,GAHAyJ,MAAA,GACA6wB,SAAA,iEAEAtoB,EAAA,EAAAA,EAAAhS,OAAAgS,IACAvI,MAAA6wB,SAAArjB,OAAAzT,KAAAmQ,MAAAnQ,KAAA0T,SAAAojB,SAAAt6B,QAGA,OAAAyJ,OAQA+H,OAAA,SAAAwQ,MAEA,GAAA9jB,KAAAk8B,UAAAjqB,MAAA,SAAA,uBAAA,uBAAA/R,MAAA8tB,KAAAC,QACAoO,IAAAF,YAAArY,KAGA,OAFA/nB,SAEAiC,EAAA+B,MACAC,IAAAA,IACAI,KAAA,OACArE,MACAuX,OAAA+oB,KAEAC,IAAA,WACA,GAAAA,KAAA,GAAAh4B,QAAAg3B,eACAiB,UAAAvO,KAAAC,KAaA,OAXAqO,KAAAhpB,OAAAkpB,iBAAA,WAAA,SAAAC,KACA,GAAAA,IAAAC,iBAAA,CACA,GAAAC,YAAA3O,KAAAC,MAAAsO,SACAxgC,MAAA6P;AACA3Q,KAAA0hC,WACAC,OAAAH,IAAAG,OACAjB,MAAA,EAAAc,IAAAG,OAAA9B,OAAA6B,WAAA,UAGA,GAEAL,QASAO,aAAA,SAAAv2B,QACA,OAKA1H,MAAA,SAAAyB,MACA,GAAAy8B,OAAAxpB,OAAApF,SAAA5H,OAAAwd,KAAA,IACAgZ,OAAAjqB,KAAA,WACAxS,KAAAtE,UAMA,OAAA8gC,gBC/FAplC,OAAA,uCAAA,UAAA,SAAAmB,GACA,YAQA,OAAA,UAAA0N,OAAAE,UACA,MAAA5N,GAAA0N,YACAy2B,KAAA,SAAA/1B,OACA,MAAA,QAAAA,OAAAsL,SAAAtL,QAEAR,SAAAA,cACAQ,WCfAvP,OAAA,4CACA,SACA,OACA,UACA,uCACA,SAAAuG,EAAAnF,GAAA0D,QAAAygC,WACA,YAqBA,SAAAC,cAAA34B,OAAAD,OAAA64B,WAAAhE;AACA,GAAAlc,UAAA1Y,OAAA0Y,SACAmgB,UAAA74B,OAAA64B,UACAC,OAAA94B,OAAA84B,OACAC,UACA56B,EAAA,EACA4kB,EAAA,CA+BA,OA5BAgW,QAAAC,GAAAH,UAAAI,UAGA96B,GAAA6B,OAAAk5B,cAAA,EAAA,EACA/6B,GAAA6B,OAAAm5B,MAAA,EAAA,EACAh7B,GAAA6B,OAAAo5B,OAAA,EAAA,EACAj7B,GAAA,mBAAAua,WAAA,mBAAA1Y,QAAA,EAAA,EACA7B,GAAA,mBAAA6B,SAAA,eAAAA,SAAA,qBAAAA,SAAA,aAAAA,QAAA,GAAA,EACA7B,GAAA,GAAAA,MAAA,SAAA2rB,WAAArT,QAAA,SAAA,EAAA,GAAA,EACAsiB,OAAA56B,EAAAA,EAGA4kB,GAAA,WAAArK,UAAA2gB,cAAA,UAAA,EAAA,EACAtW,GAAA,aAAA/iB,QAAA,EAAA,EACA+iB,GAAA/iB,OAAAs5B,OAAA,EAAA,EACAvW,GAAA/iB,OAAAu5B,iBAAA,EAAA,EACAxW,GAAA/iB,OAAAw5B,SAAAx5B,OAAAw5B,QAAAC,UAAA,GAAA,EACA1W,GAAArK,SAAAghB,gBAAAC,wBAAA,GAAA;AACA5W,GAAA,cAAA/iB,QAAA,GAAA,EACA+4B,OAAAhW,EAAAA,EAGAgW,OAAAjW,EAAA9hB,KAAA0T,SAAAoV,SAAA,IAAAsH,UAAA,GAGA2H,OAAAa,EAAAd,OAAA76B,MACA86B,OAAAc,EAAAf,OAAAgB,OAEA7hC,QAAA2E,KAAAmD,OAAA64B,WAAAhE,UAAAmE,QAaA,QAAAgB,eAAA/5B,OAAAgC,QACA,GAAAC,YAAAy2B,UAAA12B,WAAAG,UAEA,QAKA7H,MAAA,SAAAyB,MACA,GAAAL,KAAAi9B,aAAA34B,OAAAiC,WAAAlC,OAAAkC,WAAA22B,WAAA32B,WAAA2yB,UACAl7B,GAAA+B,MACAC,IAAAA,IACA0B,QAAA,SAAA3F,MACAsE,KAAAtE,WA7EA,GAAA0K,YACApC,OAAA,eACA64B,WAAA,uBACAhE,UAAA,sBAiFA,OAAAmF,iBCpHA5mC,OAAA,qDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT;AAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,OACAF,OAAAN,QAAA+hC,QAAA1hC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAgiC,OAAA1hC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,OAIA,QAAAiJ,UAAAvJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,OACAF,OAAAN,QAAA4G,MAAAvG,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA6G,KAAAvG,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,OAtBAH,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE;AAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAE,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,iBAAAO,KAAAf,IAuCA,OAfAM,SAAA,mDACAF,OAAAN,QAAA4F,OAAAvF,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA6F,MAAAvF,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,6CACAA,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAgiC,QAAAlhC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,aACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA6G;AAAA/F,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAgI,SAAA9J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,uHACAF,OAAAN,QAAAgiC,QAAA3hC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAiiC,OAAA3hC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,0IC1CAnF,OAAA,uDAAA,cAAA,SAAA0E;AACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAiBA,OAhBAA,SAAA,kDACAF,OAAAN,QAAA6D,MAAAxD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA8D,KAAAxD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,2CACAC,OAAAN,QAAA6D,MAAAxD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA8D,KAAAxD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA;CACAC,OAAAN,QAAAqH,SAAAhH,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAsH,QAAAhH,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,wBACAA,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAkiC,QAAAphC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAA4H,SAAA1J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,6BAGA,QAAA0I,UAAAnJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,wBACAF,OAAAN,QAAAiiC,QAAA5hC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAkiC,OAAA5hC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,SAIA,QAAAuM,UAAA7M,OAAAP,MAEA,GAAAa,QAAAG,OAAA,EAQA,OAPAA,SAAA,iFACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAmiC,MAAArhC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAkI,SAAAhK,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,IACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA5C,OAAA0D,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAA8H,SAAA5J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,oCAGA,QAAAgJ,UAAAzJ,OAAAP,MAGA,MAAA,QAGA,QAAA4J,UAAArJ,OAAAP;AAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,YACAF,OAAAN,QAAA7C,OAAAkD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA5C,MAAAkD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,IAIA,QAAA8hC,UAAApiC,OAAAP,MAEA,GAAAa,QAAAC,OAAAC,QAAAC,OAAA,EAWA,OAVAA,SAAA,uGACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,eAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,eAAAQ,WACA,2FACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,eAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,eAAAQ,WACA,oEACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,UAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,UAAAQ,WACA,sHACAF,OAAAL,QAAAiJ,KAAArI,KAAAb,OAAAA,QAAAc,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,GAAAoI,UAAAlK,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA;CAGA,QAAAkJ,WAAA3J,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAUA,OATAA,SAAA,sCACAF,OAAAN,QAAAqH,SAAAhH,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAsH,QAAAhH,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,aACAC,OAAAN,QAAAyK,OAAApK,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA0K,MAAApK,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,mCA3FAH,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE;AAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAE,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,iBAAAO,KAAAf,KAAAS,cAAAX,QAAAW,aA+GA,OAlBAH,SAAA,qBACAF,OAAAN,QAAA9C,IAAAmD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA7C,GAAAmD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,gBACAC,OAAAN,QAAA4F,OAAAvF,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA6F,MAAAvF,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,6BACAA,OAAAL,QAAA,KAAAY,KAAAb,OAAAA,QAAAA,OAAA8B;AAAAhB,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,eACAH,OAAAL,QAAA,KAAAY,KAAAb,OAAAA,QAAAA,OAAA6X,SAAA/W,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAsL,SAAApN,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,qBACAH,OAAAL,QAAA,KAAAY,KAAAb,OAAAA,QAAAA,OAAAqiC,SAAAvhC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAA6gC,SAAA3iC,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,gBClHAtF,OAAA,4CAAA,cCoBAA,OAAA,mDACA,SACA,SACA,OACA,QACA,UACA,cACA,eACA,8CACA,gDACA,6CACA,0CACA,2CACA,sCACA,oDACA,sDACA,0CACA,SAAAuG,EAAApF,EAAAC,GAAA4Y,MAAAlV,QAAA6B,SAAA8H,UAAA04B,cAAA5E,mBAAAgC,gBAAAa,aAAAwB,cAAArB,UAAA6B,QAAAC;AACA,YAqcA,SAAAC,mBAAAz4B,QAUA,MARAA,SACA1N,EAAA+I,SAAA,QAAA,SAAA,SAAA,OAAA,UAAA,SAAAgS,MACArN,OAAAqN,QACArN,OAAAqN,MAAA9a,GAAAyN,OAAAqN,UAKAzN,UAAAhO,WAAAuO,WACAK,YAAA+3B,SAGA59B,GAAA,UAAA,WACAxE,KAAAuiC,SAAA,KACAviC,KAAA5C,OAAA,OAIAoH,GAAA,SAAA,WACA,GAAAzD,MAAAf,IAGAA,MAAA5C,OAAA+kC,gBAGAniC,KAAAuiC,UACAC,OAAAxiC,KAAAyiC,WAAA/lC,KAAA,iCACAgmC,QAAA1iC,KAAAyiC,WAAA/lC,KAAA,cACAimC,SAAA3iC,KAAAyiC,WAAA/lC,KAAA,aAIAsD,KAAAuiC,SAAAC,OAAAh+B,GAAA,QAAA,WACAzD,KAAA6hC,QAIA5iC,KAAAuiC,SAAAI,SAAAn+B,GAAA,QAAA,qCAAA,WACA,GAAAyH,MAAA1K,EAAAvB,MAAAmM,QAAA,UACA02B,QAAA52B,KAAAE,QAAA,iBACA22B,SAAAD,QAAAnmC,KAAA;AACAomC,SAAAz2B,YAAA,UACAJ,KAAAJ,SAAA,UACAg3B,QAAAnmC,KAAA,gCAAA2P,YAAA,YAIArM,KAAAuiC,SAAAI,SAAAn+B,GAAA,QAAA,qCAAA,WACA,GAAAyH,MAAA1K,EAAAvB,MAAAmM,QAAA,UACA02B,QAAA52B,KAAAE,QAAA,iBACA22B,SAAAD,QAAAnmC,KAAA,WACAomC,UAAAj3B,SAAA,UACAI,KAAAJ,SAAA,UACAg3B,QAAAnmC,KAAA,gCAAA2P,YAAA,cAGAC,KAAAzC,QAxfA,GAAAG,YACAtE,MAAAtJ,GAAA,mBACAylC,OAAAzlC,GAAA,qIACAsK,KAAAtK,GAAA;AACA0lC,OAAA1lC,GAAA,qBACA2mC,YAAA,YACAC,YAAA,QACAvC,WAAA,oBACAhE,UAAA,uBAQAwG,kBACAr7B,OAAA,eACA64B,WAAA,uBACAhE,UAAA,uBAQAyG,oBAEAv6B,KAAA,IAGAw6B,MAAA,GAGAv3B,IAAA,KAQAw3B,uBAEAC,QAAA,KAGA5rB,UAAA,KAOAhc,YAOA6nC,aAAA,SAAAlmC,QAIA,MAHA4C,MAAAkgB,GAAA,aACAlgB,KAAAuiC,SAAAG,QAAA7/B,KAAAzF,QAEA4C,MASAujC,MAAA,SAAA5/B,KAAAu+B,QAAAt+B,MACA,GAAAiG,QAAA7J,KAAA6J,MAEAq4B,SAAA/lC,EAAAmkC,KAAA4B,QAAA,UACAA,QAAAv+B,KAAAA,KAEApC,EAAAiiC,KACA1jC,QAAA2E,KAAAoF,OAAAk5B,YAAAl5B,OAAA42B,WAAA52B,OAAA4yB,UAAA5yB,OAAA45B,aACAvB,QACAt+B,KACA;EAQA8/B,aAAA,SAAA9/B,MACA,GAAA7C,MAAAf,KACA6J,OAAA7J,KAAA6J,MAEA7J,MAAAsjC,aAAAlnC,GAAA,4BAEAwlC,cAAA/5B,OAAA04B,UAAAvgC,KAAA6J,OAAA85B,QAAAV,mBAAA9gC,MAAA,SAAAyhC,aAEAriC,EAAAiiC,KACA1jC,QAAA2E,KAAAoF,OAAAm5B,YAAAn5B,OAAA42B,WAAA52B,OAAA4yB,UAAA5yB,OAAA45B,aACAG,YACA,SAAAtkC,MACA,GAAA6X,YAAA,YAAA7X,KAAAqE,KAAA,IAAA,YAAArE,KAAAqE,KAAA,GAAA,EACAvG,OAAA2D,KAAA3D,OAAAf,UAAA8a,WAAA7X,MACAyX,SACA4sB,SACAx8B,QAAA/K,GAAA,eACAmO,MAAAq5B,YAAAD,QAAA,IAAAC,YAAAC,gBAEAC,IACA38B,QAAA/K,GAAA,oBACAmO,MAAAq5B,YAAAE,GAAA,IAAAF,YAAAG,WAIA3mC,QAAAJ,GAAA,UACAI,OAAAsI,MAAAtJ,GAAA;AAEA2E,KAAAijC,UAAA5mC,QAEAwG,KAAAxG,OAAA2Z,UAEA,WASAktB,kBAAA,SAAArgC,MACA,GAAA7C,MAAAf,KACA6J,OAAA02B,UAAAvgC,KAAA6J,OAAA4M,aAAA2sB,uBACAC,QAAAx5B,OAAAw5B,QACAa,MAAAr7B,KAAAmP,IAAAqrB,QAAAx5B,OAAA,UAEA7J,MAAAsjC,aAAAlnC,GAAA,iCACAmhC,mBAAA1zB,OAAA2zB,QAAA3zB,OAAA4zB,YAAA,IAAA5zB,OAAA6zB,SAAAv7B,MAAA,SAAA+W,QAAAgpB,SACA,GAAAiC,QAAAD,MAAAhrB,QAAAmqB,QACAjmC,OAAA2D,KAAA3D,OAAAf,UAAA8nC,OAAAD,MAAA,IAAA,gBACAntB,SACAqtB,iBAAAj9B,QAAA/K,GAAA,0BAAAmO,MAAA23B,QAAAp5B,IAAA,MACAu7B,iBAAAl9B,QAAA/K,GAAA,0BAAAmO,MAAA23B,QAAAt2B,IAAA,MACA04B;AAAAn9B,QAAA/K,GAAA,0BAAAmO,MAAA23B,QAAAhpB,QAAA,MAGAnY,MAAAwiC,MAAA,cAAArB,QAAA,WACA9kC,OAAAJ,GAAA,cACAI,OAAAsI,MAAAtJ,GAAA,4BAEA2E,KAAAijC,UAAA5mC,QACAwG,KAAAxG,OAAA2Z,cASAwtB,eAAA,SAAA3gC,MACA,GAAA7C,MAAAf,KACA6J,OAAA02B,UAAAvgC,KAAA6J,OAAA8M,UAAAusB,mBAEAljC,MAAAsjC,aAAAlnC,GAAA,8BACAmjC,kBAAAp9B,MAAA,SAAA+W,QAAAgpB,SACA,GAAAnrB,UACAytB,cAAAr9B,QAAA/K,GAAA,qBAAAmO,MAAA23B,QAAAp5B,IAAA,SACA27B,cAAAt9B,QAAA/K,GAAA,qBAAAmO,MAAA23B,QAAAt2B,IAAA,SACA84B,kBAAAv9B,QAAA/K,GAAA,qBAAAmO,MAAA23B,QAAAhpB,QAAA;EAGAnY,MAAAwiC,MAAA,YAAArB,QAAA,WACA,GAAA9kC,WAEAunC,cAAA96B,OAAAlB,KACAzM,WAAA2N,OAAAs5B,MACAyB,cAAA/6B,OAAA+B,GAEAzP,GAAAqK,QAAAtK,cACAA,YAAAA,aAGAC,EAAA+I,QAAAhJ,WAAA,SAAAub,UAAAJ,GACA,GAAAzL,KAAA6L,UAAAktB,cACAE,GAAA9jC,KAAA3D,OAAAf,UAAA6lC,QAAAt2B,IAAAA,IAAA,IAAA,aACAkyB,GAAAj1B,KAAAmQ,MAAAkpB,QAAAt2B,IAAA+4B,cAEA7G,IAAA8G,gBACA9G,GAAA,IAAA8G,eAGAC,GAAA7nC,GAAA,aAAAqa,EACAwtB,GAAAn/B,MAAAtJ,GAAA,aACAyoC,GAAAljC,SAAAogC,OAAA3lC,GAAA,gEAEAyoC,GAAAntB,QAAAza,MAAA6gC,GAEAA,GAAAnM,WAAAtsB,OAAA,IACAw/B,GAAAntB,QAAAsqB,MAAA,GAGA5kC,OAAA+R,KAAA01B,IAEA9jC,KAAAijC,UAAAa,MAGAjhC,KAAAxG,OAAA2Z,cASA+tB,YAAA,SAAAlhC;AACA,GAAA7C,MAAAf,KACA6J,OAAA7J,KAAA6J,OAAAgN,MAEA7W,MAAAsjC,aAAAlnC,GAAA,6BACAgkC,aAAAv2B,QAAA1H,MAAA,SAAA7C,MACA,GACAylC,UADAC,WAAA,EAEAC,SAAA,EACA5B,QAAAx5B,OAAAw5B,QAAA,KAAA,IAEAlnC,GAAA+I,QAAA5F,KAAA,SAAAmL,KACAu6B,YAAAv6B,IAAAy0B,MACA+F,SAAAx6B,IAAAy0B,QACA+F,SAAAp8B,KAAA0O,MAAA,IAAA9M,IAAAy0B,OAAA,OAGA6F,SAAAl8B,KAAA0O,MAAAytB,WAAA1lC,KAAA+F,OAAA,KAAA,GAEA,IAAAjI,QAAA2D,KAAA3D,OAAAf,UAAA,IAAAgnC,QAAA0B,SAAA,UACAhuB,SACAmuB,WAAA/9B,QAAA/K,GAAA,wBAAAmO,MAAAw6B,SAAA,SACAI,WAAAh+B,QAAA/K,GAAA,oBAAAmO,MAAA06B,SAAA,SAGAlkC,MAAAwiC,MAAA,UACA33B,IAAAq5B,SACA9sB,IAAA4sB,SACAphC,KAAA,UACA,WACAvG,OAAAJ,GAAA;AACAI,OAAAsI,MAAAtJ,GAAA,gBAEA2E,KAAAijC,UAAA5mC,QAEAwG,KAAAxG,OAAA2Z,cAUAitB,UAAA,SAAA1hC,QACA,GAAAugC,SAAAuC,UAuBA,OArBAplC,MAAAkgB,GAAA,cAEA5d,OAAAoV,SAAApV,OAAAoV,QAAAza,OAAAqF,OAAAoV,QAAAza,MAAA00B,WAAAtsB,OAAA,IACA/C,OAAAoV,QAAAsqB,MAAA,GAIAa,QAAAthC,EAAA8gC,UAAA//B,SACA8iC,WAAAvC,QAAAnmC,KAAA,sBACAsD,KAAAuiC,SAAAI,SAAA/hB,OAAAiiB,SAGAA,QAAAwC,OAAA,WACAD,WAAA//B,QACA+/B,WAAAE,SACAC,KAAAjjC,OAAA6U,WAAA0rB,QAAA2C,aAAA,IAAAJ,WAAAI,aAAA,OAMAxlC,MAQAylC,QAAA,WAgBA,MAXAzlC,MAAAqL,QAAA,SACArL,KAAAsjC,aAAAlnC,GAAA,gBACA4D,KAAA+tB,SAAA,WAAA,GACA/tB,KAAA+tB,SAAA,QAAA;AAGA/tB,KAAAuiC,SAAAI,SAAAp7B,QAGAvH,KAAAuiC,SAAAC,OAAA32B,SAAA,UAEA7L,MAQA0lC,OAAA,WAaA,MAXA1lC,MAAAuiC,SAAAC,OAAAn2B,YAAA,UAMArM,KAAAqL,QAAA,OACArL,KAAAsjC,aAAAlnC,GAAA,UACA4D,KAAA+tB,SAAA,WAAA,GACA/tB,KAAA+tB,SAAA,QAAA,GAEA/tB,MAOA4iC,IAAA,WAMA,QAAA+C,SAAAC,OAAAv2B,IAMAtO,KAAAsK,QAAA,cAAAu6B,QACA7kC,KAAAgtB,SAAA6X,QAAA,GAEA7kC,KAAA6kC,QAAA,SAAAxoC,OAAA8kC,SAEA/lC,EAAAuW,OAAAkxB,YAAA1B,SAIA/lC,EAAAqK,QAAApJ,UACAA,QAAAA,SAEAjB,EAAA+I,QAAA9H,OAAA,SAAAynC,IACAgB,OAAAhB,GAAA7nC,IAAA6nC,KASA9jC,KAAAsK,QAAA,YAAAu6B,OAAAxoC,QACA2D,KAAAgtB,SAAA6X,QAAA,GAGAv2B,OArCA,GAAAtO,MAAAf,KACA4jC,eACAiC,SAsEA,OA/BA7lC,MAAAkgB,GAAA,cAEAlgB,KAAAylC;AAGAzwB,MAAAkpB,QAAA,SAAA7uB,IACAs2B,QAAA,eAAAt2B,KACA,SAAAA,IACAs2B,QAAA,oBAAAt2B,KACA,SAAAA,IACAs2B,QAAA,iBAAAt2B,KACA,SAAAA,IACAs2B,QAAA,cAAAt2B,MACA,WAEA,GAAAy2B,OAAA3pC,EAAA2M,IAAA+8B,OAAA,cAGAzoC,OAAA2D,KAAA3D,OAAAf,UAAAypC,MAAA3uB,WAAA,UAGA/Z,QAAAsI,MAAAtJ,GAAA,SACAgB,OAAAJ,GAAA,QACAI,OAAA8kC,QAAA0B,YACA7iC,KAAAijC,UAAA5mC,QAGA2D,KAAA2kC,YAIA1lC,MA6FA,OAAAsiC,qBCxiBAtnC,OAAA,+CAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,OACAF,OAAAN,QAAA+hC,QAAA1hC,OAAAC,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAgiC,OAAA1hC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,OAIA,QAAAiJ,UAAAvJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAMA,OALAA,SAAA,OACAF,OAAAN,QAAA4G,MAAAvG,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA6G,KAAAvG,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,OAtBAH,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAC,QAAAC,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,iBAAAO,KAAAf,KAAAS,cAAAX,QAAAW;AA2CA,MAnBAH,SAAA,mDACAF,OAAAN,QAAA4F,OAAAvF,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA6F,MAAAvF,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,6CACAA,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAgiC,QAAAlhC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,aACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA6G,MAAA/F,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAgI,SAAA9J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH;AACAG,QAAA,uDACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,eAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,eAAAQ,WACA,uIACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,mBAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,mBAAAQ,WACA;CACAD,OAAAN,QAAAgiC,QAAA3hC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAiiC,OAAA3hC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,0ICvBAnF,OAAA,kDACA,SACA,OACA,UACA,qBACA,eACA,cACA,sCACA,kDACA,+CACA,SAAAuG,EAAAnF,GAAA0D,QAAA0B,WAAAukC,UAAApkC,SAAAG,mBAAAwgC,kBAAA0D;AACA,YAMA,IAAA/jC,UAAA,oBAGAT,YAAAW,OAOA,IAAA8jC,oCAIA9jC,MAAA,WAgBA,QAAA+jC,eAAAC,aACA7D,kBAAAz4B,QACAQ,YAAA27B,eACAxhC,GAAA,SAAA,WACA,GAAAzD,MAAAf,IAGAA,MAAAuiC,SAAA6D,aAAApmC,KAAA0L,aAAAhP,KAAA,gCACA8H,GAAA,WAAA,SAAAwB,GACA,KAAAA,EAAAqgC,QACArgC,EAAAG,iBACApF,KAAA6hC,SAGAn4B,IAAA07B,eAEA3hC,GAAA,QAAA,WAEAxE,KAAA6J,OAAA45B,YAAAzjC,KAAA6J,OAAA45B,gBACAzjC,KAAA6J,OAAA45B,YAAA0C,YAAAnmC,KAAAuiC,SAAA6D,aAAA37B,MAGAzK,KAAAuiC,SAAA6D,aAAA9lB,KAAA,YAAA,GACA9e,WAAAW,UAEAqC,GAAA,MAAA,WAEAxE,KAAAuiC,SAAA6D,aAAAE,WAAA;AACA9kC,WAAA2B,SAEAqB,GAAA,SAAA,WACAhD,WAAA2B,SAEAqe,OAAA3a,OAhDA,GAAAzH,YAAAmC,EAAAU,UACA4E,MAAAzH,WAAA1C,KAAA,SACA6pC,OAAAhlC,EAAA,UACAlC,OAAAD,WAAAE,KAAA,eACAuK,OAAAzK,WAAAE,KAAA,UACAoF,aAAAtF,WAAAE,KAAA,cACAknC,SAAA1mC,QAAA2E,KAAA,QAAA,aAAA,iBAAArJ,WAAAsJ,eACA+hC,eAAA3mC,QAAA2E,KAAA,cAAA,oBAAA,iBAAArJ,WAAAsJ,cAEA5C,oBAAA1C,WAAAC,OA0CA0mC,YACAxmC,SAAAgnC,OACA14B,UACA7Q,GAAA,OACA2K,KAAA,gBACAjC,MAAAtJ,GAAA,sBACAa,MAAAb,GAAA,4BACAwL,OAAA,WACAC,OAAAC,SAAAC,KAAAy+B;MAMAjlC,EAAA6E,IAAAqgC,eAAA,QACA7iC,KAAA,SAAAtE,MACA4mC,cAAA5mC,MAAAA,KAAA6mC,eAEAvwB,KAAA,WACAjU,WAAAkD,MAAAzI,GAAA,wCACA8pC,mBAKA,OAAAD,qCChHAjrC,OAAA,6CACA,SACA,OACA,UACA,qBACA,cACA,cACA,YACA,sCACA,8CACA,gBACA,SAAAuG,EAAAnF,GAAA0D,QAAA0B,WAAAE,OAAAC,SAAAgF,OAAA7E,mBAAAqgC,eACA,YAiBA,SAAAuE,cAAAC,OAAAC,QACA,GAAA9I,IAAAjoB,SAAA+wB,OAAA,EAAA/9B,KAAA+C,IAAA,EAAA6F,SAAAm1B,OAAA,KACAC,OAAAh+B,KAAAkP,IAAA,GAAA+lB,KAAA;AACA,MAAAj1B,MAAA0O,MAAAovB,OAAAE,QAAAA,OAdA,GAAA5kC,UAAA,mBAGAT,YAAAW,OAmBA,IAAA2kC,8BAIA3kC,MAAA,WA0BA,QAAA+E,SAAA3D,IAAAO,UAAAqD,SACArD,WAAAA,UAAAuB,SACA7D,WAAAW,QAEAZ,EAAA+B,MACAC,IAAAA,IACAjE,MACAtC,GAAA8G,WAEAJ,SAAA,OACAC,KAAA,OACAkB,MAAA,WACArD,WAAA2B,UAEAS,KAAA,SAAAkB,UACAtD,WAAA2B,OAEA2B,UAAAA,SAAAG,SACAkC,SACAxF,WAAAsD,QAAAkC,SAEAN,MAAAQ,UAAA,YAEA1F,WAAAkD,MAAAzI,GAAA,4BAAA,OAAAsF,OAAAmB,KAAAiC,SAAAD,QAAAW,YAAA,OAOA,QAAA8B,QAAAxD,WACAoD,QAAAF,UAAAlD,UAAA1H,GAAA;CAxDA,GAAAgD,YAAAmC,EAAAU,UACA4E,MAAAzH,WAAA1C,KAAA,SACA2C,OAAAD,WAAAE,KAAA,eACAwH,QAAA1H,WAAAE,KAAA,OACAuK,OAAAzK,WAAAE,KAAA,cACAynC,mBAAA3nC,WAAAE,KAAA,wBAAA,EACAoF,aAAAtF,WAAAE,KAAA,cACA0nC,cAAAlnC,QAAA2E,KAAA,aAAA,aAAA,iBAAArJ,WAAAsJ,eACAuiC,YAAAnnC,QAAA2E,KAAA,sBAAA,aAAA,iBAAArJ,WAAAsJ,eACAsC,UAAAlH,QAAA2E,KAAA,SAAA,aAAA,iBAAArJ,WAAAsJ,eACAlB,WAAA1D,QAAA2E,KAAA,iBAAA,aAAA,iBAAArJ,WAAAsJ,eAEAwiC,mBAAAr9B,OAAA4M,iBACA0wB,oBAAAD,mBAAA7D,QACA+D,kBAAAv+B,KAAAmP,IAAAmvB,oBAAAD,mBAAA,WAEAG,iBAAAlF,gBAIAz6B,OAFA5F,mBAAA1C,WAAAC;IAGAnE,WACAmN,QAsCAX,OAAAyH,MACAnS,GAAA,UACA2K,KAAA,QACAjC,MAAAtJ,GAAA,oBACAa,MAAAb,GAAA,WACAwL,OAAA,WACAf,MAAAQ,UAAA,cAKAK,MAAAyH,MACAnS,GAAA,SACA2K,KAAA,OACAjC,MAAAtJ,GAAA,kCACAa,MAAAb,GAAA,0BACAwL,OAAA,WACAC,OAAAC,SAAAC,KAAAi/B,iBAIAD,oBAEAr/B,MAAAyH,MACAnS,GAAA,MACA2K,KAAA,OACAjC,MAAAtJ,GAAA,uBACAa,MAAAb,GAAA,uBACAwL,OAAA,WACAC,OAAAC,SAAAC,KAAAk/B,eAMAv/B,MAAAyH,MACAnS,GAAA,SACA2K,KAAA,SACAjC,MAAAtJ,GAAA,+CACAa,MAAAb,GAAA,UACA4L,YAAA,EACAJ,OAAA,SAAA9D,WACA6C,QACAQ,QAAA/K,GAAA;AACA6L,YAAA,EACAC,aAAA,EACAC,QAAA,WACAb,OAAAxD,iBAOA5I,QAAAiU,MACAnS,GAAA,SACA2K,KAAA,SACAjC,MAAAtJ,GAAA,sCACAwL,OAAA,SAAA5K,IACA2J,QACAsB,YAAA,EACAC,aAAA,EACAf,QAAA/K,GAAA,0DACA+L,QAAA,WACAb,QAAAtK,WAOAqL,MAAA8G,MACAnS,GAAA,cACAC,MAAAb,GAAA,iBAIAiM,MAAA8G,MACAnS,GAAA,KACAC,MAAAb,GAAA,QAIAiM,MAAA8G,MACAnS,GAAA,UACAC,MAAAb,GAAA,aAIAiM,MAAA8G,MACAnS,GAAA,cACAC,MAAAb,GAAA,gBACAiG,UAAA,SAAAkI,OACA,GAAA45B,QAAAiD,kBAAA78B,MAAA48B,oBACA/pC,OAAAiqC,iBAAAhrC,UAAA8nC,OAAAiD,kBAAA,IAAA;AACA,MAAAhqC,QAAAuE,SAAAwF,WAKAkB,MAAA8G,MACAnS,GAAA,YACAC,MAAAb,GAAA,aACAiG,UAAA,SAAAkI,OACA,GAAAoM,WAAA+vB,aAAAn8B,MAMA,OAJAA,OAAA,MACAoM,UAAA,SAGAA,UAAA,UAKAtO,MAAA8G,MACAnS,GAAA,OACAC,MAAAb,GAAA,UAGAyK,MACArC,GAAA,kBAAA,WACAhD,WAAAW,UAEAqC,GAAA,iBAAA,WACAhD,WAAA2B,SAEAkE,WACA9D,IAAAC,WACApG,QACAmK,MAAAnL,GAAA,uCACAoL,UAAApL,GAAA,iCACAqL,QAAArL,GAAA,YAEAsL,MAAAA,MACAxM,QAAAA,QACAkN,YAAA,EACAC,MAAAA,OACAvB,UAIA,OAAAggC,+BCzPA9rC,OAAA,+CACA,SACA,SACA,OACA,cACA,qBACA,UACA,uBACA,SAAAmB,EAAAoF,EAAAnF,GAAAuF,SAAAH,WAAA1B;AACA,YAOA,IAAAwnC,mBAIAnlC,MAAA,WACA,GAAAolC,OAAAhmC,EAAA,eAEAgmC,OAAA/iC,GAAA,SAAA,SAAAwB,GAEAA,EAAAE,kBACAF,EAAAG,iBACA3E,WAAAW,OAEA,IAAApB,MAAAQ,EAAAvB,MACAmF,IAAA5D,EAAA,eAAAR,MAAA0J,MACA+8B,KAAAjmC,EAAA,gBAAAR,MAAA0J,MACAg9B,GAAAlmC,EAAA,cAAAR,MAAA0J,MACAm2B,QAAAz7B,IAAAA,IAAAqiC,KAAAA,KAAAC,GAAAA,IACAC,UAAA5nC,QAAA2E,KAAA,uBAAA,eAAA,gBAAAm8B,OAEAr/B,GAAAomC,aAAAD,WACAE,gBAAA,WACApmC,WAAA2B,QAEA0kC,aAAA,SAAAxH,OACA7+B,WAAA2B,MACA,IAAA2B,UAAAvD,EAAAumC,UAAAvmC,EAAA8+B,OAAAvxB,OACAhK,WACAnD,WAAAkD,MAAA,GAAA0Y,OAAAzY,SAAAqC,gBASA,OAAAmgC,oBCtEAtsC,OAAA,gDAAA,cAAA,SAAA0E;AACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MACAU,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAE,OAAA,GAAAC,aAAA,UAQA,OALAD,SAAA,2FACAF,OAAAN,QAAAioC,MAAA5nC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAkoC,KAAA5nC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,SACAD,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,2BCQAtF,OAAA,uCACA,SACA,SACA,OACA,UACA,QACA,cACA,eACA,qCACA,gDACA,SAAAmB,EAAAoF,EAAAnF,GAAA0D,QAAAkoC,MAAArmC,SAAA8H,UAAA0M,cAAA8xB;AACA,YAiBA,SAAAC,oBAAA9oC,WAAA+oC,UACA/oC,WAAAyD,KAAAolC,SACAF,KAAAI,SAAAJ,QAEAC,MAAAI,WAAAD,SAAAE,QAAAC,sBAnBA,GAAAC,KAAA,gBAGAC,eAAA1oC,QAAA2E,KAAA,oBAAA,iBAAA,iBACA6jC,qBAAAxoC,QAAA2E,KAAA,aAAA,iBAAA,gBA0BA,OAvBA3E,SAAAwM,OAuBA,SAAAzC,QAEA,MAAAJ,aACAjF,GAAA,UAAA,WACAxE,KAAA0L,aAAA+8B,IAAAF,KAAAhhC,UAEA/C,GAAA,SAAA,WAEA,GAAAzD,MAAAf,KACA0oC,SAAA1oC,KAAA0L,YAEAyK,iBAAAC,KAAA,SAAAX,QACAlU,EAAA6E,IAAAoiC,eAAA,SAAAL,UAEAD,mBAAAQ,SAAAP,UAEAO,SAAAlkC,GAAA,SAAA+jC,IAAA,OAAA,SAAAviC;AAEA,GAAAuhC,OAAAhmC,EAAAvB,MACA2oC,OAAApB,MAAAqB,iBACAnjC,KAAA1E,KAAA8I,OAAAg/B,eACAvpC,MACAwpC,YAAArjC,MAAAA,KAAAsjC,eAEA5sC,GAAA4M,KAAA4/B,OAAA,SAAAK,OACA1pC,KAAA0pC,MAAA9xB,MAAA8xB,MAAAz+B,QAGAhJ,EAAAiiC,KAAAgF,eAAAlpC,KAAA,SAAA+G,KACAA,IAAA4iC,SACAtnC,WAAAsD,QAAAwQ,OAAArP,IAAA,oBACArF,KAAA+K,WAEAo8B,mBAAAQ,SAAAriC,OAIAL,EAAAG,mBACA3B,GAAA,QAAA,qBAAA,WACAzD,KAAA+K,gBAGAuK,MAAA,SAAAC,KACAR,QAAAC,IAAAO,SAIAhK,KAAAzC,WC7GA7O,OAAA,uDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP;AAEA,GAAAa,QAAAG,OAAA,EAKA,OAJAA,SAAA,SACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAuF,OAAAzE,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAA4H,SAAA1J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,KAGA,QAAA0I,UAAAnJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAE,OAAA,EAcA,OAbAA,SAAA,gBACAF,OAAAN,QAAAL,KAAAU,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAJ,IAAAU,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,yBACAC,OAAAN,QAAA7C,OAAAkD,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA5C,MAAAkD,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,iCACAC,OAAAN,QAAAsF,OAAAjF,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAuF,MAAAjF,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,gBA5BAH,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAI,aAAA,WAAAC,iBAAAR,KAAAQ,iBAAAO,KAAAf,IA+BA,OADAG,QAAAL,QAAAiJ,KAAArI,KAAAb,OAAAA,QAAAc,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,OACAa,QAAA,IAAAA,OAAAA,OACA,OCpCAnF,OAAA,qDAAA,cAAA,SAAA0E;AACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAc,QAAAC,QAAAC,OAAA,EAGA,OAFAA,SAAAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,aAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,aAAAQ,WACA,6CAIA,QAAA+I,UAAAvJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAC,QAAAC,OAAA,EAQA,OAPAA,SAAA,iBACAF,OAAAN,QAAAgpC,aAAA3oC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAipC,YAAA3oC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc;AACAE,QAAAE,iBAAAL,QACA,KACAK,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,uBAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,uBAAAQ,WACA,UArBAL,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAG,OAAA,GAAAG,cAAAX,QAAAW,cAAAD,iBAAAR,KAAAQ,iBAAAD,aAAA,WAAAQ,KAAAf,IA4BA,OALAG,QAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAApB,YAAAkC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,KACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAqpC;AAAAvoC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAgI,SAAA9J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,WCbAtF,OAAA,iDACA,SACA,SACA,OACA,UACA,qBACA,cACA,cACA,oBACA,qBACA,cACA,sCACA,sCACA,qCACA,sDACA,oDACA,gBACA,SAAAmB,EAAAoF,EAAAnF,GAAA0D,QAAA0B,WAAAE,OAAAC,SAAAwnC,cAAAvnC,gBAAAwnC,SAAAtnC,mBAAAunC,YAAAlzB,cAAAmzB,WAAAC;AACA,YAMA,IAAAtnC,UAAA,wBAGAunC,gBAAA1pC,QAAA2E,KAAA,wBAAA,iBAAA,iBACAglC,aAAA3pC,QAAA2E,KAAA,YAAA,iBAAA,iBACAilC,eAAA5pC,QAAA2E,KAAA,cAAA,iBAAA,iBAGAklC,QACAC,MAAA,EACAC,KAAA,EACAC,KAAA,EAIAtoC,YAAAW,OAOA,IAAAD,oBAIAC,MAAA,WACAgU,gBAAAC,KAAA,SAAAX,QAkBA,QAAAvO,SAAA3D,IAAAO,UAAAqD,SACArD,WAAAA,UAAAuB,SACA7D,WAAAW,QAEAZ,EAAA+B,MACAC,IAAAA,IACAjE,MACAwpC,YAAArjC,KAAAsjC,eACAgB,SAAAjmC,WAEAJ,SAAA,OACAC,KAAA,OACAkB,MAAA,WACArD,WAAA2B,UAEAS,KAAA,SAAAkB,UACAtD,WAAA2B;AAEA2B,UAAAA,SAAAG,SACAkC,SACAxF,WAAAsD,QAAAkC,SAEA6iC,eAAA3iC,UAAA,YAEA1F,WAAAkD,MAAAzI,GAAA,4BAAA,OAAAsF,OAAAmB,KAAAiC,SAAAD,QAAAW,YAAA,OAMA,QAAArH,WAAA2F,UAAAqD,SACAgiC,cAAAhiC,QAAA,WACAD,QAAAuiC,aAAA3lC,UAAA2R,OAAArP,IAAA,0BAIA,QAAA6jC,QAAAnmC,UAAAqD,SACAgiC,cAAAhiC,QAAA,WACAD,QAAAwiC,eAAA5lC,UAAA2R,OAAArP,IAAA,uBAIA,QAAA8jC,aAAApmC,WACA,GAAAA,UAAAuB,OAOA,OAAA8kC,UACA,IAAAR,QAAAC,MACAO,SAAAR,OAAAE,IAEA,KAAAF,QAAAE,KACAG,eAEA3iC,UAAA,WACAu5B,QAAAkI,YAAA,QAGAzhC,UAAA;AACAu5B,QAAAkI,YAAAhlC,aAEAuD,UAAA,UACA,MAEA,KAAAsiC,QAAAG,UAvBAH,QAAAE,OAAAM,SACAA,SAAAR,OAAAC,MACAD,OAAAC,QAAAO,UACAxoC,WAAA4D,QAAAnJ,GAAA,6CA0BAguC,cAAAnnB,YAAA,SAAA0mB,OAAAC,QAAAO,UACAH,eAAA/mB,YAAA,SAAA0mB,OAAAE,OAAAM,UACAE,eAAApnB,YAAA,SAAA0mB,OAAAG,OAAAK,UA5FA,GAAA/qC,YAAAmC,EAAAU,UACAqoC,gBAAA/oC,EAAA,sBAEAyoC,gBADAzoC,EAAA,kBACAA,EAAA,kBACA8oC,eAAA9oC,EAAA,mBACA6oC,aAAA7oC,EAAA,oBACAunC,YAAA1pC,WAAAE,KAAA,QACAD,OAAAD,WAAAE,KAAA,eACA6qC,SAAAR,OAAAC,MAEAnkC,MADA3D,mBAAA1C,WAAAC;AACA+pC,UACA7pC,SAAA+qC,gBACA1kC,WAAAxJ,GAAA,cACAmuC,UAAAnuC,GAAA,aACAgM,YAAA,GACA0gC,aAgFArjC,MAAAjB,GAAA,SAAA,SAAAV,WACAomC,YAAApmC,aAGAkmC,eACAxlC,GAAA,kBAAA,WACAhD,WAAAW,UAEAqC,GAAA,iBAAA,SAAAwB,EAAAc,SACA,GAAAoiC,WAAA,EACAzqC,WAAA,EACA+rC,MAAA1jC,SAAAA,QAAAxH,IACAnD,GAAA+I,QAAAslC,MAAA,SAAAC,MACA,GAAAA,MAAAA,KAAArtC,OACA,OAAAqtC,KAAArtC,QACA,IAAA,GAAA8rC,WAAA,MACA,KAAA,GAAAzqC,gBAMA8C,EAAAvB,MAAAtD,KAAA,yBAAAkkB,OAAA0oB,aACAtsC,GAAA,kBACAC,MAAAwY,OAAArP,IAAA,uBACAhB,MAAA3G,aAEAzB,GAAA,iBACAC,MAAAwY,OAAArP,IAAA;AACAhB,MAAA8jC,cAGA1nC,WAAA2B,SAEAkE,WACA9D,IAAAimC,gBACApsC,QACAmK,MAAAkO,OAAArP,IAAA,wBACAoB,UAAAiO,OAAArP,IAAA,qBACAqB,QAAArL,GAAA,YAEAsL,QACA1K,GAAA,UACA2K,KAAA,QACAjC,MAAAtJ,GAAA,oBACAa,MAAAb,GAAA,WACAwL,OAAA,WACAoiC,eAAA3iC,UAAA,cAGArK,GAAA,SACA2K,KAAA,MACAjC,MAAA+P,OAAArP,IAAA,kCACAnJ,MAAAwY,OAAArP,IAAA,kBACAwB,OAAA,WACA,GAAA9D,WAAA2B,KAAAsjC,cAEAM,cACA9pC,SAAA8qC,eACAxB,eAAApjC,OACAjB,GAAA,UAAA,WACA2lC,SAAAR,OAAAE,KACAK,YAAAzkC,KAAAsjC,kBAEAoB,SAAAR,OAAAG,KACAI,YAAApmC;IAGA9G,GAAA,YACA2K,KAAA,YACAjC,MAAA+P,OAAArP,IAAA,mCACAnJ,MAAAb,GAAA,aACA4L,YAAA,EACAJ,OAAA,SAAA9D,WACA3F,UAAA2F,UAAA2R,OAAArP,IAAA,mDAGApJ,GAAA,SACA2K,KAAA,SACAjC,MAAA+P,OAAArP,IAAA,kDACAnJ,MAAAb,GAAA,UACA4L,YAAA,EACAJ,OAAA,SAAA9D,WACAmmC,OAAAnmC,UAAA2R,OAAArP,IAAA,gDAGAlL,UACA8B,GAAA,YACA2K,KAAA,YACAjC,MAAA+P,OAAArP,IAAA,yBACAyL,OAAA,WACA,MAAA,KAAA7R,KAAA5C,QAEAwK,OAAA,SAAA5K,IACAmB,WAAAnB,IAAAyY,OAAArP,IAAA;IAGApJ,GAAA,SACA2K,KAAA,SACAjC,MAAA+P,OAAArP,IAAA,sBACAyL,OAAA,WACA,OAAA7R,KAAA5C,QAEAwK,OAAA,SAAA5K,IACAitC,QAAAjtC,IAAAyY,OAAArP,IAAA,+CAGAgC,YAAA,EACAC,QACArL,GAAA,YACAC,MAAAb,GAAA,gBAEAY,GAAA,WACAC,MAAAb,GAAA,eAEAY,GAAA,QACAC,MAAAb,GAAA,WAEAY,GAAA,QACAC,MAAAb,GAAA,UACAiG,UAAA,SAAAkI,MAAA0G,KACA,MAAAs4B,YACAT,YAAA73B,IAAAxS,WACAyqC,UAAA,IAAAj4B,IAAA7T,OACAqB,WAAA,IAAAwS,IAAA7T,iBAMAoE,WAAA2B,SACAkT,MAAA,SAAAC,KACAR,QAAAjR,MAAAyR,QAKA,OAAApU,qBC/SAlH,OAAA,8CAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT;AACAU,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAC,QAAAC,OAAA,GAAAG,cAAAX,QAAAW,cAAAD,iBAAAR,KAAAQ,iBAAAD,aAAA,UAkBA,OAfAD,SAAA,wCACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,OAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,OAAAQ,WACA,yDACAD,OAAAN,QAAAqC,OAAAhC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAsC,MAAAhC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,mBACAK,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,KAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,KAAAQ,WACA,uDACAD,OAAAN,QAAAi9B,KAAA58B,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAk9B,IAAA58B,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,mGACAK,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,SAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,SAAAQ,WACA,yBCFArF,OAAA,qCACA,SACA,SACA,eACA,6CACA,qBACA,SAAAuG,EAAApF,EAAAsN,UAAAw+B,SACA,YAqBA,SAAAyC,kBAAA7gC,QACA,GAAAC,YAAA3N,EAAA4N,SAAAF,WAAAG,WACAnJ,YAAAiJ,WAAA3H,OAAA,GACArB,UAAAgJ,WAAAizB,KAAA,GAEA4N,WAKAC,SAAA,WACA,MAAA/pC,cAOAgqC,OAAA,WACA,MAAA/pC,YAOA,OAHAgJ,YAAA3H,MAAAtB,YACAiJ,WAAAizB,IAAAj8B,UAEA2I,UAAAkhC,WACAtgC,YAAA49B,SACAzjC,GAAA,SAAA;AACA,GAAAzD,MAAAf,KACAunC,MAAAvnC,KAAA0L,aACAo/B,aAAAvD,MAAA7qC,KAAA,2BACAquC,WAAAxD,MAAA7qC,KAAA,yBACAsuC,WAAAzD,MAAA7qC,KAAA,0BAEAouC,cAAAG,YACAC,WAAAphC,WAAAohC,WACAC,UAAA,IACAC,OAAA,WACAvqC,YAAAiqC,aAAArgC,MACAsgC,WAAAE,WAAA,SAAA,UAAApqC,aAOAE,KAAAsK,QAAA,SAAA,QAAAxK,eAGAkqC,WAAAE,YACAC,WAAAphC,WAAAohC,WACAC,UAAA,IACAC,OAAA,WACAtqC,UAAAiqC,WAAAtgC,MACAqgC,aAAAG,WAAA,SAAA,UAAAnqC,WAOAC,KAAAsK,QAAA,SAAA,MAAAvK,aAGAkqC,WAAAxmC,GAAA,QAAA,SAAAuH,OACAA,MAAA5F;AAEAtF,YAAAiqC,aAAArgC,MACA3J,UAAAiqC,WAAAtgC,MAKA1J,KAAAsK,QAAA,cAGAiB,KAAAxC,YA3FA,GAAAE,YACAkhC,WAAA,WA6FA,OAAAR,oBC5GA1vC,OAAA,gDACA,SACA,SACA,OACA,eACA,gBACA,SAAAuG,EAAApF,EAAAC,GAAAqN,WACA,YAiBA,SAAA4hC,eAAAnJ,SAIA,MAHA/lC,GAAAqK,QAAA07B,WACAA,QAAAA,QAAA58B,KAAA,WAEA48B,QAcA,QAAAoJ,qBAAAzhC,OAAAvK,MACA,GAAAwK,YAAA3N,EAAA4N,SAAAF,WAAAG,WAGAuhC,cAKAnoC,QAAA,SAAAw9B,QACA,GAAA8H,SAEA1oC,MAAAkgB,GAAA,aACAwoB,SAAA1oC,KAAA0L,aACAk1B,QACA8H,SAAArhC,UAAA,WACAu5B,OAAAA,SAGA8H,SAAArhC,UAAA,YAEAu5B,SACA92B,WAAA82B,OAAAzkC,EAAA+D,MAAA4J,WAAA82B,OAAAA;EAMA,OAAAn3B,WAAA8hC,cACA/mC,GAAA,SAAA,WACA,GAAAzD,MAAAf,KACA0H,QACA1K,GAAA,UACA2K,KAAA,QACAjC,MAAAtJ,GAAA,oBACAa,MAAAb,GAAA,WACAwL,OAAA,WACA7G,KAAAqC,YAGApD,MAAA0L,aACAlH,GAAA,kBAAA,WACAzD,KAAAsK,QAAA,aAEA7G,GAAA,iBAAA,WACAzD,KAAAsK,QAAA,YAEAhE,WACA9D,IAAAuG,WAAA0hC,QACA5K,OAAA92B,WAAA82B,OACAruB,OAAAzI,WAAA2hC,OACAn5B,UAAAxI,WAAA4hC,UACAtuC,QACAmK,MAAAnL,GAAA,0BACAoL,UAAApL,GAAA,qBACAqL,QAAArL,GAAA,YAEAgM,cAAA0B,WAAApC,QAAAvL,EAAAO,KAAAoN,WAAApC,OAAAM,YAAA,KACAN,MAAAA,MAAAikC,OAAA7hC,WAAApC,WACAW,QACArL,GAAA;AACAC,MAAAb,GAAA,QACA4U,UAAA,IAEAhU,GAAA,OACAC,MAAAb,GAAA,QACA4U,UAAA,IAEAhU,GAAA,QACAC,MAAAb,GAAA,SACA4U,UAAA,IAEAhU,GAAA,QACAC,MAAAb,GAAA,SACA4U,UAAA,IAEAhU,GAAA,UACAC,MAAAb,GAAA,WACAiG,UAAAgpC,gBAEAruC,GAAA,UACAC,MAAAb,GAAA,WACAiG,UAAAgpC,iBAEA/rC,QAEAgN,KAAAxC,YAlHA,GAAAE,YACAyhC,OAAA,YACAC,UAAA,OAmHA,OAAAJ,uBCnIAtwC,OAAA,8CACA,SACA,SACA,OACA,UACA,qBACA,cACA,oCACA,+CACA,sCACA,gBACA,SAAAuG,EAAApF,EAAAC,GAAA0D,QAAA0B,WAAAE,OAAAgpC,iBAAAY,oBAAAxpC;AACA,YAMA,IAAAG,UAAA,mBAOA2pC,yBAIAzpC,MAAA,WACA,GAAA/C,YAAAmC,EAAAU,UACA6E,QAAA1H,WAAAE,KAAA,OACAoF,aAAAtF,WAAAE,KAAA,cACAuE,WAAAzE,WAAAE,KAAA,YACAusC,SAAAzsC,WAAAE,KAAA,YACAmsC,OAAArsC,WAAAE,KAAA,UACAosC,UAAAtsC,WAAAE,KAAA,aACAuB,YAAAzB,WAAAE,KAAA,eACAwB,UAAA1B,WAAAE,KAAA,aACAkE,WAAA1D,QAAA2E,KAAA,UAAA,YAAA,iBAAArJ,WAAAsJ,aAAAnC,SAAAsB,WAAAoK,QAAA49B,WACA5kC,cAAAnH,QAAA2E,KAAA,aAAA,WAAA,iBAAArJ,WAAAsJ,aAAAnC,SAAAsB,aACAioC,iBAAAhsC,QAAA2E,KAAA,gBAAA,WAAA;AAAArJ,WAAAsJ,eACAqnC,iBAAA,EAEAR,aAAAD,qBACA5jC,QACA1K,GAAA,OACA2K,KAAA,UACAjC,MAAAtJ,GAAA,oCACAa,MAAAb,GAAA,cACAwL,OAAA,WACAC,OAAAC,SAAAC,KAAAlE,WAAAoD,cAAA6kC,oBAGA9uC,GAAA,uBACA2K,KAAA,yBACAjC,MAAAtJ,GAAA,0CACAa,MAAAb,GAAA,wBACAwL,OAAA,WACA,GAAAokC,MAAAT,aAAA1hC,OAAAnC,MAAAhL,KAAA,SAAA+N,KAAA,MAAA,yBAAAA,IAAAzN,IAEAuuC,cAAA1hC,OAAA+2B,OAAAqL,SAAAF,iBAAAA,gBACAC,KAAA/uC,MAAAb,GAAA2vC,gBAAA,oBAAA,wBACAR,aAAAnoC;IAGAw9B,QAAAqL,SAAAF,iBACAP,QAAAhoC,WACAioC,OAAAA,OACAC,UAAAA,WACA5kC,SACAtC,GAAA,UAAA,WACAhD,WAAAW,UAEAqC,GAAA,SAAA,WACAhD,WAAA2B,SAEAqe,OAAApiB,WAAA1C,KAAA,SAEAoF,oBAAA1C,WAAAA,WAAAE,KAAA,gBAEAorC,kBACAvoC,MAAAtB,YACAk8B,IAAAj8B,UACAvB,SAAAH,WAAA1C,KAAA,YACA8H,GAAA,gBAAA,WACA+mC,aAAAnoC,SACAvC,YAAAb,KAAA4qC,WACA9pC,UAAAd,KAAA6qC,cASA,OAFArpC,YAAAW,QAEAypC,0BCpHA5wC,OAAA,uDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT;AACAU,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAE,OAAA,GAAAC,aAAA,WAAAC,iBAAAR,KAAAQ,gBAYA,OATAF,SAAA,aACAF,OAAAN,QAAAiI,MAAA5H,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAkI,KAAA5H,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,qEACAC,OAAAN,QAAAosC,mBAAA/rC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAAqsC,kBAAA/rC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb;AAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,aCIAnF,OAAA,6CACA,SACA,OACA,UACA,qBACA,aACA,sCACA,qCACA,uDACA,SAAAuG,EAAAnF,GAAA0D,QAAA0B,WAAA0B,QAAApB,mBAAAqU,cAAAg2B,cACA,YAMA,IAAAlqC,UAAA,oBAGAT,YAAAW,OAOA,IAAAiqC,yBAIAjqC,MAAA,WAEAgU,gBAAAC,KAAA,SAAAX,QAEA,GAAArW,YAAAmC,EAAAU,UACAoqC,MAAAjtC,WAAAE,KAAA,iBACAuV,MAAAzV,WAAAE,KAAA,QACAD,OAAAD,WAAAE,KAAA,eACAmG,KAAAvC;AACAwC,MAAAtJ,GAAA,iBACAuJ,UAAAvJ,GAAA,0BACAwJ,WAAAxJ,GAAA,aACAyJ,YAAAzJ,GAAA,WACAmD,SAAAH,WAAA1C,KAAA,YACA8C,SAAA,IAGAgE,YADA1B,mBAAA1C,WAAAC,QACAS,QAAA2E,KAAA,QAAA,aAAA,kBACA6nC,SAAAxsC,QAAA2E,KAAA,QAAA,iBAAA,iBAGAxB,OAAA,SAAA4R,OACApP,KAAAxC,OAAA4R,OACArT,WAAA2B,QAIAC,QAAA,WACA5B,WAAAW,QACAsD,KAAApC,YAAA,GAEA9B,EAAA+B,MACAC,IAAAC,WACAC,OAAA,EACAC,SAAA,OACAC,KAAA,QACAC,KAAA,SAAAkB,UACA+P,MAAA/P,UAAAA,SAAAW,KACAxC,OAAA4R,SAIAA,OAGA5R,OAAA4R,OAFAzR,UAKAipC,OAEAjtC,WAAA1C,KAAA,WAAAkkB,OAAAurB;AACApkC,KAAAukC,SACAJ,kBAAAz2B,OAAArP,IAAA,wBAGAiQ,MAAA,SAAAC,KACAR,QAAAC,IAAAO,QAKA,OAAA81B,0BC3FApxC,OAAA,kDACA,SACA,OACA,UACA,qBACA,aACA,uCACA,SAAAuG,EAAAnF,GAAA0D,QAAA0B,WAAA0B,QAAApB,oBACA,YAMA,IAAAG,UAAA,yBAGAT,YAAAW,OAOA,IAAAoqC,4BAIApqC,MAAA,WACA,GAAA/C,YAAAmC,EAAAU,UACA4S,MAAAzV,WAAAE,KAAA,QACAD,OAAAD,WAAAE,KAAA,eAEAoG,OADAtG,WAAAE,KAAA,MACAF,WAAAE,KAAA,UACAmG,KAAAvC,SACAwC,MAAAA,MACAC,WAAA,EACAC,YAAA;AACAC,YAAAzJ,GAAA,WACAmD,SAAAH,WAAA1C,KAAA,YACA8C,SAAA,EACAsG,MAAA,KAGAtC,YADA1B,mBAAA1C,WAAAC,QACAS,QAAA2E,KAAA,aAAA,aAAA,kBAGAxB,OAAA,SAAA4R,OACApP,KAAAxC,OAAA4R,OACArT,WAAA2B,QAIAC,QAAA,WACA5B,WAAAW,QACAsD,KAAApC,YAAA,GAEA9B,EAAA+B,MACAC,IAAAC,WACAC,OAAA,EACAC,SAAA,OACAC,KAAA,QACAC,KAAA,SAAAkB,UACA+P,MAAA/P,UAAAA,SAAAW,KACAxC,OAAA4R,SAIAA,OAGA5R,OAAA4R,OAFAzR,WAOA,OAAAmpC,6BC/FAvxC,OAAA,wDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT;AAKA,QAAAsB,UAAAf,OAAAP,MAGA,MAAA,WAGA,QAAA8J,UAAAvJ,OAAAP,MAGA,MAAA,cAGA,QAAAgK,UAAAzJ,OAAAP,MAGA,MAAA,aAGA,QAAA4J,UAAArJ,OAAAP,MAEA,GAAAa,QAAAC,OAAAC,QAAAC,OAAA,EAOA,OANAA,SAAAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,MAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,MAAAQ,WACA,iCACAD,OAAAN,QAAA8O,cAAAzO,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA+O,aAAAzO,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA;CA9BAH,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAC,QAAAC,OAAA,GAAAG,cAAAX,QAAAW,cAAAD,iBAAAR,KAAAQ,iBAAAD,aAAA,WAAAQ,KAAAf,IAmEA,OAnCAM,SAAA,iCACAH,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA2sC,aAAA7rC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,8BACAF,OAAAN,QAAA4F,OAAAvF,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA6F,MAAAvF,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc;AACAE,QAAAE,iBAAAL,QACA,8DACAA,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA2sC,aAAA7rC,QAAAM,QAAAF,KAAAK,QAAA,EAAAkI,SAAAhK,MAAA6B,GAAAJ,KAAAK,QAAA,EAAAgI,SAAA9J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,2DACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,sBAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,sBAAAQ,WACA,uCACAD,OAAAN,QAAA2sC,gBAAAtsC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA;IACAc,OAAAP,QAAAA,OAAA4sC,eAAAtsC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,iDACAA,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA2sC,aAAA7rC,QAAAM,QAAAF,KAAAK,QAAA,EAAAkI,SAAAhK,MAAA6B,GAAAJ,KAAAK,QAAA,EAAAgI,SAAA9J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,4DACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,uBAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,uBAAAQ,WACA;AACAF,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA2sC,aAAA7rC,QAAAM,QAAAF,KAAAG,KAAAC,GAAAJ,KAAAK,QAAA,EAAA8H,SAAA5J,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,uCACAF,OAAAN,QAAA4sC,eAAAvsC,OAAAC,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,QACAc,OAAAP,QAAAA,OAAA6sC,cAAAvsC,aAAAC,UAAAG,aAAAH,OAAAM,KAAAb,QAAAc,QAAArB,KAAAA,OAAAc,QACAE,QAAAE,iBAAAL,QACA,oHACAK,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,KAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,KAAAQ,WACA,4DACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,oBAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,oBAAAQ,WACA,KACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,SAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,SAAAQ,WACA,iCCtEArF,OAAA,4CAAA,cCiBAA,OAAA,6CACA,SACA,SACA,OACA,UACA,MACA,eACA,sBACA,uDACA,cACA,WACA,0CACA,SAAAuG,EAAApF,EAAAC,GAAA0D,QAAAqF,IAAAsE,UAAAkjC,uBAAAC,UAAAjrC;AACA,YAEA,IAAA4mC,KAAA,sBAEAsE,gBACA/mC,MAAA,KAGA+D,QACAijC,QAAAhtC,QAAA2E,KAAA,UAAA,cAAA,QAaAsoC,yBAAA,WAEA,GAAAC,mBAEAC,gBAAA9wC,EAAA+wC,SAAA,4BACAT,eAAAtwC,EAAA+wC,SAAA,2BAUAC,mBAAA,SAAAnwC,GAAAuG,IAAArH,YAEA,GAAAkxC,UAAAjxC,EAAAyI,MAAA1I,WAAA,MAEA,OAAA,IAAAywC,wBAAA,IAAA3vC,GAAAuG,KACA8pC,SAAA,uBACAC,QAAA,sBACAC,YACAC,aAAArxC,EAAAuB,IAAA0vC,SAAAjoC,IAAAzD,QACA+rC,kBACAC,gBAAAN,SACAO,SAAA,uDAEAC,SAAA,MAYAC,kBAAA,SAAA7wC,GAAAuG,IAAAP;AAEA,GAAAoqC,UAAAjxC,EAAAyI,MAAA5B,WAAA,MACA,OAAA,IAAA2pC,wBAAA,IAAA3vC,GAAAuG,KACA8pC,SAAA,uBACAC,QAAA,sBACAC,YACAC,aAAArxC,EAAAuB,IAAA0vC,SAAAjoC,IAAAzD,QACA+rC,kBACAC,gBAAAN,SACAO,SAAA,kEAEAC,SAAA,MAUAE,aAAA,WACAd,mBAAAA,kBAAAthC,cACAshC,kBAAAthC,aACAH,MAAA,WACAjE,UASAymC,UAAA,SAAAC,aACAA,YAAA7xC,EAAA4N,SAAAikC,gBAAAnB,gBAEAG,mBAAAA,kBAAAthC,cACAshC,kBAAAthC,aACAG,SAAA,SACArH,GAAA,eAAAspC,cACAviC,MAAAyiC;EAOAC,KAWAC,IAAA,SAAA9uC,WAAAiB,SACA,MAAAL,MAAAwE,GAAA,SAAA,WACA,GACA2pC,cACAC,cAFArtC,KAAAf,IAIAK,SAAAlE,EAAA4N,SAAA1J,YAAAL,KAAA6J,QAEAskC,aAAAN,kBAAApB,eAAApsC,QAAAysC,SACAsB,cAAAjB,mBAAAF,gBAAA5sC,QAAAysC,SAEAiB,WACAjoC,MAAA,MAGA9F,KAAAyiC,WACAj+B,GAAA,QAAA+jC,IAAA,iBAAA,SAAAviC,GAEA,GAAAhD,YAAA7G,EAAAgyC,aAAAE,cAAAl8B,OAAAkQ,UAAA9X,QACArO,WAAAC,EAAAiyC,cAAAC,cAAAl8B,OAAAkQ,UAAA9X,OAEAvH,aAAAA,WAAAqC,QACAtE,KAAAsK,QAAA,MACArI,WAAAA,WACA9G,WAAAA,aAEA4xC,gBAEAnsC,SAAAZ,KAAA0hC,YAAAl9B,QAAAnJ,GAAA;GAGAoI,GAAA,QAAA+jC,IAAA,mBAAA,SAAAviC,GACAA,EAAAG,iBACA2nC,eACA/sC,KAAAsK,QAAA,YAEArL,KAAAqL,QAAA,UAEAiB,MACA5G,MAAAtJ,GAAA,mBACAowC,aAAA,EACAE,cAAAO,gBACAR,eAAAA,iBAEAjrB,OAAApiB,aAeAkvC,KAAA,SAAAlvC,WAAAwP,aAAA1S,WAAAmE,SACA,MAAAL,MAAAwE,GAAA,SAAA,WACA,GACA4pC,eADArtC,KAAAf,IAGAK,SAAAlE,EAAA4N,SAAA1J,YAAAL,KAAA6J,QAEAukC,cAAAjB,mBAAAF,gBAAA5sC,QAAAysC,QAAA5wC,YAEA6xC,WACAjoC,MAAA,MAGA9F,KAAAyiC,WACAj+B,GAAA,QAAA+jC,IAAA,iBAAA,SAAAviC,GAEA,GAAA9J,YAAAC,EAAAiyC,cAAAC,cAAAl8B,OAAAkQ,UAAA9X,OACAxJ,MAAAsK,QAAA;AACAnP,WAAAA,aAEA4xC,iBAEAtpC,GAAA,QAAA+jC,IAAA,mBAAA,SAAAviC,GACAA,EAAAG,iBACA2nC,eACA/sC,KAAAsK,QAAA,YAGArL,KAAAqL,QAAA,UAEAiB,MACA5G,MAAAtJ,GAAA,oBACAowC,aAAA,EACAE,cAAAO,gBACAR,eAAAA,eACA79B,aAAAA,eAEA4S,OAAApiB,aAOA,OAFA4tC,mBAAAvjC,UAAAwkC,IAAApkC,QAAAQ,YAAAuiC,WAKA,OAAAG,4BClQA/xC,OAAA,uDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAc,QAAAC,QAAAC,OAAA,EAIA,OAHAA,SAAA,uDACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,sDAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,sDAAAQ,WACA,cAIA,QAAA+I,UAAAvJ,OAAAP,MAEA,GAAAc,QAAAC,QAAAC,OAAA,EAIA,OAHAA,SAAA,sDACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,4CAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,4CAAAQ,WACA,cAlBAL,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE;AAAAR,KAAAA,QACA,IAAAa,QAAAG,OAAA,GAAAG,cAAAX,QAAAW,cAAAD,iBAAAR,KAAAQ,iBAAAO,KAAAf,IAuBA,OAHAG,QAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA0uC,eAAA5tC,QAAAM,QAAAF,KAAAK,QAAA,EAAAgI,SAAA9J,MAAA6B,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,SC1BAtF,OAAA,wDAAA,cAAA,SAAA0E,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAT,MAKA,QAAAsB,UAAAf,OAAAP,MAEA,GAAAc,QAAAC,QAAAC,OAAA,EAMA,OALAA,SAAA,oDACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,+BAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,+BAAAQ,WACA,sEACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,UAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,UAAAQ,WACA,oBAIA,QAAA+I,UAAAvJ,OAAAP,MAEA,GAAAc,QAAAC,QAAAC,OAAA,EAMA,OALAA,SAAA,oDACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,+BAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,+BAAAQ,WACA,0EACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,aAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,aAAAQ,WACA,oBAtBAL,KAAAC,cAAA,EAAA,YACAH,QAAAE,KAAAE,MAAAJ,QAAAF,WAAAE,SAAAR,KAAAA,QACA,IAAAa,QAAAC,OAAAC,QAAAC,OAAA,GAAAG,cAAAX,QAAAW,cAAAD,iBAAAR,KAAAQ,iBAAAO,KAAAf,IAoCA,OAZAM,SAAA,8CACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,6BAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,6BAAAQ,WACA,8DACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,OAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,OAAAQ,WACA,kBACAF,OAAAL,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA0uC,eAAA5tC,QAAAM,QAAAF,KAAAK,QAAA,EAAAgI,SAAA9J,MAAA6B,GAAAJ,KAAAK,QAAA,EAAAR,SAAAtB,MAAAA,KAAAA,QACAa,QAAA,IAAAA,UAAAG,QAAAH,QACAG,QAAA,oDACAE,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD,GAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,qBAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,qBAAAQ,WACA,+DACAG,kBAAAJ,OAAAN,QAAA1D,IAAAyD,QAAAA,OAAAzD;AAAAiE,SAAAM,QAAArB,KAAAA,MAAAc,OAAAA,OAAAM,KAAAb,OAAA,SAAAQ,SAAAI,cAAAC,KAAAb,OAAA,KAAA,SAAAQ,WACA,sBCvCArF,OAAA,2CAAA,cC4BAA,OAAA,4CACA,SACA,SACA,OACA,eACA,UACA,sDACA,uDACA,4CACA,gBACA,SAAAuG,EAAApF,EAAAC,GAAAqN,UAAA3J,QAAAypC,UAAAxnC,YACA,YAUA,IAAAysC,yBAAA,SAAA9pC,cACA,GAAA+pC,iBAEA,IAAAtyC,EAAAumB,QAAAhe,cACA,KAAA,IAAAoO,WAAA;AAiBA,MAAArJ,eAEAqjC,QAAAhtC,QAAA2E,KAAA,mBAAA,oBAAA,iBAAAU,IAAAT,iBAEAF,GAAA,SAAA,WACA,GAAAzD,MAAAf,IAGAA,MAAAyiC,WACAj+B,GAAA,kBAAA,WACAzD,KAAAsK,QAAA,aAEA7G,GAAA,iBAAA,SAAAwB,GACAjF,KAAAsK,QAAA,YAEA7G,GAAA,uBAAA,SAAAwB,EAAA0oC,SACAA,SAAAA,QAAApvC,OACAmvC,cAAAC,QAAApvC,QAGA+H,WACA9D,IAAAvD,KAAA6J,OAAAijC,QACA1vC,QACAmK,MAAAnL,GAAA,4BACAoL,UAAApL,GAAA,uBACAqL,QAAArL,GAAA,YAEAsL,QACA1K,GAAA,MACA2K,KAAA,MACAjC,MAAAtJ,GAAA,OACAa,MAAAb,GAAA,OACAwL,OAAA,WAOA7G,KAAAsK,QAAA,MAAAojC,kBAGApmC,QACArL,GAAA,SACAC,MAAA;AACAoF,UAAA,SAAAkI,MAAA0G,KACA,MAAAs4B,WAAAt4B,QAGAjU,GAAA,gBACAC,MAAAb,GAAA,YACAiG,UAAA,SAAAkI,MAAA0G,KACA,MAAAA,KAAA1O,SAAAtF,SAGAD,GAAA,kBACAC,MAAAb,GAAA,wBACAiG,UAAA,SAAAkI,MAAA0G,KACA,MAAAA,KAAA/U,YAAA+U,IAAA/U,WAAAmJ,OAAA4L,IAAA/U,WAAAmJ,OAAA,KAGArI,GAAA,UACAC,MAAAb,GAAA,WACAiG,UAAA,SAAAkI,MAAA0G,KACA,MAAAlP,YAAAkP,QAGA7I,YAAA,IACA5D,GAAA,QAAA,kBAAA,SAAAwB,GACAA,EAAAG,gBAEA,IAAAwoC,SAAAptC,EAAAvB,MACA4uC,OAAAD,QAAAna,QAAA,0BAAAl1B,KAAA,mBACAsI,OAAA+mC,QAAArvC,KAAA,SAEAyB,MAAAsK,QAAAzD,OAAAgnC,OAAAH,mBAIAjqC,GAAA,SAAA;AACAxE,KAAAyiC,YACAziC,KAAAyiC,WAAAp7B,UAAA,aAKA,OAAAmnC,2BCtIAxzC,OAAA,sCACA,SACA,SACA,UACA,gBACA,SAAAuG,EAAApF,EAAA2D,QAAAuV,SACA,YAQA,IAAAnO,SAAA,SAAAU,OAAAinC,YACA,MAAAttC,GAAA+B,MACAC,IAAAzD,QAAA2E,KAAAmD,OAAA,oBAAA,iBACAtI,KAAAuvC,WACAnrC,SAAA,OACAC,KAAA,SAWA,OAAA,UAAAe,cACA,GAAAvI,EAAAumB,QAAAhe,cACA,KAAA,IAAAoO,WAAA,sEAOA,QAUAg8B,iBAAA,SAAAL,eACA,MAAA,IAAAp5B,SAAA,SAAAH,QAAAD,QACA,MAAA9Y,GAAAoK,cAAAkoC,mBAIAvnC,SAAA;AACA/B,IAAAT,aACAqqC,YAAAN,gBAEAxpC,QAAAiQ,SACAU,KAAA,SAAAiqB,KACA,MAAA5qB,QAAA,GAAAsI,OAAAsiB,IAAAmP,iBATA/5B,OAAA,GAAAnC,WAAA,2BAsBAm8B,gBAAA,SAAAF,aAEA,MAAA,IAAA15B,SAAA,SAAAH,QAAAD,QACA,MAAA9Y,GAAAoK,cAAAwoC,iBAIA7nC,SAAA,qBACA/B,IAAAT,aACAqqC,YAAAA,cAEA9pC,QAAAiQ,SACAU,KAAA,SAAAiqB,KACA,MAAA5qB,QAAA,GAAAsI,OAAAsiB,IAAAmP,iBATA/5B,OAAA,GAAAnC,WAAA,2BAqBAo8B,kBAAA,SAAAH,aAEA,MAAA,IAAA15B,SAAA,SAAAH,QAAAD,QACA,MAAA9Y,GAAAoK,cAAAwoC,iBAIA7nC,SAAA,uBACA/B,IAAAT;AACAqqC,YAAAA,cAEA9pC,QAAAiQ,SACAU,KAAA,SAAAiqB,KACA,MAAA5qB,QAAA,GAAAsI,OAAAsiB,IAAAmP,iBATA/5B,OAAA,GAAAnC,WAAA,2BAoBAq8B,kBAAA,SAAAC,eACA,MAAA,IAAA/5B,SAAA,SAAAH,QAAAD,QACA9Y,EAAAqb,SAAA43B,gBACAn6B,OAAA,GAAAnC,WAAA,wBAGA5L,QAAA,qBACA/B,IAAAT,aACAqqC,YAAAK,gBAEAnqC,QAAAiQ,SACAU,KAAA,SAAAiqB,KACA,MAAA5qB,QAAA,GAAAsI,OAAAsiB,IAAAmP,oBAWAK,oBAAA,SAAAD,eACA,MAAA,IAAA/5B,SAAA,SAAAH,QAAAD,QACA9Y,EAAAqb,SAAA43B,gBACAn6B,OAAA,GAAAnC,WAAA,wBAGA5L,QAAA,uBACA/B,IAAAT;AACAqqC,YAAAK,gBAEAnqC,QAAAiQ,SACAU,KAAA,SAAAiqB,KACA,MAAA5qB,QAAA,GAAAsI,OAAAsiB,IAAAmP,wBCpKAh0C,OAAA,yDACA,SACA,SACA,OACA,qBACA,cACA,4CACA,2CACA,sCACA,SAAAuG,EAAApF,EAAAC,GAAAoF,WAAAG,SAAAorC,yBAAAyB,wBAAAc,qBACA,YAMA,IAAArtC,UAAA,uBAOAstC,gBAIAptC,MAAA,WAEA,GAAAqtC,kBACApwC,WAAAmC,EAAAU,UACAwtC,gBAAAluC,EAAA,+BAAAnC,YACAswC,iBAAAnuC,EAAA,gCAAAnC,YAGAsF,aAAAtF,WAAAE,KAAA,cAKAmI,QAAA;AACAjG,WAAAW,SAMAg+B,OAAA,WACA3+B,WAAA2B,QAOAwsC,YAAA,SAAAr5B,KACA6pB,SACAx+B,WAAAkD,MAAAyR,IAAAnP,UAOAlC,QAAA,SAAAkC,SACAg5B,SACAx+B,WAAAsD,QAAAkC,SACAqoC,iBAAAnkC,QAAA,UAIAmkC,kBACAhB,wBAAA9pC,cACAF,GAAA,UAAAiD,SACAjD,GAAA,SAAA27B,QACA37B,GAAA,MAAA,WACA,GAAAzD,MAAAf,IAGA+sC,4BACAmB,IAAAwB,kBACAlrC,GAAA,KAAA,SAAAuqC,aAGAtnC,UACA6nC,oBAAA5qC,cACAoqC,iBAAAC,aACA34B,KAAA,SAAAtR,UAEAq7B,SACAr7B,SAAA8qC,QAAA9qC,SAAA8qC,OAAAvqC,OACA1D,WAAA4D,QAAAnJ,GAAA,uDAAA0I,SAAA8qC,OAAAtqC,KAAA,OAEA3D,WAAAsD,QAAA7I,GAAA;AAEA2E,KAAAsK,QAAA,YAEAgL,MAAAs5B,iBAGAnrC,GAAA,OAAA,SAAA4qC,cAAAX,eAGA,GAAAM,aAAA5yC,EAAAO,KAAA+xC,eAAAtpC,IAAAiqC,eAGArC,4BACAuB,KAAAoB,iBAAAX,YAAAxsC,SAAAtF,MAAA8xC,YAAA7yC,YACAsI,GAAA,KAAA,SAAAqrC,SAEApoC,UACA6nC,oBAAA5qC,cACAuqC,iBACAjsC,YAAA+rC,YAAAxsC,SAAA4C,KACAjJ,WAAA2zC,QAAA3zC,aAEAka,KAAA,SAAAtR,UACAG,QAAA7I,GAAA,mCAEAia,MAAAs5B,iBAIAnrC,GAAA,SAAA,SAAA4qC,cAAAX,eACA,GAAAM,aAAA5yC,EAAAO,KAAA+xC,eAAAtpC,IAAAiqC,eAEA3nC,WACA6nC,oBAAA5qC,cACAwqC;AACAlsC,YAAA+rC,YAAAxsC,SAAA4C,OAEAiR,KAAA,WACAnR,QAAA7I,GAAA,gCAEAia,MAAAs5B,eAGAnrC,GAAA,SAAA,SAAA4qC,eACA3nC,UACA6nC,oBAAA5qC,cACAyqC,kBAAAC,eACAh5B,KAAA,WACAnR,QAAA7I,GAAA,8CAEAia,MAAAs5B,eAGAnrC,GAAA,WAAA,SAAA4qC,eACA3nC,UACA6nC,oBAAA5qC,cACA2qC,oBAAAD,eACAh5B,KAAA,WACAnR,QAAA7I,GAAA,6DAEAia,MAAAs5B,eAEArjC,SACAkV,OAAAiuB,kBAIA,OAAAF,kBCjLA,SAAAllB,GAAA,GAAAylB,GAAAvvB,SAAAgW,EAAA,cAAAlf,EAAA,aAAAslB,EAAAmT,EAAA5O,cAAA;AAAAvE,EAAAh5B,KAAA,WAAAmsC,EAAAC,qBAAA,QAAA,GAAAxZ,GAAAoG,GAAAA,EAAAtlB,GAAAslB,EAAAtlB,GAAA24B,QAAA3lB,EAAAsS,EAAApG,GAAAuZ,EAAAG,eAAA5lB,KACA","file":"routes.js.map","sourcesContent":["define('taoProctoring/controller/routes',{\n    'TestCenter' : {\n        'actions' : {\n            'index' : 'controller/TestCenter/index',\n            'testCenter' : 'controller/TestCenter/testCenter'\n        }\n    },\n    'TestCenterManager' : {\n        'actions' : {\n            'editCenter' : 'controller/TestCenterManager/editCenter'\n        }\n    },\n\t'ProctorManager' : {\n        'actions' : {\n            'index' : 'controller/ProctorManager/index'\n        }\n    },\n    'Diagnostic' : {\n        'actions' : {\n            'index' : 'controller/Diagnostic/index',\n            'diagnostic' : 'controller/Diagnostic/diagnostic',\n            'deliveriesByProctor' : 'controller/Diagnostic/deliveriesByProctor'\n        }\n    },\n    'Reporting' : {\n        'actions' : {\n            'sessionHistory' : 'controller/Reporting/history'\n        }\n    },\n    'Irregularity' : {\n        'actions' : {\n            'index' : 'controller/Irregularity/index'\n        }\n    },\n    'Delivery' : {\n        'actions' : {\n            'index' : 'controller/Delivery/index',\n            'manage' : 'controller/Delivery/manage',\n            'monitoring' : 'controller/Delivery/monitoring',\n            'monitoringAll' : 'controller/Delivery/monitoring',\n            'testTakers' : 'controller/Delivery/testTakers'\n        }\n    }\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n *\n */\ndefine('taoProctoring/helper/status',['lodash', 'i18n'], function(_, __){\n    'use strict';\n    var _awaiting = 'http://www.tao.lu/Ontologies/TAODelivery.rdf#DeliveryExecutionStatusAwaiting',\n        _authorized = 'http://www.tao.lu/Ontologies/TAODelivery.rdf#DeliveryExecutionStatusAuthorized',\n        _inprogress = 'http://www.tao.lu/Ontologies/TAODelivery.rdf#DeliveryExecutionStatusActive',\n        _paused = 'http://www.tao.lu/Ontologies/TAODelivery.rdf#DeliveryExecutionStatusPaused',\n        _completed = 'http://www.tao.lu/Ontologies/TAODelivery.rdf#DeliveryExecutionStatusFinished',\n        _terminated = 'http://www.tao.lu/Ontologies/TAODelivery.rdf#DeliveryExecutionStatusTerminated';\n\n    var _status = {\n        awaiting : {\n            code : _awaiting,\n            label : __('Awaiting'),\n            can : {\n                authorize : true,\n                pause : __('not in progress'),\n                terminate : true,\n                report : true,\n                print : __('not finished'),\n                time : true\n            }\n        },\n        authorized : {\n            code : _authorized,\n            label : __('Authorized but not started'),\n            can : {\n                authorize : __('already authorized'),\n                terminate : true,\n                report : true,\n                pause : __('not started'), //not in progress\n                print : __('not finished'),\n                time : true\n            }\n        },\n        inprogress : {\n            code : _inprogress,\n            label : __('In Progress'),\n            can : {\n                authorize : __('already authorized'),\n                pause : true,\n                terminate : true,\n                report : true,\n                print : __('not finished'),\n                time : true\n            }\n        },\n        paused : {\n            code : _paused,\n            label : __('Paused'),\n            can : {\n                authorize : __('is paused'),\n                pause : __('is already paused'),\n                terminate : true,\n                report : true,\n                print : __('not finished'),\n                time : true\n            }\n        },\n        completed : {\n            code : _completed,\n            label : __('Completed'),\n            can : {\n                authorize : __('is completed'),\n                pause : __('is completed'),\n                terminate : __('is completed'),\n                report : true,\n                print: true,\n                time : true\n            }\n        },\n        terminated : {\n            code : _terminated,\n            label : __('Terminated'),\n            can : {\n                authorize : __('is terminated'),\n                pause : __('is terminated'),\n                terminate : __('is terminated'),\n                report : true,\n                print: true,\n                time : true\n            }\n        }\n    };\n\n    /**\n     * Get the status model from its name\n     * @param {string} statusName\n     * @returns {object}\n     */\n    function getStatus(statusName){\n        return _status[statusName];\n    }\n\n    /**\n     * Get the status model from its code\n     * @param {string} statusCode\n     * @returns {object}\n     */\n    function getStatusByCode(statusCode){\n        return _.find(_status, {code : statusCode});\n    }\n\n    /**\n     * Verify and reformat test taker data for the execBulkAction's need\n     * @param {Object} testTakerData\n     * @param {String} actionName\n     * @returns {Object}\n     */\n    function verifyTestTaker(testTakerData, actionName){\n        var formatted = {\n            id : testTakerData.id,\n            label : testTakerData.firstname + ' ' + testTakerData.lastname\n        };\n        var status = _status.getStatusByCode(testTakerData.state.status);\n        if(status){\n            formatted.allowed = (status.can[actionName] === true);\n            if(!formatted.allowed){\n                formatted.reason = status.can[actionName];\n            }\n        }\n        return formatted;\n    }\n\n    /**\n     * Get status model mappings formatted\n     * @returns {Array}\n     */\n    function getStatuses() {\n        return _.map(_status, function (el) {\n            return {code: el.code, label: el.label};\n        });\n    }\n\n    return {\n        getStatuses : getStatuses,\n        getStatus : getStatus,\n        getStatusByCode : getStatusByCode,\n        verifyTestTaker : verifyTestTaker,\n        STATUS_AUTHORIZED : _authorized,\n        STATUS_INPROGRESS : _inprogress,\n        STATUS_PAUSED : _paused,\n        STATUS_COMPLETED : _completed,\n        STATUS_TERMINATED : _terminated\n    };\n});\n\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n *\n */\ndefine('taoProctoring/component/breadcrumbs',['ui/breadcrumbs'], function(breadcrumbs){\n    \n    /**\n     * Wrap the generic breadcrumbs component into a very specialized\n     * \n     * @param {JQyery} $container\n     * @param {Array} [crumbs]\n     * @returns {unresolved}\n     */\n    return function breadcrumbFactory($container, crumbs){\n        return breadcrumbs({\n            breadcrumbs : crumbs || $container.data('breadcrumbs'),\n            renderTo: $container.find('.header'),\n            replace: true,\n            cls : 'action-bar horizontal-action-bar'\n        });\n    };\n});\n\n\n","\ndefine('tpl!taoProctoring/templates/delivery/listBoxActions', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<span class=\\\"listbox-actions\\\">\\n    <span class=\\\"action pause\\\" data-delivery=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n        <span class=\\\"icon-pause\\\"></span>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Pause\", options) : helperMissing.call(depth0, \"__\", \"Pause\", options)))\n    + \"\\n    </span>\\n    <span class=\\\"action play\\\">\\n        <span class=\\\"icon-play\\\"></span>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Monitor\", options) : helperMissing.call(depth0, \"__\", \"Monitor\", options)))\n    + \"\\n    </span>\\n</span>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoProctoring/templates/delivery/listBoxStats', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\n<ul class=\\\"plain listbox-properties\\\">\\n    <li>\\n        <label>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Start\", options) : helperMissing.call(depth0, \"__\", \"Start\", options)))\n    + \"</label>: \";\n  if (helper = helpers.periodStart) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.periodStart); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\n    </li>\\n    <li>\\n        <label>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"End\", options) : helperMissing.call(depth0, \"__\", \"End\", options)))\n    + \"</label>: \";\n  if (helper = helpers.periodEnd) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.periodEnd); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\n    </li>\\n</ul>\\n\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.showProperties), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n<p class=\\\"listbox-stats\\\">\\n    <span class=\\\"icon-lock\\\"></span><span class=\\\"number\\\">\";\n  if (helper = helpers.locked) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.locked); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n    <span class=\\\"icon-play\\\"></span><span class=\\\"number\\\">\";\n  if (helper = helpers.inProgress) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.inProgress); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n    <span class=\\\"icon-pause\\\"></span><span class=\\\"number\\\">\";\n  if (helper = helpers.paused) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.paused); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n</p>\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/Delivery/index',[\n    'lodash',\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'ui/listbox',\n    'util/encode',\n    'ui/feedback',\n    'ui/bulkActionPopup',\n    'ui/cascadingComboBox',\n    'taoProctoring/helper/status',\n    'taoProctoring/component/breadcrumbs',\n    'tpl!taoProctoring/templates/delivery/listBoxActions',\n    'tpl!taoProctoring/templates/delivery/listBoxStats'\n], function (_, $, __, helpers, loadingBar, listBoxFactory, encode, feedback, bulkActionPopup, cascadingComboBox, _status, breadcrumbsFactory, actionsTpl, statsTpl) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.delivery-index';\n\n    /**\n     * Controls the ProctorDelivery index page\n     *\n     * @type {Object}\n     */\n    var taoProctoringCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start: function start() {\n            var $container = $(cssScope);\n            var list = $container.data('list');\n            var deliveries = format(list);\n            var crumbs = $container.data('breadcrumbs');\n            var categories = $container.data('categories');\n            var testCenterId = $container.data('testcenter');\n            var serviceUrl = helpers._url('deliveries', 'Delivery', 'taoProctoring', {testCenter: testCenterId});\n            var listBox = listBoxFactory({\n                title: __(\"Sessions\"),\n                textEmpty: __(\"No sessions available\"),\n                textNumber: __(\"Available\"),\n                textLoading: __(\"Loading\"),\n                renderTo: $container.find('.content'),\n                replace: true,\n                list: list,\n                width: 12,\n\n                // discard the \"all sessions\" box from available count\n                countRenderer: function (count) {\n                    return count - 1;\n                }\n            });\n\n            // format each delivery descriptor to be displayed in a box, build a map of deliveries\n            function format(data) {\n                return _.transform(data, function (result, delivery) {\n                    var props = delivery.properties;\n                    var tplData = {\n                        locked: delivery.stats.awaitingApproval,\n                        inProgress: delivery.stats.inProgress,\n                        paused: delivery.stats.paused\n                    };\n\n                    if (props && props.periodStart && props.periodEnd) {\n                        tplData.showProperties = true;\n                        tplData.periodStart = props.periodStart;\n                        tplData.periodEnd = props.periodEnd;\n\n                        //add a special class for boxes that have more information to display\n                        delivery.cls = 'has-properties-displayed';\n                    }\n                    delivery.html = actionsTpl({\n                        id: delivery.id\n                    });\n                    delivery.content = statsTpl(tplData);\n\n                    result[delivery.id] = delivery;\n                }, {});\n            }\n\n            // get the label of a delivery from its ID\n            function getDeliveryLabel(id) {\n                return deliveries[id] && deliveries[id].label;\n            }\n\n            // update the index from a JSON array\n            function update(data) {\n                deliveries = format(data);\n                listBox.update(data);\n                loadingBar.stop();\n            }\n\n            // refresh the index\n            function refresh() {\n                loadingBar.start();\n                listBox.setLoading(true);\n\n                $.ajax({\n                    url: serviceUrl,\n                    cache: false,\n                    dataType: 'json',\n                    type: 'GET'\n                }).done(function (data) {\n                    update(data);\n                });\n            }\n\n            // request a pause fo the selected delivery executions\n            function pause(deliveryId, selection, deliveryExecutions) {\n\n                var allowed = _.map(selection, function (data) {\n                    return {\n                        id: data.id,\n                        label: data.testTaker.firstName + ' ' + data.testTaker.lastName\n                    };\n                });\n\n                bulkActionPopup({\n                    renderTo: $container,\n                    actionName: __('Pause Session'),\n                    reason: true,\n                    resourceType: 'test taker',\n                    categoriesSelector: cascadingComboBox({\n                        categoriesDefinitions: categories.pause.categoriesDefinitions,\n                        categories: categories.pause.categories\n                    }),\n                    allowedResources: allowed\n                }).on('ok', function (reason) {\n                    //execute callback\n                    $.ajax({\n                        url: helpers._url('pauseExecutions', 'Delivery', 'taoProctoring'),\n                        data: {\n                            delivery: deliveryId,\n                            testCenter: testCenterId,\n                            execution: _.pluck(selection, 'id'),\n                            reason: reason\n                        },\n                        dataType: 'json',\n                        type: 'POST',\n                        error: function () {\n                            loadingBar.stop();\n                        }\n                    }).done(function (response) {\n                        var messageContext, unprocessed;\n\n                        loadingBar.stop();\n\n                        if (response && response.success) {\n                            feedback().success('Selected deliveries successfully paused');\n                            refresh();\n                        } else {\n                            messageContext = '';\n                            if (response) {\n                                unprocessed = {};\n                                _.forEach(response.unprocessed, function (id) {\n                                    var execution = deliveryExecutions[id];\n                                    var uri = execution && execution.delivery && execution.delivery.uri;\n                                    if (uri) {\n                                        unprocessed[uri] = (unprocessed[uri] || 0) + 1;\n                                    }\n                                });\n\n                                unprocessed = _.map(unprocessed, function (count, uri) {\n                                    if (count > 1) {\n                                        return __('%d sessions of the delivery %s have not been paused', count, getDeliveryLabel(uri));\n                                    }\n                                    return __('A session of the delivery %s have not been paused', getDeliveryLabel(uri));\n                                });\n\n                                if (unprocessed.length) {\n                                    messageContext += '<br>' + unprocessed.join('<br>');\n                                }\n                                if (response.error) {\n                                    messageContext += '<br>' + encode.html(response.error);\n                                }\n                            }\n                            feedback().warning(__('Something went wrong ...') + '<br>' + messageContext, {encodeHtml: false});\n                        }\n                    });\n                });\n            }\n\n            breadcrumbsFactory($container, crumbs);\n\n            $container.on('click', '.pause', function (e) {\n\n                var deliveryId = $(this).data('delivery');\n                var pauseUrl = (deliveryId === 'all') ?\n                    helpers._url('allDeliveriesExecutions', 'Delivery', 'taoProctoring', {testCenter: testCenterId}) :\n                    helpers._url('deliveryExecutions', 'Delivery', 'taoProctoring', {\n                        delivery: deliveryId,\n                        testCenter: testCenterId\n                    });\n\n                //prevent clicking the parent link that goes to the monitoring screen\n                e.stopPropagation();\n                e.preventDefault();\n\n                //get list of all test taker for the selected delivery\n                $.get(pauseUrl, function (res) {\n                    var deliveryExecutions = {};\n                    var inProgressExecs;\n\n                    if (_.isPlainObject(res) && _.isArray(res.data)) {\n                        inProgressExecs = _.filter(res.data, function (data) {\n                            deliveryExecutions[data.id] = data;\n                            return (data.state && data.state.status === _status.getStatus('inprogress').code);\n                        });\n\n                        if (inProgressExecs.length) {\n                            pause(deliveryId, inProgressExecs, deliveryExecutions);\n                        } else {\n                            feedback().info(__('There is no delivery in progress'));\n                        }\n                    }\n                });\n            });\n\n            if (!list) {\n                refresh();\n            } else {\n                loadingBar.stop();\n            }\n        }\n    };\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    return taoProctoringCtlr;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/Delivery/manage',[\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'util/encode',\n    'ui/feedback',\n    'ui/dialog',\n    'taoProctoring/component/breadcrumbs',\n    'ui/datatable'\n], function ($, __, helpers, loadingBar, encode, feedback, dialog, breadcrumbsFactory) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.delivery-manager';\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Controls the taoProctoring delivery page\n     *\n     * @type {Object}\n     */\n    var proctorDeliveryIndexCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n            var $container = $(cssScope);\n            var $list = $container.find('.list');\n            var crumbs = $container.data('breadcrumbs');\n            var dataset = $container.data('set');\n            var deliveryId = $container.data('delivery');\n            var testCenterId = $container.data('testcenter');\n            var assignUrl = helpers._url('testTakers', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var removeUrl = helpers._url('removeTestTakers', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var serviceUrl = helpers._url('deliveryTestTakers', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var monitoringUrl = helpers._url('monitoring', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter: testCenterId});\n\n            var bc = breadcrumbsFactory($container, crumbs);\n\n            // request the server with a selection of test takers\n            var request = function(url, selection, message) {\n                if (selection && selection.length) {\n                    loadingBar.start();\n\n                    $.ajax({\n                        url: url,\n                        data: {\n                            testtaker: selection\n                        },\n                        dataType : 'json',\n                        type: 'POST',\n                        error: function() {\n                            loadingBar.stop();\n                        }\n                    }).done(function(response) {\n                        loadingBar.stop();\n\n                        if (response && response.success) {\n                            if (message) {\n                                feedback().success(message);\n                            }\n                            $list.datatable('refresh');\n                        } else {\n                            feedback().error(__('Something went wrong ...') + '<br>' + encode.html(response.error), {encodeHtml: false});\n                        }\n                    });\n                }\n            };\n\n            // request the server to remove the selected test takers\n            var remove = function(selection) {\n                request(removeUrl, selection, __('Test takers have been removed'));\n            };\n\n            $list\n                .on('query.datatable', function() {\n                    loadingBar.start();\n                })\n                .on('load.datatable', function() {\n                    loadingBar.stop();\n                })\n                .datatable({\n                    url: serviceUrl,\n                    status: {\n                        empty: __('No assigned test takers'),\n                        available: __('Assigned test takers'),\n                        loading: __('Loading')\n                    },\n                    tools: [{\n                        id: 'refresh',\n                        icon: 'reset',\n                        title: __('Refresh the page'),\n                        label: __('Refresh'),\n                        action: function() {\n                            $list.datatable('refresh');\n                        }\n                    }, {\n                        id: 'back',\n                        icon: 'preview',\n                        title: __('Return to the session monitoring'),\n                        label: __('Monitoring'),\n                        action: function() {\n                            window.location.href = monitoringUrl;\n                        }\n                    }, {\n                        id: 'assign',\n                        icon: 'add',\n                        title: __('Assign more test takers to this session'),\n                        label: __('Add test takers'),\n                        action: function() {\n                            window.location.href = assignUrl;\n                        }\n                    }, {\n                        id: 'remove',\n                        icon: 'remove',\n                        title: __('Remove the selected test takers from the session'),\n                        label: __('Remove'),\n                        massAction: true,\n                        action: function(selection) {\n                            dialog({\n                                message: __('The test takers will be removed from this session. Continue ?'),\n                                autoRender: true,\n                                autoDestroy: true,\n                                onOkBtn: function() {\n                                    remove(selection);\n                                }\n                            });\n                        }\n                    }],\n                    actions: [{\n                        id: 'remove',\n                        icon: 'remove',\n                        title: __('Remove the test taker from the session'),\n                        action: function(id) {\n                            dialog({\n                                autoRender: true,\n                                autoDestroy: true,\n                                message: __('The test taker will be removed from this session. Continue ?'),\n                                onOkBtn: function() {\n                                    remove([id]);\n                                }\n                            });\n                        }\n                    }],\n                    selectable: true,\n                    model: [{\n                        id: 'firstname',\n                        label: __('First name')\n                    }, {\n                        id: 'lastname',\n                        label: __('Last name')\n                    }, {\n                        id: 'identifier',\n                        label: __('Identifier')\n                    }, {\n                        id: 'status',\n                        label: __('Status')\n                    }]\n                }, dataset);\n        }\n    };\n\n    return proctorDeliveryIndexCtlr;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/component/extraTime/encoder',[\n    'core/format',\n    'core/encoder/time'\n], function (format, timeEncoder) {\n    'use strict';\n\n    /**\n     * Encodes the extra time in a human readable way\n     * @param {Number} extraTime - The extra time to encode\n     * @param {Number} consumedTime - The already consumed time\n     * @param {String} [pattern] - The display pattern used when no time is consumed (default: %s)\n     * @param {Number} [unit] - The time unit\n     * @returns {String}\n     */\n    function encodeExtraTime(extraTime, consumedTime, pattern, unit) {\n        var encoded = '';\n\n        pattern = pattern || '%s';\n        unit = unit || 1;\n\n        if (extraTime) {\n            if (consumedTime) {\n                encoded = timeEncoder.encode(Math.min(consumedTime, extraTime)) + '/' + timeEncoder.encode(extraTime);\n            } else {\n                encoded = format(pattern, extraTime / unit);\n            }\n\n            encoded = ' +' + encoded;\n        }\n\n        return encoded;\n    }\n\n    return encodeExtraTime;\n});\n\n","\ndefine('tpl!taoProctoring/component/extraTime/extraTime', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\n    <div class=\\\"multiple\\\">\\n        <p>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The action will be applied to the following session\", options) : helperMissing.call(depth0, \"__\", \"The action will be applied to the following session\", options)))\n    + \":</p>\\n        <ul class=\\\"plain applicables\\\">\\n            \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.allowedResources), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        </ul>\\n    </div>\\n\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.deniedResources)),stack1 == null || stack1 === false ? stack1 : stack1.length), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\\n    \";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n            <li data-resource=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n                <span class=\\\"resource-label\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n                \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.remainingStr), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n                \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.extraTimeStr), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n            </li>\\n            \";\n  return buffer;\n  }\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<span class=\\\"remaining\\\">\";\n  if (helper = helpers.remainingStr) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.remainingStr); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\";\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<span class=\\\"time\\\">(\";\n  if (helper = helpers.extraTimeStr) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.extraTimeStr); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")</span>\";\n  return buffer;\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\n    <p>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"However, the action will not be applied to the following sessions\", options) : helperMissing.call(depth0, \"__\", \"However, the action will not be applied to the following sessions\", options)))\n    + \":</p>\\n    <ul class=\\\"plain no-applicables\\\">\\n        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.deniedResources), {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </ul>\\n    \";\n  return buffer;\n  }\nfunction program8(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n        <li data-resource=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n            <span class=\\\"resource-label\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n            <span class=\\\"reason\\\">(\";\n  if (helper = helpers.reason) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.reason); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")</span>\\n        </li>\\n        \";\n  return buffer;\n  }\n\nfunction program10(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n    <p>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The action cannot be applied, no eligible sessions found\", options) : helperMissing.call(depth0, \"__\", \"The action cannot be applied, no eligible sessions found\", options)))\n    + \"</p>\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"bulk-action-popup\\\">\\n    <h2 class=\\\"title\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Action\", options) : helperMissing.call(depth0, \"__\", \"Action\", options)))\n    + \": \";\n  if (helper = helpers.actionName) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.actionName); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h2>\\n\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.allowedResources)),stack1 == null || stack1 === false ? stack1 : stack1.length), {hash:{},inverse:self.program(10, program10, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\\n    <div class=\\\"form\\\">\\n        <p>\\n            <label for=\\\"input-extra-time\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Extra time\", options) : helperMissing.call(depth0, \"__\", \"Extra time\", options)))\n    + \":</label>\\n            <input type=\\\"text\\\" id=\\\"input-extra-time\\\" data-control=\\\"time\\\" value=\\\"\";\n  if (helper = helpers.time) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.time); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" maxlength=\\\"4\\\" size=\\\"4\\\" />\\n            <label for=\\\"input-extra-time\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"minutes\", options) : helperMissing.call(depth0, \"__\", \"minutes\", options)))\n    + \"</label>\\n        </p>\\n    </div>\\n    <p>\\n        <strong>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Note\", options) : helperMissing.call(depth0, \"__\", \"Note\", options)))\n    + \":</strong>\\n        <em>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"the already granted time will be replaced by the new value\", options) : helperMissing.call(depth0, \"__\", \"the already granted time will be replaced by the new value\", options)))\n    + \"</em>\\n    </p>\\n\\n    <div class=\\\"actions\\\">\\n        <div class=\\\"feedback-error small hidden\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The extra time must be a number\", options) : helperMissing.call(depth0, \"__\", \"The extra time must be a number\", options)))\n    + \"</div>\\n        <button class=\\\"btn btn-info small action done\\\" data-control=\\\"done\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"OK\", options) : helperMissing.call(depth0, \"__\", \"OK\", options)))\n    + \"</button>\\n        <a href=\\\"#\\\" class=\\\"btn action cancel\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"cancel the action\", options) : helperMissing.call(depth0, \"__\", \"cancel the action\", options)))\n    + \"\\\" data-control=\\\"cancel\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"cancel\", options) : helperMissing.call(depth0, \"__\", \"cancel\", options)))\n    + \"</a>\\n    </div>\\n\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/component/extraTime/extraTime',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'core/encoder/time',\n    'ui/component',\n    'ui/hider',\n    'taoProctoring/component/extraTime/encoder',\n    'tpl!taoProctoring/component/extraTime/extraTime',\n    'ui/modal'\n], function ($, _, __, timeEncoder, component, hider, encodeExtraTime, extraTimeTpl) {\n    'use strict';\n\n    /**\n     * Some default config\n     * @type {Object}\n     * @private\n     */\n    var _defaults = {\n        unit: 60,           // default time unit is minutes\n        deniedResources: []\n    };\n\n    /**\n     * Creates a form that manage the extra time allowed to test takers\n     *\n     * @param {Object} config\n     * @param {String} config.actionName - the action name (use in the title text)\n     * @param {Array} config.allowedResources - list of allowed resources to be displayed\n     * @param {Array} [config.deniedResources] - list of denied resources to be displayed\n     * @param {Number} [config.unit] - the time is stored in seconds, but can be handled in other time units, by default this is minutes (60)\n     * @fires cancel when the component is closed without validation\n     * @fires ok when the ok button is clicked\n     */\n    function extraTimeFactory(config) {\n        var initConfig = _.defaults(config || {}, _defaults);\n        var timeUnit = initConfig.unit || _defaults.unit;\n\n        _.forEach(initConfig.allowedResources, function(resource) {\n            var remaining = parseFloat(resource.remaining) || 0;\n            var extraTime = parseFloat(resource.extraTime);\n            var consumedTime = parseFloat(resource.consumedTime);\n\n            if (remaining) {\n                resource.remainingStr = timeEncoder.encode(remaining);\n            }\n\n            resource.extraTimeStr = encodeExtraTime(extraTime, consumedTime, __('%s minutes more'), timeUnit);\n        });\n\n        return component()\n            .setTemplate(extraTimeTpl)\n            .on('render', function () {\n                var self = this;\n                var $cmp = this.getElement();\n                var $time = $cmp.find('[data-control=\"time\"]');\n                var $error = $cmp.find('.feedback-error');\n                var $ok = $cmp.find('[data-control=\"done\"]');\n\n                /**\n                 * Validate the input time\n                 * @returns {Boolean}\n                 */\n                function checkInputError() {\n                    var value = $time.val().trim();\n\n                    // use Number() instead of parseInt/parseFloat to prevent number with text like \"10$$\" to be\n                    // converted to number, as we need to avoid that case\n                    var time = Number(value);\n\n                    // here we also check with the parseFloat to detect non decimal notation,\n                    // otherwise numbers like 0x10 will be accepted, but misunderstood when applied\n                    var error = isNaN(time) || time !== parseFloat(value);\n\n                    if (error) {\n                        hider.show($error);\n                        $ok.attr('disabled', true);\n                        focus();\n                    } else {\n                        $ok.removeAttr('disabled');\n                        hider.hide($error);\n                    }\n\n                    return error;\n                }\n\n                /**\n                 * Submit the data\n                 */\n                function submit() {\n                    if (!checkInputError()) {\n                        /**\n                         * The user has input a time and submitted the data\n                         * @event ok\n                         * @param {Number} time\n                         */\n                        self.trigger('ok', parseFloat($time.val()) * timeUnit);\n                        $cmp.modal('close');\n                    }\n                }\n\n                /**\n                 * Cancel the dialog\n                 */\n                function cancel() {\n                    /**\n                     * The dialog is just canceled\n                     * @event cancel\n                     */\n                    self.trigger('cancel');\n                    $cmp.modal('close');\n                }\n\n                /**\n                 * Set the focus on the input\n                 */\n                function focus() {\n                    $time.focus().select();\n                }\n\n                // we need to find the common extra time for all selected test takers\n                $time.val(_.reduce(initConfig.allowedResources, function(time, testTaker) {\n                    return Math.max(time, testTaker && testTaker.extraTime || 0);\n                }, 0) / timeUnit);\n\n                $cmp\n                    .addClass('modal')\n                    .on('closed.modal', function () {\n                        self.destroy();\n                    })\n                    .on('change', $time, function() {\n                        checkInputError();\n                    })\n                    .on('keyup', function(event) {\n                        if (13 === event.keyCode) {\n                            submit();\n                        } else {\n                            checkInputError();\n                        }\n                    })\n                    .on('click', '.action', function (event) {\n                        var $btn = $(event.target).closest('.action');\n                        var control = $btn.data('control');\n\n                        event.preventDefault();\n\n                        if ('done' === control) {\n                            submit();\n                        } else {\n                            cancel();\n                        }\n                    })\n                    .modal({\n                        width: 800\n                    });\n\n                focus();\n            })\n            .on('destroy', function () {\n                this.getElement()\n                    .removeClass('modal')\n                    .modal('destroy');\n            })\n            .init(initConfig);\n    }\n\n    return extraTimeFactory;\n});\n\n","\ndefine('tpl!taoProctoring/templates/delivery/deliveryLink', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<a class=\\\"elipsis\\\" href=\\\"\";\n  if (helper = helpers.url) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.url); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" title=\\\"\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</a>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoProctoring/templates/delivery/statusFilter', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n    <option value=\\\"\";\n  if (helper = helpers.code) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.code); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<select class=\\\"filter status select2\\\">\\n    <option value=\\\"\\\" selected></option>\\n    \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.statuses), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n</select>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoProctoring/templates/delivery/approximatedTimer', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n<span class=\\\"approximated-timer\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.since), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">~\";\n  if (helper = helpers.timer) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.timer); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.since), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \" title=\\\"\";\n  if (helper = helpers.since) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.since); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<span class=\\\"icon-warning\\\" title=\\\"\";\n  if (helper = helpers.since) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.since); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></span>\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.timer), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/Delivery/monitoring',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'helpers',\n    'moment',\n    'layout/loading-bar',\n    'core/encoder/time',\n    'util/encode',\n    'ui/feedback',\n    'ui/dialog',\n    'ui/bulkActionPopup',\n    'ui/cascadingComboBox',\n    'taoProctoring/component/extraTime/extraTime',\n    'taoProctoring/component/extraTime/encoder',\n    'taoProctoring/component/breadcrumbs',\n    'taoProctoring/helper/status',\n    'tpl!taoProctoring/templates/delivery/deliveryLink',\n    'tpl!taoProctoring/templates/delivery/statusFilter',\n    'tpl!taoProctoring/templates/delivery/approximatedTimer',\n    'ui/datatable',\n    'select2'\n], function (\n    $,\n    _,\n    __,\n    helpers,\n    moment,\n    loadingBar,\n    timeEncoder,\n    encode,\n    feedback,\n    dialog,\n    bulkActionPopup,\n    cascadingComboBox,\n    extraTimePopup,\n    encodeExtraTime,\n    breadcrumbsFactory,\n    _status,\n    deliveryLinkTpl,\n    statusFilterTpl,\n    approximatedTimerTpl\n) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.delivery-monitoring';\n\n    /**\n     * The extra time unit: by default in minutes\n     * @type {Number}\n     */\n    var extraTimeUnit = 60;\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Controls the taoProctoring delivery page\n     *\n     * @type {Object}\n     */\n    return {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n            var $container = $(cssScope);\n            var $content = $container.find('.content');\n            var $list = $container.find('.list');\n            var crumbs = $container.data('breadcrumbs');\n            var dataset = $container.data('set');\n            var extraFields = $container.data('extrafields');\n            var categories = $container.data('categories');\n            var deliveryId = $container.data('delivery');\n            var isManageable = $container.data('ismanageable');\n            var testCenterId = $container.data('testcenter');\n            var approximateTimer = $container.data('approximatetimer');\n            var approximateTimerWarning = $container.data('approximatetimerwarning');\n            var timeHandlingButton = $container.data('timehandling');\n            var printReportButton = $container.data('printreportbutton');\n            var refreshBtn = $container.data('refreshbtn');\n            var autoRefresh = $container.data('autorefresh');\n            var manageUrl = helpers._url('manage', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var terminateUrl = helpers._url('terminateExecutions', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var pauseUrl = helpers._url('pauseExecutions', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var authoriseUrl = helpers._url('authoriseExecutions', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var extraTimeUrl = helpers._url('extraTime', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var reportUrl = helpers._url('reportExecutions', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var serviceUrl = helpers._url('deliveryExecutions', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter : testCenterId});\n            var serviceAllUrl = helpers._url('allDeliveriesExecutions', 'Delivery', 'taoProctoring', {testCenter : testCenterId});\n            var tools = [];\n            var model = [];\n            var actionButtons;\n            var highlightRows = [];\n            var actionList;\n\n            // request the server with a selection of test takers\n            function request(url, selection, data, message) {\n                if (selection && selection.length) {\n                    loadingBar.start();\n\n                    $.ajax({\n                        url: url,\n                        data: _.merge({\n                            execution: selection\n                        }, data),\n                        dataType : 'json',\n                        type: 'POST',\n                        error: function() {\n                            loadingBar.stop();\n                        }\n                    }).done(function(response) {\n                        var messageContext, unprocessed;\n\n                        loadingBar.stop();\n\n                        if (response && response.success) {\n                            if (message) {\n                                feedback().success(message);\n                            }\n                            $list.datatable('refresh');\n                        } else {\n                            messageContext = '';\n                            if (response) {\n                                unprocessed = _.map(response.unprocessed, function (id) {\n                                    var execution = getExecutionData(id);\n                                    if (execution) {\n                                        return __('Session %s - %s has not been processed', execution.delivery, execution.date);\n                                    }\n                                });\n\n                                if (unprocessed.length) {\n                                    messageContext += '<br>' + unprocessed.join('<br>');\n                                }\n                                if (response.error) {\n                                    messageContext += '<br>' + encode.html(response.error);\n                                }\n                            }\n\n                            feedback().error(__('Something went wrong ...') + '<br>' + messageContext, {encodeHtml: false});\n                        }\n                    });\n                }\n            }\n\n            // request the server to authorise the selected delivery executions\n            function authorise(selection) {\n                execBulkAction('authorize', __('Authorize Session'), selection, function(sel, reason){\n                    request(authoriseUrl, sel, {reason: reason}, __('Sessions authorized'));\n                });\n            }\n\n            // request the server to pause the selected delivery executions\n            function pause(selection) {\n                execBulkAction('pause', __('Pause Session'), selection, function(sel, reason){\n                    request(pauseUrl, sel, {reason: reason}, __('Sessions paused'));\n                });\n            }\n\n            // request the server to terminate the selected delivery executions\n            function terminate(selection) {\n                execBulkAction('terminate', __('Terminate Session'), selection, function(sel, reason){\n                    request(terminateUrl, sel, {reason: reason}, __('Sessions terminated'));\n                });\n            }\n\n            // report irregularities on the selected delivery executions\n            function report(selection) {\n                execBulkAction( 'report', __('Report Irregularity'), selection, function(sel, reason){\n                    request(reportUrl, sel, {reason: reason}, __('Sessions reported'));\n                });\n            }\n\n            function print(selection, type) {\n                execBulkAction('print', __('Print Score'), selection, function(sel){\n                    window.open(helpers._url(type,  'Reporting', 'taoProctoring', {'id' : sel}), 'printReport' + JSON.stringify(sel));\n                });\n            }\n\n            function terminateAndIrregularity(selection) {\n                dialog({\n                    message: __('Please, make your selection'),\n                    autoRender: true,\n                    autoDestroy: true,\n                    buttons: [{\n                        id: 'terminate',\n                        type: 'error',\n                        label: __('Terminate session'),\n                        icon: 'stop',\n                        close: true,\n                        action: function() {terminate(selection);}\n                    },{\n                        id: 'irregularity',\n                        type: 'info',\n                        label: __('Report irregularity'),\n                        icon: 'delivery-small',\n                        close: true,\n                        action: function(){report(selection);}\n                    }]\n                });\n            }\n\n            // display the session history\n            function showHistory(selection) {\n                var urlParams = {\n                    testCenter : testCenterId,\n                    session: selection\n                };\n                if (deliveryId) {\n                    urlParams.delivery = deliveryId;\n                }\n                window.location.href = helpers._url('sessionHistory', 'Reporting', 'taoProctoring', urlParams);\n            }\n\n            // print the score reports\n            function printReport(selection) {\n                print(selection, 'printReport');\n            }\n\n            // print the results of the session\n            function printResults(selection) {\n                print(selection, 'printRubric');\n            }\n\n            // display the time handling popup\n            function timeHandling(selection) {\n                var _selection = _.isArray(selection) ? selection : [selection];\n                var config = _.merge(listSessions('time', _selection), {\n                    renderTo : $content,\n                    actionName : __('Grant Extra Time'),\n                    unit: extraTimeUnit // input extra time in minutes\n                });\n\n                extraTimePopup(config).on('ok', function(time){\n                    request(extraTimeUrl, _selection, {time: time}, __('Extra time granted'));\n                });\n            }\n\n            /**\n             * Check if an action is available with respect to the provided state\n             * @param {String} what\n             * @param {Object} state\n             * @returns {Boolean}\n             */\n            function canDo(what, state) {\n                var status;\n                if (state && state.status) {\n                    status = _status.getStatusByCode(state.status);\n                    return status && status.can[what] === true;\n                }\n                return false;\n            }\n\n            /**\n             * Verify and reformat test taker data for the execBulkAction's need\n             * @param {Object} testTakerData\n             * @param {String} actionName\n             * @returns {Object}\n             */\n            function verifyDelivery(testTakerData, actionName){\n                var deliveryName, formatted, status;\n\n                if (_.isObject(testTakerData.delivery)) {\n                    deliveryName = testTakerData.delivery.label;\n                } else {\n                    deliveryName = $(testTakerData.delivery).text();\n                }\n                formatted = {\n                    id : testTakerData.id,\n                    label: deliveryName + ' [' + testTakerData.date + '] ' + testTakerData.firstname + ' ' + testTakerData.lastname\n                };\n                status = _status.getStatusByCode(testTakerData.state.status);\n\n                if(status){\n                    formatted.allowed = (status.can[actionName] === true);\n                    if(!formatted.allowed){\n                        formatted.reason = status.can[actionName];\n                    }\n                }\n                if (testTakerData.timer) {\n                    formatted.extraTime = testTakerData.timer.extraTime;\n                    formatted.consumedTime = testTakerData.timer.consumedExtraTime;\n                    formatted.remaining = testTakerData.timer.remaining;\n                }\n                return formatted;\n            }\n\n            /**\n             * Find the execution row data from its uri\n             *\n             * @param {String} uri\n             * @returns {Object}\n             */\n            function getExecutionData(uri){\n                return _.find(dataset.data, {id : uri});\n            }\n\n            /**\n             * Gets the list of allowed and forbidden test sessions from the provided selection\n             * @param {String} actionName\n             * @param {Array} selection\n             * @returns {Object} Returns the config object that contains the lists of allowed and forbidden test sessions\n             */\n            function listSessions(actionName, selection) {\n                var allowedDeliveries = [];\n                var forbiddenDeliveries = [];\n\n                _.each(selection, function (uri) {\n                    var testTakerData = getExecutionData(uri);\n                    var checkedDelivery;\n                    if(testTakerData){\n                        checkedDelivery = verifyDelivery(testTakerData, actionName);\n                        if(checkedDelivery.allowed){\n                            allowedDeliveries.push(checkedDelivery);\n                        }else{\n                            forbiddenDeliveries.push(checkedDelivery);\n                        }\n                    }\n                });\n\n                return {\n                    resourceType : 'session',\n                    allowedResources: allowedDeliveries,\n                    deniedResources: forbiddenDeliveries\n                };\n            }\n\n            /**\n             * Exec\n             * @param {String} actionName\n             * @param {String} actionTitle\n             * @param {Array|String} selection\n             * @param {Function} cb\n             * @returns {undefined}\n             */\n            function execBulkAction(actionName, actionTitle, selection, cb){\n                var _selection = _.isArray(selection) ? selection : [selection];\n                var askForReason = (categories[actionName] && categories[actionName].categoriesDefinitions && categories[actionName].categoriesDefinitions.length);\n                var config;\n\n\n                config = _.merge(listSessions(actionName, _selection), {\n                    renderTo : $content,\n                    actionName : actionTitle,\n                    reason : askForReason,\n                    reasonRequired: true,\n                    categoriesSelector: cascadingComboBox(categories[actionName] || {})\n                });\n\n                if (!config.allowedResources.length) {\n                    if (_selection.length > 1) {\n                        feedback().warning(__('No report available for these test sessions'));\n                    } else {\n                        feedback().warning(__('No report available for this test session'));\n                    }\n                } else {\n                    bulkActionPopup(config).on('ok', function(reason){\n                        //execute callback\n                        if(_.isFunction(cb)){\n                            cb(_selection, reason);\n                        }\n                    });\n                }\n            }\n\n            /**\n             * Return html for filter\n             * @returns {String}\n             */\n            function buildStatusFilter(){\n                return statusFilterTpl({statuses: _status.getStatuses()});\n            }\n\n            /**\n             * Additional action perfomed with filter element\n             * @param {jQueryElement} $el\n             */\n            function statusFilterHandler($el) {\n                $el.select2({\n                    dropdownAutoWidth: true,\n                    placeholder: __('Filter'),\n                    minimumResultsForSearch: Infinity,\n                    allowClear: true\n                });\n            }\n\n            breadcrumbsFactory($container, crumbs);\n\n            /**\n             * configurable parameter to show button\n             */\n            if (refreshBtn) {\n                // tool: page refresh\n                tools.push({\n                    id: 'refresh',\n                    icon: 'reset',\n                    title: __('Refresh the page'),\n                    label: __('Refresh'),\n                    action: function () {\n                        $list.datatable('refresh');\n                    }\n                });\n            }\n\n            if (autoRefresh) {\n                setInterval(function () {\n                    $list.datatable('refresh');\n                }, autoRefresh);\n            }\n\n            // tool: manage test takers (only for unique delivery)\n            if (deliveryId && isManageable) {\n                tools.push({\n                    id: 'manage',\n                    icon: 'property-advanced',\n                    title: __('Manage sessions'),\n                    label: __('Manage'),\n                    action: function() {\n                        window.location.href = manageUrl;\n                    }\n                });\n            }\n\n            // tool: authorise the executions\n            tools.push({\n                id: 'authorise',\n                icon: 'play',\n                title: __('Authorize sessions'),\n                label: __('Authorise'),\n                massAction: true,\n                action: authorise\n            });\n\n            // tool: pause the executions\n            tools.push({\n                id: 'pause',\n                icon: 'pause',\n                title: __('Pause sessions'),\n                label: __('Pause'),\n                massAction: true,\n                action: pause\n            });\n\n            // tool: terminate the executions\n            tools.push({\n                id: 'terminate',\n                icon: 'stop',\n                title: __('Terminate sessions'),\n                label: __('Terminate'),\n                massAction: true,\n                action: terminate\n            });\n\n            // tool: report irregularities\n            tools.push({\n                id: 'irregularity',\n                icon: 'delivery-small',\n                title: __('Report irregularities'),\n                label: __('Report'),\n                massAction: true,\n                action: report\n            });\n\n            // tool: display sessions history\n            tools.push({\n                id: 'history',\n                icon: 'history',\n                title: __('Show the detailed session history'),\n                label: __('History'),\n                massAction: true,\n                action: showHistory\n            });\n\n            // tools: print score report\n            tools.push({\n                id : 'printRubric',\n                title : __('Print the score report'),\n                icon : 'print',\n                label : __('Print Score'),\n                massAction: true,\n                action : printResults\n            });\n\n            // tools: print results\n            if (printReportButton) {\n                tools.push({\n                    id : 'printReport',\n                    title : __('Print the assessment results'),\n                    icon : 'result',\n                    label : __('Print Results'),\n                    massAction: true,\n                    action : printReport\n                });\n            }\n\n            // tools: handles the session time\n            if (timeHandlingButton) {\n                tools.push({\n                    id : 'timeHandling',\n                    title : __('Session time handling'),\n                    icon : 'time',\n                    label : __('Time'),\n                    massAction: true,\n                    action : timeHandling\n                });\n            }\n\n            // column: delivery (only for all deliveries view)\n            if (!deliveryId) {\n                model.push({\n                    id: 'delivery',\n                    label: __('Session'),\n                    sortable : true,\n                    transform: function(value, row) {\n                        var delivery = row && row.delivery;\n                        if (delivery) {\n                            delivery.url = helpers._url('monitoring', 'Delivery', 'taoProctoring', {delivery : delivery.uri, testCenter : testCenterId});\n                            value = deliveryLinkTpl(delivery);\n                        }\n                        return value;\n                    }\n                });\n            }\n\n            // column: test taker first name\n            model.push({\n                id: 'firstname',\n                label: __('First name'),\n                sortable : true,\n                transform: function(value, row) {\n                    return row && row.testTaker && row.testTaker.firstName || '';\n\n                }\n            });\n\n            // column: test taker last name\n            model.push({\n                id: 'lastname',\n                label: __('Last name'),\n                sortable : true,\n                transform: function(value, row) {\n                    return row && row.testTaker && row.testTaker.lastName || '';\n\n                }\n            });\n\n            //extra fields\n            _.each(extraFields, function(extraField){\n                model.push({\n                    id : extraField.id,\n                    label: extraField.label,\n                    sortable : true,\n                    transform: function(value, row) {\n                        return row && row.extraFields && row.extraFields[extraField.id] || '';\n                    }\n                });\n            });\n\n            // column: start time\n            model.push({\n                id: 'date',\n                sortable : true,\n                label: __('Started at')\n            });\n\n            // column: delivery execution status\n            model.push({\n                id: 'status',\n                label: __('Status'),\n                sortable : true,\n                filterable : true,\n                customFilter : {\n                    template : buildStatusFilter(),\n                    callback : statusFilterHandler\n                },\n\n                transform: function(value, row) {\n                    var result = '',\n                        status;\n\n                    if (row && row.state && row.state.status) {\n                        status = _status.getStatusByCode(row.state.status);\n                        if (status) {\n                            result = status.label;\n                            if (row.state.status === 'INPROGRESS') {\n                                result = status.label;\n                            }\n                            if (result === 'Awaiting') {\n                                highlightRows.push(row.id);\n                            }\n                        }\n                    }\n                    return result;\n                }\n            });\n\n            // action: authorise the execution\n            model.push({\n                id: 'authorizeCl',\n                label: __('Authorize'),\n                type: 'actions',\n                actions: [{\n                    id: 'authorise',\n                    icon: 'play',\n                    title: __('Authorize session'),\n                    disabled: function() {\n                        return !canDo('authorize', this.state);\n                    },\n                    action: authorise\n                }]\n            });\n\n            // action: pause the execution\n            model.push({\n                id: 'pauseCl',\n                label: __('Pause'),\n                type: 'actions',\n                actions: [{\n                    id: 'pause',\n                    icon: 'pause',\n                    title: __('Pause session'),\n                    disabled: function() {\n                        return !canDo('pause', this.state);\n                    },\n                    action: pause\n                }]\n            });\n\n            // column: remaining time\n            model.push({\n                id: 'remaining',\n                sortable : true,\n                label: __('Remaining'),\n                transform: function(value, row) {\n                    var timer = _.isObject(row.timer) ? row.timer : {};\n                    var refinedValue = approximateTimer ? timer.approximatedRemaining : timer.remaining;\n                    var remaining = parseInt(refinedValue, 10);\n                    var since = parseInt(timer.since, 10);\n\n                    if (remaining || _.isFinite(remaining) ) {\n                        if (remaining < 0 && timer.extraTime) {\n                            timer.consumedExtraTime += -remaining;\n                            remaining = 0;\n                        }\n\n                        if (remaining) {\n                            refinedValue = timeEncoder.encode(remaining);\n                        } else {\n                            refinedValue = '';\n                        }\n\n                        if (!remaining || (timer.extraTime && timer.extraTime <= timer.consumedExtraTime)) {\n                            refinedValue = __('Timed out');\n                        } else {\n                            refinedValue += encodeExtraTime(timer.extraTime, timer.consumedExtraTime, __('%s min'), extraTimeUnit);\n                        }\n\n\n                        if (approximateTimer) {\n                            refinedValue = approximatedTimerTpl({\n                                timer: refinedValue,\n                                since: approximateTimerWarning && _.isFinite(since) && since >= approximateTimerWarning ? (\n                                    __(\"Last test taker's activity: %s\", moment.duration(-since, \"seconds\").humanize(true))\n                                ) : null\n                            });\n                        }\n                    }\n\n                    return refinedValue;\n                }\n            });\n            if (timeHandlingButton) {\n                model.push({\n                    id: 'extraTime',\n                    label: __('Extra Time'),\n                    type: 'actions',\n                    actions: [{\n                        id : 'timeHandling',\n                        title : __('Session time handling'),\n                        icon : 'time',\n                        action : timeHandling,\n                        hidden: function() {\n                            return !canDo('time', this.state);\n                        }\n                    }]\n                });\n            }\n\n            // column: connectivity status of execution progress\n            model.push({\n                id: 'connectivity',\n                sortable: true,\n                label: __('Connectivity'),\n                transform: function(value, row) {\n                    if (row.state.status === _status.STATUS_INPROGRESS) {\n                        return row.online ? __('online') : __('offline');\n                    }\n                    return '';\n                }\n            });\n\n            // column: delivery execution progress\n            model.push({\n                id: 'progress',\n                label: __('Progress'),\n                transform: function(value, row) {\n                    return row && row.state && row.state.progress || '' ;\n                }\n            });\n\n            // column: proctoring actions\n            actionList = [{\n                id: 'terminateAndIrregularity',\n                icon: 'delivery-small',\n                title: __('Terminate and irregularity'),\n                action: terminateAndIrregularity\n            }, {\n                id: 'history',\n                icon: 'history',\n                title: __('Show the detailed session history'),\n                action: showHistory\n            }, {\n                id : 'printRubric',\n                title : __('Print the Score Report'),\n                icon : 'print',\n                action : printResults\n            }];\n            if (printReportButton) {\n                actionList.push({\n                    id : 'printReport',\n                    title : __('Print the assessment results'),\n                    icon : 'result',\n                    action : printReport\n                });\n            }\n\n            model.push({\n                id: 'administrationCl',\n                label: __('Administration'),\n                type: 'actions',\n                actions: actionList\n            });\n\n            // renders the datatable\n            $list\n                .on('query.datatable', function() {\n                    loadingBar.start();\n                    highlightRows = [];\n                })\n                .on('load.datatable', function(e, newDataset) {\n                    //update dateset in memory\n                    dataset = newDataset;\n\n                    //update the buttons, which have been reconstructed\n                    actionButtons = _({\n                        authorize : $list.find('.action-bar').children('.tool-authorise'),\n                        pause : $list.find('.action-bar').children('.tool-pause'),\n                        terminate : $list.find('.action-bar').children('.tool-terminate'),\n                        report : $list.find('.action-bar').children('.tool-irregularity')\n                    });\n\n                    // highlight rows\n                    if (highlightRows.length) {\n                        _.forEach(highlightRows, function (v) {\n                            $list.datatable('highlightRow', v);\n                        });\n                    }\n\n                    loadingBar.stop();\n                })\n                .on('select.datatable', function() {\n                    //hide all controls then display each required one individually\n                    actionButtons.each(function($btn){\n                        $btn.hide();\n                    });\n                    _($list.datatable('selection')).map(function(uri){\n                        var row = getExecutionData(uri);\n                        return row.state.status;\n                    }).uniq().each(function(statusCode){\n                        var status = _status.getStatusByCode(statusCode);\n                        actionButtons.forIn(function($btn, action){\n                            if(status && status.can[action] === true){\n                                $btn.show();\n                            }\n                        });\n                    });\n                })\n                .datatable({\n                    url: deliveryId ? serviceUrl : serviceAllUrl,\n                    status: {\n                        empty: __('No sessions'),\n                        available: __('Current sessions'),\n                        loading: __('Loading')\n                    },\n                    filter: true,\n                    filtercolumns:['status'],\n                    tools: tools,\n                    model: model,\n                    selectable: true,\n                    sortorder: 'desc',\n                    sortby : 'date'\n                }, dataset);\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/Delivery/testTakers',[\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'util/encode',\n    'ui/feedback',\n    'taoProctoring/component/breadcrumbs',\n    'ui/datatable'\n], function ($, __, helpers, loadingBar, encode, feedback, breadcrumbsFactory) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.delivery-testtakers';\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Controls the ProctorDelivery test takers assign page\n     *\n     * @type {Object}\n     */\n    var proctorDeliveryAssignCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n            var $container = $(cssScope);\n            var $list = $container.find('.list');\n            var crumbs = $container.data('breadcrumbs');\n            var dataset = $container.data('set');\n            var deliveryId = $container.data('delivery');\n            var testCenterId = $container.data('testcenter');\n            var serviceUrl = helpers._url('availableTestTakers', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter: testCenterId});\n            var assignUrl = helpers._url('assignTestTakers', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter: testCenterId});\n            var managerUrl = helpers._url('manage', 'Delivery', 'taoProctoring', {delivery : deliveryId, testCenter: testCenterId});\n\n            var bc = breadcrumbsFactory($container, crumbs);\n\n            // send the selection to the server and redirect to the index page\n            var assign = function(selection) {\n                if (selection && selection.length) {\n                    loadingBar.start();\n\n                    $.ajax({\n                        url: assignUrl,\n                        data: {\n                            testtaker: selection\n                        },\n                        dataType : 'json',\n                        type: 'POST',\n                        error: function() {\n                            loadingBar.stop();\n                        }\n                    }).done(function(response) {\n                        loadingBar.stop();\n\n                        if (response && response.success) {\n                            feedback().success(__('Test takers have been added'));\n                            window.location.href = managerUrl;\n                        } else {\n                            feedback().error(__('Something went wrong ...') + '<br>' + encode.html(response.error), {encodeHtml: false});\n                        }\n                    });\n                }\n            };\n\n            $list\n                .on('query.datatable', function() {\n                    loadingBar.start();\n                })\n                .on('load.datatable', function(event, response) {\n                    loadingBar.stop();\n                })\n                .datatable({\n                    url: serviceUrl,\n                    status: {\n                        empty: __('No available test takers to assign'),\n                        available: __('Available test takers'),\n                        loading: __('Loading')\n                    },\n                    tools: [{\n                        id: 'back',\n                        icon: 'left',\n                        title: __('Return to the session manager'),\n                        label: __('Back'),\n                        action: function() {\n                            window.location.href = managerUrl;\n                        }\n                    }, {\n                        id: 'refresh',\n                        icon: 'reset',\n                        title: __('Refresh the page'),\n                        label: __('Refresh'),\n                        action: function() {\n                            $list.datatable('refresh');\n                        }\n                    }, {\n                        id: 'assign',\n                        icon: 'add',\n                        title: __('Assign the selected test takers to the session'),\n                        label: __('Assign the selected test takers'),\n                        massAction: true,\n                        action: function(selection) {\n                            assign(selection);\n                        }\n                    }],\n                    actions: [{\n                        id: 'assign',\n                        icon: 'add',\n                        title: __('Assign the test taker to the session'),\n                        action: function(id) {\n                            assign([id]);\n                        }\n                    }],\n                    selectable: true,\n                    model: [{\n                        id: 'firstname',\n                        label: __('First name')\n                    }, {\n                        id: 'lastname',\n                        label: __('Last name')\n                    }, {\n                        id: 'identifier',\n                        label: __('Identifier')\n                    }]\n                }, dataset);\n        }\n    };\n\n    return proctorDeliveryAssignCtlr;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n * Keep duration of test-taker activity in localstorage\n */\n\ndefine('taoQtiTest/testRunner/resumingStrategy/keepAfterResume',[], function () {\n    'use strict';\n\n    /**\n     * @param {Object} options\n     * @param {string} options.accuracy - period of user status checking\n     */\n    var sessionStateFactory = function sessionStateFactory(options) {\n        var _storageKey = 'sessionState_active_for',\n            _accuracy,\n            _interval = null;\n\n        var sessionState = {\n\n            reset: function reset() {\n                _reset();\n            },\n\n            restart: function restart() {\n                _reset();\n                _start();\n            },\n\n            getDuration: function getDuration() {\n                return getLocalStorageData();\n            }\n        };\n\n        function _start() {\n            if (null !== _interval) {\n                throw new TypeError('Tracking is already started');\n            }\n            _interval = setInterval(function () {\n                setLocalStorageData(getLocalStorageData() + _accuracy);\n            }, _accuracy);\n        }\n\n        function _stop() {\n            clearInterval(_interval);\n            _interval = null;\n        }\n\n        function _reset() {\n            _stop();\n            clearLocalStorage();\n        }\n\n        function _init() {\n            _accuracy = options && options.accuracy || 1000;\n        }\n\n        _init();\n\n        /**\n         * Store duration in ms to local storage\n         * @param {*} val - data to be stored.\n         */\n        function setLocalStorageData(val) {\n            window.localStorage.setItem(_storageKey, val);\n        }\n\n        /**\n         * Get duration from local storage\n         * @returns {int} in ms\n         */\n        function getLocalStorageData() {\n            var data = window.localStorage.getItem(_storageKey),\n                result = JSON.parse(data) || 0;\n            return result;\n        }\n\n        /**\n         * Clear storage\n         */\n        function clearLocalStorage() {\n            window.localStorage.removeItem(_storageKey);\n        }\n\n        return sessionState;\n    };\n\n    return sessionStateFactory;\n});\n","\ndefine('tpl!taoProctoring/templates/deliveryServer/authorizationSuccess', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"success-message\\\">\";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"<span class=\\\"icon-result-ok\\\"></span></span>\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/DeliveryServer/awaiting',[\n    'lodash',\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'ui/listbox',\n    'ui/dialog/alert',\n    'core/polling',\n    'taoQtiTest/testRunner/resumingStrategy/keepAfterResume',\n    'tpl!taoProctoring/templates/deliveryServer/authorizationSuccess'\n], function (_, $, __, helpers, loadingBar, listBox, dialogAlert, polling, keepAfterResume, authSuccessTpl){\n    'use strict';\n\n    /**\n     * The polling delay used to refresh the list\n     * @type {Number}\n     */\n    var refreshPolling = 10 * 1000; // once every 10 seconds\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.awaiting-authorization';\n\n    /**\n     * Controls the ProctorDelivery index page\n     *\n     * @type {Object}\n     */\n    var awaitingAuthorizationCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start(config){\n\n            var $container = $(cssScope);\n            var isAuthorizedUrl = helpers._url('isAuthorized', 'DeliveryServer', 'taoProctoring', {deliveryExecution : config.deliveryExecution});\n            var runDeliveryUrl = helpers._url('runDeliveryExecution', 'DeliveryServer', 'taoProctoring', {deliveryExecution : config.deliveryExecution});\n            var boxes = [{\n                id : 'goToDelivery',\n                label : config.deliveryLabel,\n                url : runDeliveryUrl,\n                content : __('Please wait, authorization in process ...'),\n                text : __('Proceed')\n            }];\n            var list = listBox({\n                title : config.deliveryInit ? __('Start Test') : __('Resume Test'),\n                textEmpty : '',\n                textNumber : '',\n                textLoading : '',\n                renderTo : $container,\n                list : boxes,\n                width : 12\n            });\n            var $content = $container.find('.listbox .content');\n\n            // we need to reset the local timer to avoid loss of time inside the assessment test session\n            keepAfterResume().reset();\n\n            loadingBar.start();\n\n            polling({\n                action : function (){\n                    var async = this.async();\n                    $.get(isAuthorizedUrl, function(result){\n                        var stop = false;\n\n                        if (!result.success) {\n                            stop = true;\n                            if (result.message) {\n                                dialogAlert(result.message, exit);\n                            } else {\n                                exit();\n                            }\n                        } else if (result.authorized) {\n                            stop = true;\n                            authorized();\n                        }\n\n                        if (stop) {\n                            async.reject();\n                        } else {\n                            async.resolve();\n                        }\n                    });\n                },\n                interval : refreshPolling,\n                autoStart : true\n            });\n\n            /**\n             * Function to be called when the delivery execution has been authorized\n             */\n            function authorized(){\n                loadingBar.stop();\n                $container.addClass('authorization-granted').removeClass('authorization-in-progress');\n                $content.html(authSuccessTpl({message : __('Authorized, you may proceed')}));\n            }\n\n            /**\n             * Goes back to the delivery index\n             */\n            function exit() {\n                window.location.href = config.returnUrl;\n            }\n        }\n    };\n\n    return awaitingAuthorizationCtlr;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/helper/textConverter',[\n    'jquery',\n    'lodash',\n    'core/format',\n    'core/promise',\n    'util/url'\n], function ($, _, format, Promise, url) {\n    'use strict';\n\n    /**\n     * The loaded labels\n     * @type {Object}\n     */\n    var labels = null;\n\n    /**\n     * The wrapper that resolve the labels from the loaded list\n     * @type {Object}\n     */\n    var proctoringLabels = {\n        /**\n         * Proctoring translation method.\n         *\n         * @param {String} message should be the string in the default language (usually english) used as the key in the gettext translations\n         * @returns {String} translated message\n         */\n        get: function get(message) {\n            if (labels[message] == undefined) {\n                console.log(message);\n            }\n            var localized = !labels[message] ? message : labels[message];\n\n            if (arguments.length > 1) {\n                arguments[0] = localized;\n                localized = format.apply(null, arguments);\n            }\n\n            return localized;\n        }\n    };\n\n    /**\n     * The promise that is pending to load the labels\n     * @type {Promise}\n     */\n    var pendingPromise;\n\n    /**\n     * Gets the API that access to the proctoring labels\n     * @returns {Promise}\n     */\n    function proctoringLabelsLoader() {\n        if (!pendingPromise) {\n            pendingPromise = new Promise(function (resolve, reject) {\n                $.ajax({\n                    url: url.route('getAll', 'TextConverter', 'taoProctoring'),\n                    type: 'POST',\n                    dataType: 'json'\n                })\n                    .done(function (data) {\n                        labels = data.translations;\n                        resolve(proctoringLabels);\n                    })\n                    .fail(reject);\n            });\n        }\n\n        return pendingPromise;\n    }\n\n    return proctoringLabelsLoader;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/Diagnostic/deliveriesByProctor',[\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'ui/listbox',\n    'taoProctoring/component/breadcrumbs',\n    'taoProctoring/helper/textConverter',\n], function ($, __, helpers, loadingBar, listBox, breadcrumbsFactory, textConverter) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.diagnostic-deliveries';\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Controls the taoProctoring index page\n     *\n     * @type {Object}\n     */\n    return {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n\n            textConverter().then(function(labels) {\n\n                var $container = $(cssScope);\n                var boxes = $container.data('list');\n                var crumbs = $container.data('breadcrumbs');\n                var list = listBox({\n                    title: __('Available Deliveries'),\n                    textEmpty: __(\"No Deliveries available\"),\n                    textNumber: __(\"Available\"),\n                    textLoading: __(\"Loading\"),\n                    renderTo: $container.find('.content'),\n                    replace: true\n                });\n                var bc = breadcrumbsFactory($container, crumbs);\n                var serviceUrl = helpers._url('deliveriesByProctor', 'Diagnostic', 'taoProctoring');\n\n                // update the index from a JSON array\n                var update = function(boxes) {\n                    list.update(boxes);\n                    loadingBar.stop();\n                };\n\n                // refresh the index\n                var refresh = function() {\n                    loadingBar.start();\n                    list.setLoading(true);\n\n                    $.ajax({\n                        url: serviceUrl,\n                        cache: false,\n                        dataType : 'json',\n                        type: 'GET'\n                    }).done(function(response) {\n                        boxes = response && response.list;\n                        update(boxes);\n                    });\n                };\n\n                if (!boxes) {\n                    refresh();\n                } else {\n                    update(boxes);\n                }\n\n            }).catch(function (err) {\n                console.log(err);\n            });\n        }\n    };\n\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n * @author dieter <dieter@taotesting.com>\n */\ndefine('taoClientDiagnostic/tools/diagnostic/status',[\n    'jquery',\n    'lodash',\n    'i18n'\n], function ($, _, __) {\n    'use strict';\n\n    /**\n     * A list of thresholds for performances check\n     * @type {Array}\n     */\n    var performancesThresholds = [{\n        threshold: 0,\n        message: __('Very slow performances'),\n        type: 'error'\n    }, {\n        threshold: 33,\n        message: __('Average performances'),\n        type: 'warning'\n    }, {\n        threshold: 66,\n        message: __('Good performances'),\n        type: 'success'\n    }];\n\n    /**\n     * A list of thresholds for bandwidth check\n     * @type {Array}\n     */\n    var bandwidthThresholds = [{\n        threshold: 0,\n        message: __('Low bandwidth'),\n        type: 'error'\n    }, {\n        threshold: 33,\n        message: __('Average bandwidth'),\n        type: 'warning'\n    }, {\n        threshold: 66,\n        message: __('Good bandwidth'),\n        type: 'success'\n    }];\n\n    /**\n     * A list of thresholds for bandwidth check\n     * @type {Array}\n     */\n    var uploadThresholds = [{\n        threshold: 0,\n        message: __('Low upload speed'),\n        type: 'error'\n    }, {\n        threshold: 33,\n        message: __('Average upload speed'),\n        type: 'warning'\n    }, {\n        threshold: 66,\n        message: __('Good upload speed'),\n        type: 'success'\n    }];\n\n    /**\n     * A list of thresholds for summary\n     * @type {Array}\n     */\n    var summaryThresholds = [{\n        threshold: 0,\n        message: __('Your system requires a compatibility update, please contact your system administrator.'),\n        type: 'error'\n    }, {\n        threshold: 33,\n        message: __('Your system is not optimal, please contact your system administrator.'),\n        type: 'warning'\n    }, {\n        threshold: 66,\n        message: __('Your system is fully compliant.'),\n        type: 'success'\n    }];\n\n    /**\n     * Gets a diagnostic factory manager\n     * @returns {Object}\n     */\n    function diagnosticStatusFactory() {\n        return {\n            /**\n             * The list of known thresholds by context\n             */\n            thresholds: {\n                performances: performancesThresholds,\n                bandwidth: bandwidthThresholds,\n                upload: uploadThresholds,\n                summary: summaryThresholds\n            },\n\n            /**\n             * Gets the thresholds for a particular context\n             * @param {String} name\n             * @returns {Array}\n             */\n            getThresholds: function getThresholds(name) {\n                return this.thresholds[name];\n            },\n\n            /**\n             * Gets the correct status message for a given percentage\n             * @param {Number} percentage\n             * @param {Array|String} thresholds\n             * @returns {Object}\n             */\n            getStatus: function getStatus(percentage, thresholds) {\n                var len, feedback, i, step, status;\n\n                // the percentage is between 0 and 100 and obviously must be a number\n                percentage = Math.max(0, Math.min(100, Math.round(parseInt(percentage, 10))));\n\n                if (_.isString(thresholds)) {\n                    thresholds = this.getThresholds(thresholds);\n                }\n\n                // grab a feedback related to the percentage in the thresholds list\n                if (thresholds) {\n                    if (!_.isArray(thresholds)) {\n                        thresholds = [thresholds];\n                    }\n\n                    len = thresholds.length;\n                    feedback = thresholds[0];\n                    for (i = 1; i < len; i++) {\n                        step = thresholds[i];\n                        if (step && percentage >= step.threshold) {\n                            feedback = step;\n                        } else {\n                            break;\n                        }\n                    }\n                }\n\n                // need a structure compatible with the handlebars template\n                status = {\n                    percentage: percentage,\n                    quality: {}\n                };\n\n                if (feedback) {\n                    status.feedback = _.clone(feedback);\n                }\n\n                return status;\n            }\n        };\n    }\n\n    return diagnosticStatusFactory;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoClientDiagnostic/tools/fixedDecimals',[],function () {\n    'use strict';\n\n    /**\n     * Rounds a value to a fixed number of decimals\n     * @param {Number} value The value to round\n     * @param {Number} decimals The number of decimal\n     * @returns {Number}\n     */\n    var fixedDecimals = function fixedDecimals(value, decimals) {\n        var shift = Math.pow(10, Math.abs(decimals || 1));\n        return Math.round(Number(value) * shift) / shift || 0;\n    };\n\n    return fixedDecimals;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoClientDiagnostic/tools/stats',[\n    'lodash',\n    'taoClientDiagnostic/tools/fixedDecimals'\n], function (_, fixedDecimals) {\n    'use strict';\n\n    /**\n     * Computes some stats on a list from a particular field\n     * @param {Array|Object} list The list to compute stats on\n     * @param {String|Function} fieldName The name of the field to process, or a callback method returning the value\n     * @param {Number} [decimals] Optional number of fixed decimals for values\n     * @returns {Object}\n     */\n    var stats = function stats(list, fieldName, decimals) {\n        var sum = 0;\n        var sum2 = 0;\n        var min = Number.MAX_VALUE;\n        var max = 0;\n        var variance;\n        var count = 0;\n        var values = [];\n        var avg;\n        var med;\n        var middle;\n        var getValue;\n        var results;\n\n        if (_.isFunction(fieldName)) {\n            getValue = fieldName;\n        } else {\n            getValue = function(item) {\n                return item && item[fieldName] || 0;\n            };\n        }\n\n        // process 1st pass stats: compute sum, min and max values\n        _.forEach(list, function(item) {\n            var value;\n            if (undefined !== item) {\n                value = getValue(item);\n                values.push(value);\n                min = Math.min(min, value);\n                max = Math.max(max, value);\n                sum += value;\n                count++;\n            }\n        });\n\n        // compute the average value\n        avg = sum / (count || 1);\n\n        // process 2nd pass stats: compute variance\n        _.forEach(values, function(value) {\n            var diff = value - avg;\n            sum2 += diff * diff;\n        });\n\n        // compute de standard variance\n        variance = count > 1 ? Math.sqrt(sum2 / (count - 1)) : 0;\n\n        // compute the median value\n        values.sort();\n        middle = count / 2;\n        med = (values[Math.floor(middle)] + values[Math.ceil(middle)]) / 2;\n\n        results = {\n            min : min,\n            max : max,\n            sum : sum,\n            count : count,\n            average : avg,\n            median : med,\n            variance : variance\n        };\n\n        if (decimals) {\n            _.forEach(results, function(value, key) {\n                results[key] = fixedDecimals(value, decimals);\n            });\n        }\n\n        results.values = list;\n        return results;\n    };\n\n    return stats;\n});\n\n","define('taoQtiItem/qtiItem/core/qtiClasses',[], function(){\n    return {\n        '_container' : 'taoQtiItem/qtiItem/core/Container',\n        'assessmentItem' : 'taoQtiItem/qtiItem/core/Item',\n        'responseProcessing' : 'taoQtiItem/qtiItem/core/ResponseProcessing',\n        '_simpleFeedbackRule' : 'taoQtiItem/qtiItem/core/response/SimpleFeedbackRule',\n        'stylesheet' : 'taoQtiItem/qtiItem/core/Stylesheet',\n        'math' : 'taoQtiItem/qtiItem/core/Math',\n        'img' : 'taoQtiItem/qtiItem/core/Img',\n        'object' : 'taoQtiItem/qtiItem/core/Object',\n        'outcomeDeclaration' : 'taoQtiItem/qtiItem/core/variables/OutcomeDeclaration',\n        'responseDeclaration' : 'taoQtiItem/qtiItem/core/variables/ResponseDeclaration',\n        'rubricBlock' : 'taoQtiItem/qtiItem/core/RubricBlock',\n        'associableHotspot' : 'taoQtiItem/qtiItem/core/choices/AssociableHotspot',\n        'gap' : 'taoQtiItem/qtiItem/core/choices/Gap',\n        'gapImg' : 'taoQtiItem/qtiItem/core/choices/GapImg',\n        'gapText' : 'taoQtiItem/qtiItem/core/choices/GapText',\n        'hotspotChoice' : 'taoQtiItem/qtiItem/core/choices/HotspotChoice',\n        'hottext' : 'taoQtiItem/qtiItem/core/choices/Hottext',\n        'inlineChoice' : 'taoQtiItem/qtiItem/core/choices/InlineChoice',\n        'simpleAssociableChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice',\n        'simpleChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleChoice',\n        'associateInteraction' : 'taoQtiItem/qtiItem/core/interactions/AssociateInteraction',\n        'choiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/ChoiceInteraction',\n        'endAttemptInteraction' : 'taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction',\n        'extendedTextInteraction' : 'taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction',\n        'gapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GapMatchInteraction',\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction',\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction',\n        'graphicOrderInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction',\n        'hotspotInteraction' : 'taoQtiItem/qtiItem/core/interactions/HotspotInteraction',\n        'hottextInteraction' : 'taoQtiItem/qtiItem/core/interactions/HottextInteraction',\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction',\n        'matchInteraction' : 'taoQtiItem/qtiItem/core/interactions/MatchInteraction',\n        'mediaInteraction' : 'taoQtiItem/qtiItem/core/interactions/MediaInteraction',\n        'orderInteraction' : 'taoQtiItem/qtiItem/core/interactions/OrderInteraction',\n        'prompt' : 'taoQtiItem/qtiItem/core/interactions/Prompt',\n        'selectPointInteraction' : 'taoQtiItem/qtiItem/core/interactions/SelectPointInteraction',\n        'sliderInteraction' : 'taoQtiItem/qtiItem/core/interactions/SliderInteraction',\n        'textEntryInteraction' : 'taoQtiItem/qtiItem/core/interactions/TextEntryInteraction',\n        'uploadInteraction' : 'taoQtiItem/qtiItem/core/interactions/UploadInteraction',\n        'feedbackBlock' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackBlock',\n        'feedbackInline' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackInline',\n        'modalFeedback' : 'taoQtiItem/qtiItem/core/feedbacks/ModalFeedback',\n        'customInteraction' : 'taoQtiItem/qtiItem/core/interactions/CustomInteraction',\n        'infoControl' : 'taoQtiItem/qtiItem/core/PortableInfoControl',\n        'include' : 'taoQtiItem/qtiItem/core/Include'\n    };\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\n *\n */\n\n/**\n * Common basic util functions\n */\ndefine('taoQtiItem/qtiItem/helper/util',['lodash'], function(_){\n    'use strict';\n\n    var util = {\n\n        buildSerial : function buildSerial(prefix){\n            var id = prefix || '';\n            var chars = \"abcdefghijklmnopqrstuvwxyz0123456789\";\n            for(var i = 0; i < 22; i++){\n                id += chars.charAt(Math.floor(Math.random() * chars.length));\n            }\n            return id;\n        },\n\n        /**\n         * Generates an id for a Qti element (the generation is different from identifier)\n         * @param {Object} item - the element related item\n         * @param {String} prefix - identifier prefix\n         * @returns {String} the identifier\n         * @throws {TypeError} if there is no item\n         */\n        buildId : function buildId(item, prefix){\n            var id;\n            var usedIds;\n            var i = 1;\n            var suffix = '';\n            var exists = false;\n\n            if(!item){\n                throw new TypeError('A item is required to generate a unique identifier');\n            }\n\n            usedIds   = item.getUsedIds();\n\n            do{\n                exists = false;\n                id = prefix + suffix;\n                if(_.contains(usedIds, id)){\n                    exists = true;\n                    suffix = '_' + i;\n                    i++;\n                }\n            } while(exists);\n\n            return id;\n        },\n\n        /**\n         * Generates an identifier for a Qti element\n         * @param {Object} item - the element related item\n         * @param {String} prefix - identifier prefix\n         * @param {Boolean} [useSuffix = true] - add a \"_ + index\" to the identifier\n         * @returns {String} the identifier\n         * @throws {TypeError} if there is no item\n         */\n        buildIdentifier : function buildIdentifier(item, prefix, useSuffix){\n\n            var id;\n            var usedIds;\n            var suffix = '';\n            var i = 1;\n            var exists = false;\n\n            if(!item){\n                throw new TypeError('A item is required to generate a unique identifier');\n            }\n\n            if(!prefix){\n                throw new TypeError('Prefix is required to build an identifier');\n            }\n\n            usedIds   = item.getUsedIdentifiers();\n            useSuffix = _.isUndefined(useSuffix) ? true : useSuffix;\n\n            if(prefix){\n                prefix = prefix.replace(/_[0-9]+$/ig, '_') //detect incremental id of type choice_12, response_3, etc.\n                               .replace(/[^a-zA-Z0-9_]/ig, '_')\n                               .replace(/(_)+/ig, '_');\n                if(useSuffix){\n                    suffix = '_' + i;\n                }\n            }\n\n            do{\n                exists = false;\n                id = prefix + suffix;\n                if(usedIds[id]){\n                    exists = true;\n                    suffix = '_' + i;\n                    i++;\n                }\n            } while(exists);\n\n            return id;\n        },\n\n        findInCollection : function findInCollection(element, collectionNames, searchedSerial){\n\n            var found = null;\n\n            if(_.isString(collectionNames)){\n                collectionNames = [collectionNames];\n            }\n\n            if(_.isArray(collectionNames)){\n\n                _.each(collectionNames, function(collectionName){\n\n                    //get collection to search in (resolving case like interaction.choices.0\n                    var collection = element;\n                    _.each(collectionName.split('.'), function(nameToken){\n                        collection = collection[nameToken];\n                    });\n                    var elt = collection[searchedSerial];\n\n                    if(elt){\n                        found = {'parent' : element, 'element' : elt};\n                        return false;//break the each loop\n                    }\n\n                    //search inside each elements:\n                    _.each(collection, function(elt){\n\n                        if(_.isFunction(elt.find)){\n                            found = elt.find(searchedSerial);\n                            if(found){\n                                return false;//break the each loop\n                            }\n                        }\n\n                    });\n\n                    if(found){\n                        return false;//break the each loop\n                    }\n\n                });\n\n            }else{\n\n                throw new Error('invalid argument : collectionNames must be an array or a string');\n            }\n\n            return found;\n        },\n        addMarkupNamespace : function addMarkupNamespace(markup, ns){\n            if(ns) {\n                markup = markup.replace(/<(\\/)?([a-z:]+)(\\s?)([^><]*)>/g, function($0, $1, $2, $3, $4){\n                    if($2.indexOf(':')>0){\n                        return $0;\n                    }\n                    $1 = $1 || '';\n                    $3 = $3 || '';\n                    return '<'+ $1 + ns + ':'+$2+$3+$4+'>';\n                });\n                return markup;\n            }\n            return markup;\n\n        },\n        removeMarkupNamespaces : function removeMarkupNamespace(markup){\n            return markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, '<$1$3>');\n        },\n        getMarkupUsedNamespaces : function getMarkupUsedNamespaces(markup){\n            var namespaces = [];\n            markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, function(original, slash, ns, node){\n                namespaces.push(ns);\n                return '<'+slash+node+'>';\n            });\n            return _.uniq(namespaces);\n        }\n    };\n\n    return util;\n});\n\n","define('taoQtiItem/qtiItem/helper/rendererConfig',['lodash', 'jquery'], function(_, $){\n\n    var rendererConfigHelper = {};\n\n    rendererConfigHelper.getOptionsFromArguments = function(args){\n\n        var options = {\n            data : {},\n            placeholder : null,\n            subclass : '',\n            renderer : null\n        };\n        \n        _.each(args, function(arg){\n            if(arg){\n                if(arg.isRenderer){\n                    options.renderer = arg;\n                }else if(arg instanceof $ && arg.length){\n                    options.placeholder = arg;\n                }else if(_.isString(arg)){\n                    options.subclass = arg;\n                }else if(_.isPlainObject(arg)){\n                    options.data = arg;\n                }else{\n                    console.log('invalid arg', arg, args);\n                }\n            }\n        });\n        \n        return options;\n    };\n    \n    return rendererConfigHelper;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\n *\n */\ndefine('taoQtiItem/qtiItem/core/Element',[\n    'jquery',\n    'lodash',\n    'class',\n    'taoQtiItem/qtiItem/helper/util',\n    'taoQtiItem/qtiItem/helper/rendererConfig'\n], function($, _, Class, util, rendererConfig){\n    'use strict';\n\n    var _instances = {};\n\n    var Element = Class.extend({\n        qtiClass : '',\n        serial : '',\n        relatedItem : null,\n        init : function(serial, attributes){\n\n            //init own attributes\n            this.attributes = {};\n\n            //system properties, for item creator internal use only\n            this.metaData = {};\n\n            //init call in the format init(attributes)\n            if(typeof (serial) === 'object'){\n                attributes = serial;\n                serial = '';\n            }\n\n            if(!serial){\n                serial = util.buildSerial(this.qtiClass + '_');\n            }\n\n            if(serial && (typeof serial !== 'string' || !serial.match(/^[a-z_0-9]*$/i))){\n                throw 'invalid QTI serial : (' + (typeof serial) + ') ' + serial;\n            }\n\n            if(!_instances[serial]){\n                _instances[serial] = this;\n                this.serial = serial;\n                this.setAttributes(attributes || {});\n            }else{\n                throw 'a QTI Element with the same serial already exists ' + serial;\n            }\n\n            if(typeof this.initContainer === 'function'){\n                this.initContainer(arguments[2] || '');\n            }\n            if(typeof this.initObject === 'function'){\n                this.initObject();\n            }\n        },\n        is : function(qtiClass){\n            return (qtiClass === this.qtiClass);\n        },\n        placeholder : function(){\n            return '{{' + this.serial + '}}';\n        },\n        getSerial : function(){\n            return this.serial;\n        },\n        getUsedIdentifiers : function(){\n            var usedIds = {};\n            var elts = this.getComposingElements();\n            for(var i in elts){\n                var elt = elts[i];\n                var id = elt.attr('identifier');\n                if(id){\n                    //warning: simplistic implementation, allow only one unique identifier in the item no matter the element class/type\n                    usedIds[id] = elt;\n                }\n            }\n            return usedIds;\n        },\n\n        /**\n         * Get the ids in use. (id is different from identifier)\n         * @returns {Array} of the ids in use\n         */\n        getUsedIds : function getUsedIds(){\n            var usedIds = [];\n            _.forEach(this.getComposingElements(), function(elt){\n                var id = elt.attr('id');\n                if(id && !_.contains(usedIds, id)){\n                    usedIds.push(id);\n                }\n            });\n            return usedIds;\n        },\n\n        attr : function(name, value){\n            if(name){\n                if(value !== undefined){\n                    this.attributes[name] = value;\n                }else{\n                    if(typeof (name) === 'object'){\n                        for(var prop in name){\n                            this.attr(prop, name[prop]);\n                        }\n                    }else if(typeof (name) === 'string'){\n                        if(this.attributes[name] === undefined){\n                            return undefined;\n                        }else{\n                            return this.attributes[name];\n                        }\n                    }\n                }\n            }\n            return this;\n        },\n        data : function(name, value){\n            if(name){\n                if(value !== undefined){\n                    this.metaData[name] = value;\n                    $(document).trigger('metaChange.qti-widget', {element : this, key : name, value : value});\n                }else{\n                    if(typeof (name) === 'object'){\n                        for(var prop in name){\n                            this.data(prop, name[prop]);\n                        }\n                    }else if(typeof (name) === 'string'){\n                        if(this.metaData[name] === undefined){\n                            return undefined;\n                        }else{\n                            return this.metaData[name];\n                        }\n                    }\n                }\n            }\n            return this;\n        },\n        removeData : function(name){\n            delete this.metaData[name];\n            return this;\n        },\n        removeAttr : function(name){\n            return this.removeAttributes(name);\n        },\n        setAttributes : function(attributes){\n            this.attributes = attributes;\n            return this;\n        },\n        getAttributes : function(){\n            return _.clone(this.attributes);\n        },\n        removeAttributes : function(attrNames){\n            if(typeof (attrNames) === 'string'){\n                attrNames = [attrNames];\n            }\n            for(var i in attrNames){\n                delete this.attributes[attrNames[i]];\n            }\n            return this;\n        },\n        getComposingElements : function(){\n            var elts = {};\n            function append(element){\n                elts[element.getSerial()] = element;//pass individual object by ref, instead of the whole list(object)\n                elts = _.extend(elts, element.getComposingElements());\n            }\n            if(typeof this.initContainer === 'function'){\n                append(this.getBody());\n            }\n            if(typeof this.initObject === 'function'){\n                append(this.getObject());\n            }\n            _.each(this.metaData, function(v){\n                if(Element.isA(v, '_container')){\n                    append(v);\n                }else if(_.isArray(v)){\n                    _.each(v, function(v){\n                        if(Element.isA(v, '_container')){\n                            append(v);\n                        }\n                    });\n                }\n            });\n            return elts;\n        },\n        getUsedClasses : function(){\n\n            var ret = [this.qtiClass],\n                composingElts = this.getComposingElements();\n\n            _.each(composingElts, function(elt){\n                ret.push(elt.qtiClass);\n            });\n\n            return _.uniq(ret);\n        },\n        find : function(serial){\n\n            var found = null;\n\n            if(typeof this.initObject === 'function'){\n                var object = this.getObject();\n                if(object.serial === serial){\n                    found = {'parent' : this, 'element' : object, 'location' : 'object'};\n                }\n            }\n\n            if(!found && typeof this.initContainer === 'function'){\n                found = this.getBody().find(serial, this);\n            }\n\n            return found;\n        },\n        parent : function(){\n            var item = this.getRelatedItem();\n            if(item){\n                var found = item.find(this.getSerial());\n                if(found){\n                    return found.parent;\n                }\n            }\n            return null;\n        },\n        setRelatedItem : function(item, recursive){\n\n            recursive = (typeof recursive === 'undefined') ? true : recursive;\n\n            if(Element.isA(item, 'assessmentItem')){\n                this.relatedItem = item;\n                var composingElts = this.getComposingElements();\n                for(var i in composingElts){\n                    composingElts[i].setRelatedItem(item, false);\n                }\n            }\n\n        },\n        getRelatedItem : function(){\n            var ret = null;\n            if(Element.isA(this.relatedItem, 'assessmentItem')){\n                ret = this.relatedItem;\n            }\n            return ret;\n        },\n        setRenderer : function(renderer){\n            if(renderer && renderer.isRenderer){\n                this.renderer = renderer;\n                var elts = this.getComposingElements();\n                for(var serial in elts){\n                    elts[serial].setRenderer(renderer);\n                }\n            }else{\n                throw 'invalid qti rendering engine';\n            }\n        },\n        getRenderer : function(){\n            return this.renderer;\n        },\n        render : function(){\n\n            var args = rendererConfig.getOptionsFromArguments(arguments);\n            var _renderer = args.renderer || this.getRenderer();\n\n            var tplData = {},\n                defaultData = {\n                    'tag' : this.qtiClass,\n                    'serial' : this.serial,\n                    'attributes' : this.getAttributes()\n                };\n\n            if(!_renderer){\n                throw 'render: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n\n            if(typeof this.initContainer === 'function'){\n                //allow body to have a different renderer if it has its own renderer set\n                defaultData.body = this.getBody().render(args.renderer);\n            }\n            if(typeof this.initObject === 'function'){\n                defaultData.object = {\n                    attributes : this.object.getAttributes()\n                };\n                defaultData.object.attributes.data = _renderer.resolveUrl(this.object.attr('data'));\n            }\n\n            tplData = _.merge(defaultData, args.data || {});\n            tplData = _renderer.getData(this, tplData, args.subclass);\n            var rendering = _renderer.renderTpl(this, tplData, args.subclass);\n            if(args.placeholder){\n                args.placeholder.replaceWith(rendering);\n            }\n\n            return rendering;\n        },\n        postRender : function(data, altClassName, renderer){\n\n            var postRenderers = [];\n            var _renderer = renderer || this.getRenderer();\n\n            if(typeof this.initContainer === 'function'){\n                //allow body to have a different renderer if it has its own renderer set\n                postRenderers = this.getBody().postRender({}, '', renderer);\n            }\n\n            if(_renderer){\n                postRenderers.push(_renderer.postRender(this, data, altClassName));\n            }else{\n                throw 'postRender: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n\n            return _.compact(postRenderers);\n        },\n        getContainer : function($scope, subclass){\n            var renderer = this.getRenderer();\n            if(renderer){\n                return renderer.getContainer(this, $scope, subclass);\n            }else{\n                throw 'getContainer: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n        },\n        toArray : function(){\n            var arr = {\n                serial : this.serial,\n                type : this.qtiClass,\n                attributes : this.getAttributes()\n            };\n\n            if(typeof this.initContainer === 'function'){\n                arr.body = this.getBody().toArray();\n            }\n            if(typeof this.initObject === 'function'){\n                arr.object = this.object.toArray();\n            }\n\n            return arr;\n        },\n        isEmpty : function(){\n            //tells whether the element should be considered empty or not, from the rendering point of view\n            return false;\n        },\n        addClass : function(className){\n            var clazz = this.attr('class') || '';\n            if(!_containClass(clazz, className)){\n                this.attr('class', clazz + (clazz.length ? ' ' : '') + className);\n            }\n        },\n        hasClass : function(className){\n            return _containClass(this.attr('class'), className);\n        },\n        removeClass : function(className){\n\n            var clazz = this.attr('class') || '';\n            if(clazz){\n\n                var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)');\n                clazz = clazz.replace(regex, ' ').trim();\n\n                if(clazz){\n                    this.attr('class', clazz);\n                }else{\n                    this.removeAttr('class');\n                }\n            }\n        },\n        /**\n         * Add or remove class. Setting the optional state will force addition/removal.\n         * State is here to keep the jQuery syntax\n         *\n         * @param {String} className\n         * @param {Boolean} [state]\n         */\n        toggleClass : function(className, state) {\n\n            if(typeof state === 'boolean') {\n                return state ? this.addClass(className) : this.removeClass(className);\n            }\n\n            if(this.hasClass(className)) {\n                return this.removeClass(className);\n            }\n            return this.addClass(className);\n        },\n        isset : function(){\n            return Element.issetElement(this.serial);\n        },\n        unset : function(){\n            return Element.unsetElement(this.serial);\n        }\n    });\n\n    var _containClass = function(allClassStr, className){\n        var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)', '');\n        return allClassStr && regex.test(allClassStr);\n    };\n\n    //helpers\n    Element.isA = function(qtiElement, qtiClass){\n        return (qtiElement instanceof Element && qtiElement.is(qtiClass));\n    };\n\n    Element.getElementBySerial = function(serial){\n        return _instances[serial];\n    };\n\n    Element.issetElement = function(serial){\n        return !!_instances[serial];\n    };\n\n    /**\n     * Unset a registered element from it's serial\n     * @param {String} serial - the element serial\n     * @returns {Boolean} true if unset\n     */\n    Element.unsetElement = function(serial){\n\n        var element = Element.getElementBySerial(serial);\n\n        if(element){\n\n            var composingElements = element.getComposingElements();\n            _.each(composingElements, function(elt){\n                delete _instances[elt.serial];\n            });\n            delete _instances[element.serial];\n\n            return true;\n        }\n        return false;\n    };\n\n    return Element;\n});\n\n\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n *\n */\n//@todo : move this to the ../helper directory\ndefine('taoQtiItem/qtiItem/core/Loader',['lodash', 'class', 'taoQtiItem/qtiItem/core/qtiClasses', 'taoQtiItem/qtiItem/core/Element'], function(_, Class, qtiClasses, Element){\n\n    var Loader = Class.extend({\n        init : function(item, classesLocation){\n\n            this.qti = {}; //loaded qti classes are store here\n            this.classesLocation = {};\n\n            this.item = item || null;//starts either from scratch or with an existing item object\n            this.setClassesLocation(classesLocation || qtiClasses);//load default location for qti classes model\n        },\n        setClassesLocation : function(qtiClasses){\n            _.extend(this.classesLocation, qtiClasses);\n            return this;\n        },\n        getRequiredClasses : function(data){\n            var ret = [];\n            for(var i in data){\n                if(i === 'qtiClass' && data[i] !== '_container' && i !== 'relatedItem'){//although a _container is a concrete class in TAO, it is not defined in QTI standard\n                    ret.push(data[i]);\n                }else if(typeof(data[i]) === 'object' && i !== 'responseRules'){    //responseRules should'nt be part of the parsing\n                    ret = _.union(ret, this.getRequiredClasses(data[i]));\n                }\n            }\n            return ret;\n        },\n        loadRequiredClasses : function(data, callback, reload){\n\n            var requiredClasses = this.getRequiredClasses(data, reload), required = [];\n\n            for(var i in requiredClasses){\n                var requiredClass = requiredClasses[i];\n                if(this.classesLocation[requiredClass]){\n                    required.push(this.classesLocation[requiredClass]);\n                }else{\n                    throw new Error('missing qti class location declaration : ' + requiredClass);\n                }\n            }\n\n            var _this = this;\n            require(required, function(){\n                _.each(arguments, function(QtiClass){\n                    _this.qti[QtiClass.prototype.qtiClass] = QtiClass;\n                });\n                callback.call(_this, _this.qti);\n            });\n        },\n        getLoadedClasses : function(){\n            return _.keys(this.qti);\n        },\n        loadItemData : function(data, callback){\n\n            var _this = this;\n            _this.loadRequiredClasses(data, function(Qti){\n                var i;\n                if(typeof(data) === 'object' && data.qtiClass === 'assessmentItem'){\n\n                    //unload an item from it's serial (in case of a reload)\n                    if(data.serial){\n                        Element.unsetElement(data.serial);\n                    }\n\n                    _this.item = new Qti.assessmentItem(data.serial, data.attributes || {});\n                    _this.loadContainer(_this.item.getBody(), data.body);\n\n                    for(i in data.outcomes){\n                        var outcome = _this.buildOutcome(data.outcomes[i]);\n                        if(outcome){\n                            _this.item.addOutcomeDeclaration(outcome);\n                        }\n                    }\n                    for(i in data.feedbacks){\n                        var feedback = _this.buildElement(data.feedbacks[i]);\n                        if(feedback){\n                            _this.item.addModalFeedback(feedback);\n                        }\n                    }\n                    for(i in data.stylesheets){\n                        var stylesheet = _this.buildElement(data.stylesheets[i]);\n                        if(stylesheet){\n                            _this.item.addStylesheet(stylesheet);\n                        }\n                    }\n                    \n                    //important : build responses after all modal feedbacks and outcomes has been loaded, because the simple feedback rules need to reference them\n                    for(i in data.responses){\n                        var response = _this.buildResponse(data.responses[i]);\n                        if(response){\n                            _this.item.addResponseDeclaration(response);\n\n                            var feedbackRules = data.responses[i].feedbackRules;\n                            if(feedbackRules){\n                                _.forIn(feedbackRules, function(fbData, serial){\n                                    response.feedbackRules[serial] = _this.buildSimpleFeedbackRule(fbData, response);\n                                });\n                            }\n                        }\n                    }\n                    \n                    if(data.responseProcessing){\n                        _this.item.setResponseProcessing(_this.buildResponseProcessing(data.responseProcessing));\n                    }\n                    _this.item.setNamespaces(data.namespaces);\n                    _this.item.setSchemaLocations(data.schemaLocations);\n                    _this.item.setApipAccessibility(data.apipAccessibility);\n                }\n\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, _this.item);\n                }\n            });\n        },\n        loadAndBuildElement : function(data, callback){\n\n            var _this = this;\n\n            _this.loadRequiredClasses(data, function(Qti){\n\n                var element = _this.buildElement(data);\n\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, element);\n                }\n            });\n        },\n        loadElement : function(element, data, callback){\n\n            var _this = this;\n            this.loadRequiredClasses(data, function(){\n                _this.loadElementData(element, data);\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, element);\n                }\n            });\n        },\n        /**\n         * Load ALL given elements into existing loaded item\n         *\n         * @todo to be renamed to loadItemElements\n         * @param {object} data\n         * @param {function} callback\n         * @returns {undefined}\n         */\n        loadElements : function(data, callback){\n\n            var _this = this;\n\n            if(_this.item){\n\n                this.loadRequiredClasses(data, function(){\n\n                    var allElements = _this.item.getComposingElements();\n\n                    for(var i in data){\n                        var elementData = data[i];\n                        if(elementData && elementData.qtiClass && elementData.serial){\n                            //find and update element\n                            if(allElements[elementData.serial]){\n                                _this.loadElementData(allElements[elementData.serial], elementData);\n                            }\n                        }\n                    }\n\n                    if(typeof(callback) === 'function'){\n                        callback.call(_this, _this.item);\n                    }\n                });\n            }else{\n                throw 'QtiLoader : cannot load elements in empty item';\n            }\n\n        },\n        buildResponse : function(data){\n\n            var response = this.buildElement(data);\n\n            response.template = data.howMatch || null;\n            response.defaultValue = data.defaultValue || null;\n            response.correctResponse = data.correctResponses || null;\n\n            if(_.size(data.mapping)){\n                response.mapEntries = data.mapping;\n            }else if(_.size(data.areaMapping)){\n                response.mapEntries = data.areaMapping;\n            }else{\n                response.mapEntries = {};\n            }\n\n            response.mappingAttributes = data.mappingAttributes || {};\n\n            return response;\n        },\n        buildSimpleFeedbackRule : function(data, response){\n\n            var feedbackRule = this.buildElement(data);\n            \n            feedbackRule.setCondition(response, data.condition, data.comparedValue || null);\n            \n//            feedbackRule.comparedOutcome = this.item.responses[data.comparedOutcome] || null;\n            feedbackRule.feedbackOutcome = this.item.outcomes[data.feedbackOutcome] || null;\n            feedbackRule.feedbackThen = this.item.modalFeedbacks[data.feedbackThen] || null;\n            feedbackRule.feedbackElse = this.item.modalFeedbacks[data.feedbackElse] || null;\n            \n            //associate the compared outcome to the feedbacks if applicable\n            var response = feedbackRule.comparedOutcome;\n            if(feedbackRule.feedbackThen){\n                feedbackRule.feedbackThen.data('relatedResponse', response);\n            }\n            if(feedbackRule.feedbackElse){\n                feedbackRule.feedbackElse.data('relatedResponse', response);\n            }\n            \n            return feedbackRule;\n        },\n        buildOutcome : function(data){\n            var outcome = this.buildElement(data);\n            outcome.defaultValue = data.defaultValue || null;\n            return outcome;\n        },\n        buildResponseProcessing : function(data){\n            var rp = this.buildElement(data);\n            if(data && data.processingType){\n                if(data.processingType === 'custom'){\n                    rp.xml = data.data;\n                    rp.processingType = 'custom';\n                }else{\n                    rp.processingType = 'templateDriven';\n                }\n            }\n            return rp;\n        },\n        loadContainer : function(bodyObject, bodyData){\n            if(!Element.isA(bodyObject, '_container')){\n                throw 'bodyObject must be a QTI Container';\n            }\n\n            if(bodyData && typeof bodyData.body === 'string' && (typeof bodyData.elements === 'array' || typeof bodyData.elements === 'object')){\n                for(var serial in bodyData.elements){\n                    var eltData = bodyData.elements[serial];\n                    //check if class is loaded:\n                    var element = this.buildElement(eltData);\n                    if(element){\n                        bodyObject.setElement(element, bodyData.body);\n                    }\n                }\n                bodyObject.body(bodyData.body);\n            }else{\n                throw 'wrong bodydata format';\n            }\n        },\n        buildElement : function(elementData){\n            var elt = null;\n            if(elementData && elementData.qtiClass && elementData.serial){\n                var className = elementData.qtiClass;\n                if(this.qti[className]){\n                    elt = new this.qti[className](elementData.serial);\n                    this.loadElementData(elt, elementData);\n                }else{\n                    throw 'the qti element class does not exist: ' + className;\n                }\n            }else{\n                throw 'wrong elementData format';\n            }\n            return elt;\n        },\n        loadElementData : function(element, data){\n\n            //merge attributes when loading element data\n            var attributes = _.defaults(data.attributes || {}, element.attributes || {});\n            element.setAttributes(attributes);\n\n            if(element.body && data.body){\n                if(element.bdy){\n                    this.loadContainer(element.getBody(), data.body);\n                }\n            }\n\n            if(element.object && data.object){\n                if(element.object){\n                    this.loadObjectData(element.object, data.object);\n                }\n            }\n\n            if(Element.isA(element, 'interaction')){\n                this.loadInteractionData(element, data);\n            }else if(Element.isA(element, 'choice')){\n                this.loadChoiceData(element, data);\n            }else if(Element.isA(element, 'math')){\n                this.loadMathData(element, data);\n            }else if(Element.isA(element, 'infoControl')){\n                this.loadPicData(element, data);\n            }\n\n            return element;\n        },\n        loadInteractionData : function(interaction, data){\n            if(Element.isA(interaction, 'blockInteraction')){\n                if(data.prompt){\n                    this.loadContainer(interaction.prompt.getBody(), data.prompt);\n                }\n            }\n\n            this.buildInteractionChoices(interaction, data);\n\n            if(Element.isA(interaction, 'customInteraction')){\n                this.loadPciData(interaction, data);\n            }\n        },\n        buildInteractionChoices : function(interaction, data){\n\n            //note: Qti.ContainerInteraction (Qti.GapMatchInteraction and Qti.HottextInteraction) has already been parsed by builtElement(interacionData);\n            if(data.choices){\n                if(Element.isA(interaction, 'matchInteraction')){\n                    for(var set = 0; set < 2; set++){\n                        if(!data.choices[set]){\n                            throw 'missing match set #' + set;\n                        }\n                        var matchSet = data.choices[set];\n                        for(var serial in matchSet){\n                            var choice = this.buildElement(matchSet[serial]);\n                            if(choice){\n                                interaction.addChoice(choice, set);\n                            }\n                        }\n                    }\n                }else{\n                    for(var serial in data.choices){\n                        var choice = this.buildElement(data.choices[serial]);\n                        if(choice){\n                            interaction.addChoice(choice);\n                        }\n                    }\n                }\n\n                if(Element.isA(interaction, 'graphicGapMatchInteraction')){\n                    if(data.gapImgs){\n                        for(var serial in data.gapImgs){\n                            var gapImg = this.buildElement(data.gapImgs[serial]);\n                            if(gapImg){\n                                interaction.addGapImg(gapImg);\n                            }\n                        }\n                    }\n                }\n\n            }\n\n        },\n        loadChoiceData : function(choice, data){\n            if(Element.isA(choice, 'textVariableChoice')){\n                choice.val(data.text);\n            }else if(Element.isA(choice, 'gapImg')){\n                //has already been taken care of in buildElement()\n            }else if(Element.isA(choice, 'containerChoice')){\n                //has already been taken care of in buildElement()\n            }\n        },\n        loadObjectData : function(object, data){\n            object.setAttributes(data.attributes);\n            //@todo: manage object like a container\n            if(data._alt){\n                if(data._alt.qtiClass === 'object'){\n                    object._alt = Loader.buildElement(data._alt);\n                }else{\n                    object._alt = data._alt;\n                }\n            }\n        },\n        loadMathData : function(math, data){\n            math.ns = data.ns || {};\n            math.setMathML(data.mathML || '');\n            _.forIn(data.annotations || {}, function(value, encoding){\n                math.setAnnotation(encoding, value);\n            });\n        },\n        loadPciData : function(pci, data){\n            loadPortableCustomElementData(pci, data);\n        },\n        loadPicData : function(pic, data){\n            loadPortableCustomElementData(pic, data);\n        }\n    });\n\n    function loadPortableCustomElementData(portableElement, data){\n        portableElement.typeIdentifier = data.typeIdentifier;\n        portableElement.markup = data.markup;\n        portableElement.entryPoint = data.entryPoint;\n        portableElement.properties = data.properties;\n        portableElement.libraries = data.libraries;\n    }\n\n    return Loader;\n});\n\n","/**\n * Common helper functions\n */\ndefine('taoQtiItem/qtiItem/helper/interactionHelper',['lodash', 'taoQtiItem/qtiItem/core/Element'], function(_, Element){\n    return {\n        convertChoices : function(choices, outputType){\n\n            var ret = [], _this = this;\n\n            _.each(choices, function(c){\n                if(Element.isA(c, 'choice')){\n                    switch(outputType){\n                        case 'serial':\n                            ret.push(c.getSerial());\n                            break;\n                        case 'identifier':\n                            ret.push(c.id());\n                            break;\n                        default:\n                            ret.push(c);\n                    }\n\n                }else if(_.isArray(c)){\n                    ret.push(_this.convertChoices(c, outputType));\n                }\n            });\n\n            return ret;\n        },\n        findChoices : function(interaction, choices, inputType){\n\n            var ret = [], _this = this;\n\n            _.each(choices, function(c){\n                var choice;\n                if(_.isString(c)){\n                    if(inputType === 'serial'){\n                        choice = interaction.getChoice(c);\n                        if(choice){\n                            ret.push(choice);\n                        }\n                    }else if(inputType === 'identifier'){\n                        choice = interaction.getChoiceByIdentifier(c);\n                        if(choice){\n                            ret.push(choice);\n                        }\n                    }else{\n                        ret.push(c);\n                    }\n                }else if(_.isArray(c)){\n                    ret.push(_this.findChoices(interaction, c, inputType));\n                }else{\n                    ret.push(c);\n                }\n            });\n\n            return ret;\n        },\n        shuffleChoices : function(choices){\n            var r = [], //returned array\n                f = {}, //fixed choices array\n                j = 0;\n\n            for(var i in choices){\n                if(Element.isA(choices[i], 'choice')){\n                    var choice = choices[i];\n                    if(choice.attr('fixed')){\n                        f[j] = choice;\n                    }\n                    r.push(choice);\n                    j++;\n                }else{\n                    throw 'invalid element in array: is not a qti choice';\n                }\n            }\n\n            for(var n = 0; n < r.length - 1; n++){\n                if(f[n]){\n                    continue;\n                }\n                var k = -1;\n                do{\n                    k = n + Math.floor(Math.random() * (r.length - n));\n                }while(f[k]);\n                var tmp = r[k];\n                r[k] = r[n];\n                r[n] = tmp;\n            }\n\n            return r;\n        },\n        serialToIdentifier : function(interaction, choiceSerial){\n            var choice = interaction.getChoice(choiceSerial);\n            if(choice){\n                return choice.id();\n            }else{\n                return '';\n            }\n        }\n    }\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * A factory to create a QTI renderer.\n *\n * @author Sam Sipasseuth <sam@taotesting.com>\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiItem/qtiRunner/core/Renderer',[\n    'lodash',\n    'jquery',\n    'handlebars',\n    'core/promise',\n    'taoQtiItem/qtiItem/core/Element',\n    'taoQtiItem/qtiItem/helper/interactionHelper',\n    'ui/themeLoader'\n], function(_, $, Handlebars, Promise, Element, interactionHelper, themeLoader){\n    'use strict';\n\n    var _isValidRenderer = function(renderer){\n\n        var valid = true;\n\n        if(typeof (renderer) !== 'object'){\n            return false;\n        }\n\n        var classCorrect = false;\n        if(renderer.qtiClass){\n            if(_.indexOf(_renderableClasses, renderer.qtiClass) >= 0){\n                classCorrect = true;\n            }else{\n                var pos = renderer.qtiClass.indexOf('.');\n                if(pos > 0){\n                    var qtiClass = renderer.qtiClass.slice(0, pos);\n                    var subClass = renderer.qtiClass.slice(pos + 1);\n                    if(_renderableSubclasses[qtiClass] && _.indexOf(_renderableSubclasses[qtiClass], subClass) >= 0){\n                        classCorrect = true;\n                    }\n                }\n            }\n        }\n        if(!classCorrect){\n            valid = false;\n            throw new Error('invalid qti class name in renderer declaration : ' + renderer.qtiClass);\n        }\n\n        if(!renderer.template){\n            valid = false;\n            throw new Error('missing template in renderer declaration : ' + renderer.qtiClass);\n        }\n\n        return valid;\n    };\n\n    var _renderableClasses = [\n        '_container',\n        'assessmentItem',\n        'stylesheet',\n        'responseDeclaration',\n        'outcomeDeclaration',\n        'responseProcessing',\n        '_simpleFeedbackRule',\n        'img',\n        'math',\n        'object',\n        'modalFeedback',\n        'rubricBlock',\n        'associateInteraction',\n        'choiceInteraction',\n        'extendedTextInteraction',\n        'gapMatchInteraction',\n        'graphicAssociateInteraction',\n        'graphicGapMatchInteraction',\n        'graphicOrderInteraction',\n        'hotspotInteraction',\n        'hottextInteraction',\n        'inlineChoiceInteraction',\n        'matchInteraction',\n        'mediaInteraction',\n        'orderInteraction',\n        'selectPointInteraction',\n        'sliderInteraction',\n        'textEntryInteraction',\n        'uploadInteraction',\n        'endAttemptInteraction',\n        'customInteraction',\n        'prompt',\n        'associableHotspot',\n        'gap',\n        'gapImg',\n        'gapText',\n        'hotspotChoice',\n        'hottext',\n        'inlineChoice',\n        'simpleAssociableChoice',\n        'simpleChoice',\n        'infoControl',\n        'include'\n    ];\n\n    /**\n     * The list of qti element dependencies. It is used internally to load dependent qti classes\n     */\n    var _dependencies = {\n        assessmentItem : ['stylesheet', '_container', 'prompt', 'modalFeedback'],\n        rubricBlock : ['_container'],\n        associateInteraction : ['simpleAssociableChoice'],\n        choiceInteraction : ['simpleChoice'],\n        gapMatchInteraction : ['gap', 'gapText'],\n        graphicAssociateInteraction : ['associableHotspot'],\n        graphicGapMatchInteraction : ['associableHotspot', 'gapImg'],\n        graphicOrderInteraction : ['hotspotChoice'],\n        hotspotInteraction : ['hotspotChoice'],\n        hottextInteraction : ['hottext'],\n        inlineChoiceInteraction : ['inlineChoice'],\n        matchInteraction : ['simpleAssociableChoice'],\n        orderInteraction : ['simpleChoice']\n    };\n\n    /**\n     * The list of supported qti subclasses.\n     */\n    var _renderableSubclasses = {\n        'simpleAssociableChoice' : ['associateInteraction', 'matchInteraction'],\n        'simpleChoice' : ['choiceInteraction', 'orderInteraction']\n    };\n\n    /**\n     * List of the default properties for the item\n     */\n    var _defaults = {\n        shuffleChoices : true\n    };\n\n    /**\n     * Get the location of the document, useful to define a baseUrl for the required context\n     * @returns {String}\n     */\n    function getDocumentBaseUrl(){\n        return window.location.protocol + '//' + window.location.host + window.location.pathname.replace(/([^\\/]*)$/, '');\n    }\n\n    /**\n     * The built Renderer class\n     * @constructor\n     * @param {Object} [options] - the renderer options\n     * @param {AssetManager} [options.assetManager] - The renderer needs an AssetManager to resolve URLs (see {@link taoItems/assets/manager})\n     * @param {Boolean} [options.shuffleChoices = true] - Does the renderer take care of the shuffling\n     * @param {Object} [options.decorators] - to set up rendering decorator\n     * @param {preRenderDecorator} [options.decorators.before] - to set up a pre decorator\n     * @param {postRenderDecorator} [options.decorators.after] - to set up a post decorator\n     */\n    var Renderer = function(options){\n\n        /**\n         * Store the registered renderer location\n         */\n        var _locations = {};\n\n        /**\n         * Store loaded renderers\n         */\n        var _renderers = {};\n\n        options = _.defaults(options || {}, _defaults);\n\n        this.isRenderer = true;\n\n        this.name = '';\n\n        //store shuffled choice here\n        this.shuffledChoices = [];\n\n        /**\n         * Get the actual renderer of the give qti class or subclass:\n         * e.g. simplceChoice, simpleChoice.choiceInteraction, simpleChoice.orderInteraction\n         */\n        var _getClassRenderer = function(qtiClass){\n            var ret = null;\n            if(_renderers[qtiClass]){\n                ret = _renderers[qtiClass];\n            }else{\n                var pos = qtiClass.indexOf('.');\n                if(pos > 0){\n                    qtiClass = qtiClass.slice(0, pos);\n                    if(_renderers[qtiClass]){\n                        ret = _renderers[qtiClass];\n                    }\n                }\n            }\n            return ret;\n        };\n\n        /**\n         * Registers a QTI renderer class\n         * @param {String} qtiClass\n         * @param {Array} list\n         * @returns {Boolean} `true` if the class has been successfully registered\n         */\n        function registerRendererClass(qtiClass, list) {\n            var success = false;\n            if (_locations[qtiClass] === false) {\n                //mark this class as not renderable\n                _renderers[qtiClass] = false;\n                success = true;\n            } else if (_locations[qtiClass]) {\n                list.push(_locations[qtiClass]);\n                success = true;\n            }\n            return success;\n        }\n\n        /**\n         * Set the renderer options\n         * @param {String} key - the name of the option\n         * @param {*} value - the option vallue\n         * @returns {Renderer} for chaining\n         */\n        this.setOption = function(key, value){\n            if(typeof (key) === 'string'){\n                options[key] = value;\n            }\n            return this;\n        };\n\n        /**\n         * Set the renderer options\n         * @param {Object} opts - the options\n         * @returns {Renderer} for chaining\n         */\n        this.setOptions = function(opts){\n            options = _.extend(options, opts);\n            return this;\n        };\n\n        /**\n         * Get the renderer option\n         * @param {String} key - the name of the option\n         * @returns {*|null} the option vallue\n         */\n        this.getOption = function(key){\n            if(typeof (key) === 'string' && options[key]){\n                return options[key];\n            }\n            return null;\n        };\n\n        this.getCustomMessage = function getCustomMessage(elementName, messageKey){\n            var messages = this.getOption('messages');\n            if(messages &&\n                elementName &&\n                messages[elementName] &&\n                _.isString(messages[elementName][messageKey])){\n                //currently not translatable but potentially could be if the need raises\n                return Handlebars.compile(messages[elementName][messageKey]);\n            }else{\n                return null;\n            }\n        };\n\n        /**\n         * Get the bound assetManager\n         * @returns {AssetManager} the assetManager\n         */\n        this.getAssetManager = function getAssetManager(){\n            return options.assetManager;\n        };\n\n        /**\n         * Get the bound theme loader\n         * @returns {Object} the themeLoader\n         */\n        this.getThemeLoader = function getThemeLoader(){\n            return this.themeLoader;\n        };\n\n\n        /**\n         * Renders the template\n         * @param {Object} element - the QTI model element\n         * @param {Object} data - the data to give to the template\n         * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n         * @returns {String} the template results\n         * @throws {Error} if the renderer is not set or has no template bound\n         */\n        this.renderTpl = function(element, data, qtiSubclass){\n\n            var res;\n            var ret        = '';\n            var tplFound   = false;\n            var qtiClass   = qtiSubclass || element.qtiClass;\n            var renderer   = _getClassRenderer(qtiClass);\n            var decorators = this.getOption('decorators');\n\n            if(!renderer || !_.isFunction(renderer.template)){\n                throw new Error('no renderer template loaded under the class name : ' + qtiClass);\n            }\n\n            //pre rendering decoration\n            if(_.isObject(decorators) && _.isFunction(decorators.before)){\n\n                /**\n                 * @callback preRenderDecoractor\n                 * @param {Object} element - the QTI model element\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n                 * @returns {String} the decorator result\n                 */\n                res = decorators.before(element, qtiSubclass);\n                if(_.isString(res)){\n                    ret += res;\n                }\n            }\n\n            //render the template\n            ret += renderer.template(data);\n\n\n            //post rendering decoration\n            if(_.isObject(decorators) && _.isFunction(decorators.after)){\n\n                /**\n                 * @callback postRenderDecoractor\n                 * @param {Object} element - the QTI model element\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n                 * @returns {String} the decorator result\n                 */\n                res = decorators.after(element, qtiSubclass);\n                if(_.isString(res)){\n                    ret += res;\n                }\n            }\n            return ret;\n        };\n\n        this.getData = function(element, data, qtiSubclass){\n\n            var ret = data,\n                qtiClass = qtiSubclass || element.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.getData) === 'function'){\n                    ret = renderer.getData.call(this, element, data);\n                }\n            }\n\n            return ret;\n        };\n\n        this.renderDirect = function(tpl, data){\n            return Handlebars.compile(tpl)(data);\n        };\n\n        this.getContainer = function(qtiElement, $scope, qtiSubclass){\n\n            var ret = null,\n                qtiClass = qtiSubclass || qtiElement.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                ret = renderer.getContainer(qtiElement, $scope);\n            }else{\n                throw 'no renderer found for the class : ' + qtiElement.qtiClass;\n            }\n            return ret;\n        };\n\n        this.postRender = function(qtiElement, data, qtiSubclass){\n\n            var qtiClass = qtiSubclass || qtiElement.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer && typeof (renderer.render) === 'function') {\n                return renderer.render.call(this, qtiElement, data);\n            }\n        };\n\n        this.setResponse = function(qtiInteraction, response, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.setResponse) === 'function'){\n                    ret = renderer.setResponse.call(this, qtiInteraction, response);\n                    var $container = renderer.getContainer.call(this, qtiInteraction);\n                    if($container instanceof $ && $container.length){\n                        $container.trigger('responseSet', [qtiInteraction, response]);\n                    }\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.getResponse = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.getResponse) === 'function'){\n                    ret = renderer.getResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.resetResponse = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.resetResponse) === 'function'){\n                    ret = renderer.resetResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        /**\n         * Retrieve the state of the interaction.\n         * If the renderer has no state management, it falls back to the response management.\n         *\n         * @param {Object} qtiInteraction - the interaction\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\n         * @returns {Object} the interaction's state\n         *\n         * @throws {Error} if no renderer is registered\n         */\n        this.getState = function(qtiInteraction, qtiSubclass){\n\n            var ret = false;\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.getState)){\n                    ret = renderer.getState.call(this, qtiInteraction);\n                } else {\n                    ret = renderer.getResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        /**\n         * Retrieve the state of the interaction.\n         * If the renderer has no state management, it falls back to the response management.\n         *\n         * @param {Object} qtiInteraction - the interaction\n         * @param {Object} state - the interaction's state\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\n         *\n         * @throws {Error} if no renderer is found\n         */\n        this.setState =  function(qtiInteraction, state, qtiSubclass){\n\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.setState)){\n                    renderer.setState.call(this, qtiInteraction, state);\n                } else {\n                    renderer.resetResponse.call(this, qtiInteraction);\n                    renderer.setResponse.call(this, qtiInteraction, state);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n        };\n\n        /**\n         * Calls the renderer destroy.\n         * Ask the renderer to run destroy if exists.\n         *\n         * @throws {Error} if no renderer is found\n         */\n        this.destroy = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.destroy)){\n                    ret = renderer.destroy.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.getLoadedRenderers = function(){\n            return _renderers;\n        };\n\n        this.register = function(renderersLocations){\n            _.extend(_locations, renderersLocations);\n        };\n\n        this.load = function(callback, requiredClasses){\n           var self = this;\n            var required = [];\n\n            if(options.themes){\n\n                //resolve themes paths\n                options.themes.base = this.resolveUrl(options.themes.base);\n                _.forEach(options.themes.available, function(theme, index){\n                    options.themes.available[index].path = self.resolveUrl(theme.path);\n                });\n                this.themeLoader = themeLoader(options.themes).load();\n            }\n\n            if(requiredClasses){\n                if(_.isArray(requiredClasses)){\n\n                    //exclude abstract classes\n                    requiredClasses = _.intersection(requiredClasses, _renderableClasses);\n\n                    //add dependencies\n                    _.each(requiredClasses, function(reqClass){\n                        var deps = _dependencies[reqClass];\n                        if(deps){\n                            requiredClasses = _.union(requiredClasses, deps);\n                        }\n                    });\n\n                    _.forEach(requiredClasses, function(qtiClass){\n\n                        if(_renderableSubclasses[qtiClass]){\n                            var requiredSubClasses = _.intersection(requiredClasses, _renderableSubclasses[qtiClass]);\n                            _.each(requiredSubClasses, function(subclass){\n                                if (!registerRendererClass(qtiClass + '.' + subclass, required) && !registerRendererClass(qtiClass, required)) {\n                                    throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass + ', subclass: ' + subclass);\n                                }\n                            });\n                        } else {\n                            if (!registerRendererClass(qtiClass, required)) {\n                                throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass);\n                            }\n                        }\n                    });\n                } else {\n                    throw new Error('invalid argument type: expected array for arg \"requireClasses\"');\n                }\n\n            }else{\n                required = _.values(_locations);\n            }\n\n            var _this = this;\n            require(required, function(){\n\n                _.each(arguments, function(clazz){\n                    if(_isValidRenderer(clazz)){\n                        _renderers[clazz.qtiClass] = clazz;\n                    }\n                });\n\n                if(typeof (callback) === 'function'){\n                    callback.call(_this, _renderers);\n                }\n            });\n\n            return this;\n        };\n\n        /**\n         * Unload the renderer\n         */\n        this.unload = function unload(){\n            if(this.themeLoader){\n                themeLoader(options.themes).unload();\n            }\n            return this;\n        };\n\n        /**\n         * Define the shuffling manually\n         *\n         * @param {Object} interaction - the interaction\n         * @param {Array} choices - the shuffled choices\n         * @param {String} identificationType -\n         */\n        this.setShuffledChoices = function(interaction, choices, identificationType){\n            if(Element.isA(interaction, 'interaction')){\n                this.shuffledChoices[interaction.getSerial()] = _.pluck(interactionHelper.findChoices(interaction, choices, identificationType), 'serial');\n            }\n        };\n\n        /**\n         * Get the choices shuffled for this interaction.\n         *\n         * @param {Object} interaction - the interaction\n         * @param {Boolean} reshuffle - by default choices are shuffled only once and store, but if true you can force shuffling again\n         * @param {String} returnedType - the choice type\n         * @returns {Array} the choices\n         */\n        this.getShuffledChoices = function(interaction, reshuffle, returnedType){\n            var choices = [];\n            var shuffled = [];\n            var serial, i;\n\n            if(Element.isA(interaction, 'interaction')){\n                serial = interaction.getSerial();\n\n                //1st time, we shuffle (or asked to force shuffling)\n                if(!this.shuffledChoices[serial] || reshuffle){\n                    if(Element.isA(interaction, 'matchInteraction')){\n                        this.shuffledChoices[serial] = [];\n                        for(i = 0; i < 2; i++){\n                            choices[i] = interactionHelper.shuffleChoices(interaction.getChoices(i));\n                            this.shuffledChoices[serial][i] = _.pluck(choices[i], 'serial');\n                        }\n                    } else {\n                        choices = interactionHelper.shuffleChoices(interaction.getChoices());\n                        this.shuffledChoices[serial] = _.pluck(choices, 'serial');\n                    }\n\n                //otherwise get the choices from the serials\n                } else {\n                    if(Element.isA(interaction, 'matchInteraction')){\n                        _.forEach(choices, function(choice, index){\n                            if(index < 2){\n                                _.forEach(this.shuffledChoices[serial][i], function(choiceSerial){\n                                    choice.push(interaction.getChoice(choiceSerial));\n                                });\n                            }\n                        });\n                    } else {\n                        _.forEach(this.shuffledChoices[serial], function(choiceSerial){\n                            choices.push(interaction.getChoice(choiceSerial));\n                        });\n                    }\n                }\n\n                //do some type convertion\n                if(returnedType === 'serial' || returnedType === 'identifier'){\n                    return interactionHelper.convertChoices(choices, returnedType);\n                }\n\n                //pass value only, not ref\n                return _.clone(choices);\n            }\n\n            return [];\n        };\n\n        this.getRenderers = function(){\n            return _renderers;\n        };\n\n        this.getLocations = function(){\n            return _locations;\n        };\n\n        /**\n         * Resolve URLs using the defined assetManager's strategies\n         * @param {String} url - the URL to resolve\n         * @returns {String} the resolved URL\n         */\n        this.resolveUrl = function resolveUrl(url){\n            if(!options.assetManager){\n                return url;\n            }\n            if(typeof url === 'string' && url.length > 0){\n                return options.assetManager.resolve(url);\n            }\n        };\n\n        /**\n         * @deprecated in favor of resolveUrl\n         */\n        this.getAbsoluteUrl = function(relUrl){\n\n            //let until method is removed\n            console.warn('DEPRECATED used getAbsoluteUrl with ', arguments);\n\n            //allow relative url output only if explicitely said so\n            if(this.getOption('userRelativeUrl')){\n                return relUrl.replace(/^\\.?\\//, '');\n            }\n\n            if(/^http(s)?:\\/\\//i.test(relUrl) || /^data:[^\\/]+\\/[^;]+(;charset=[\\w]+)?;base64,/.test(relUrl)){\n                //already absolute or base64 encoded\n                return relUrl;\n            }else{\n\n                var absUrl = '';\n                var runtimeLocations = this.getOption('runtimeLocations');\n\n                if(runtimeLocations && _.size(runtimeLocations)){\n                    _.forIn(runtimeLocations, function(runtimeLocation, typeIdentifier){\n                        if(relUrl.indexOf(typeIdentifier) === 0){\n                            absUrl = relUrl.replace(typeIdentifier, runtimeLocation);\n                            return false;//break\n                        }\n                    });\n                }\n\n                if(absUrl){\n                    return absUrl;\n                }else{\n                    var baseUrl = this.getOption('baseUrl') || getDocumentBaseUrl();\n                    return baseUrl + relUrl;\n                }\n\n            }\n        };\n    };\n\n    /**\n     * Expose the renderer's factory\n     * @exports taoQtiItem/qtiRunner/core/Renderer\n     */\n    return {\n\n        /**\n         * Creates a new Renderer by extending the Renderer's prototype\n         * @param {Object} renderersLocations -\n         * @param {String} [name] - the new renderer name\n         * @param {Object} [defaultOptions] - the renderer options\n         */\n        build : function(renderersLocations, name, defaultOptions){\n            var NewRenderer = function(){\n                var options = _.isPlainObject(arguments[0]) ? arguments[0] : {};\n\n                Renderer.apply(this);\n\n                this.register(renderersLocations);\n                this.name = name || '';\n                this.setOptions(_.defaults(options, defaultOptions || {}));\n            };\n            NewRenderer.prototype = Renderer.prototype;\n            return NewRenderer;\n        }\n    };\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n * The asset manager proposes you to resolve your asset URLs for you!\n * You need to add the resolution strategies, it will then evaluate each strategy until the right one is found\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoItems/assets/manager',[\n    'lodash',\n    'util/url'\n], function(_, urlUtil){\n    'use strict';\n\n    /**\n     * @typedef AssetStrategy Defines a way to resolve an asset path\n     * @property {String} name - the strategy name\n     * @property {assetStrategyHandle} handle - how to resolve the strategy.\n     */\n\n    /**\n     * @callback assetStrategyHandle\n     * @param {String|Object} url - the URL to resolved. If parseUrl, it's an object that contains host, port, search, queryString, etc.\n     * @param {Object} data - the context data\n     * @returns {String?} falsy if not resolved otherwise the resolved URL\n     */\n\n\n    /**\n     * The assetManagerFactory create a new assetManager with the given resolution stratgies and a data context.\n     *\n     * @example\n     *   //define AssetStrategies with a name and a handle method\n     *   var strategies = [{\n     *       name : 'external',\n     *       handle : function(url, data){\n     *           if(/^http/.test(url)){\n     *               return path;\n     *           }\n     *       }\n     *   }, {\n     *       name : 'relative',\n     *       handle : function(url, data){\n     *           if(/^((\\.\\/)|(\\w\\/))/){\n     *               return data.baseUrl + '/' + url ;\n     *           }\n     *       }\n     *   }]);\n     *\n     *   var assetManager = assetManagerFactory(strategies, { baseUrl : 'http://t.oa/public/assets/' });\n     *   assetManager.resolve('http://foo/bar.png'); //will resolved using external\n     *   assetManager.resolve('bar.png'); //will resolved using relative strategy\n     *\n     * @param {AssetStrategy[]} strategies - the strategies\n     * @param {Object} data - the context data\n     * @param {Object} [options] - the manager options\n     * @param {Boolean} [options.parseUrl = true] - If the URL to give to the stragies should be parsed or given as it is.\n     * @param {Boolean} [options.cache] - resolve the same URL only once and store the result in memory.\n     *\n     * @exports taoItems/assets/manager\n     * @namespace assetManagerFactory\n     */\n    var assetManagerFactory = function assetManagerFactory(strategies, data, options) {\n\n        var cache  = {};\n\n        strategies = _.isArray(strategies) ? strategies : [strategies];\n        data       = data || {};\n        options    = _.defaults(options || {}, {\n            parseUrl : true\n        });\n\n        /**\n         * A brand new asset manager is created by the factory\n         */\n        var assetManager = {\n\n            /**\n             * The stack of strategies that would be used to resolve the asset path\n             * @type {AssetStrategy[]}\n             */\n            _strategies : [],\n\n            /**\n             * Add an asset resolution strategy.\n             * The strategies will be evaluated in the order they've been added.\n             * @param {AssetStrategy} strategy - the strategy to add\n             * @throws {TypeError} if the strategy isn't defined correctly\n             */\n            addStrategy : function addStrategy (strategy){\n\n                if(!_.isPlainObject(strategy) || !_.isFunction(strategy.handle) || !_.isString(strategy.name)){\n                    throw new TypeError('An asset resolution strategy is an object with a handle method and a name');\n                }\n\n                this._strategies.push(strategy);\n            },\n\n            /**\n             * Change the strategies\n             * @param {AssetStrategy[]} strategies - the strategies\n             * @throws {TypeError} if the strategy isn't defined correctly\n             */\n            setStrategies : function setStrategies(newStrategies){\n                var self = this;\n\n                this._strategies = [];\n\n                //assign the strategies to the assetManager\n                _.forEach(newStrategies, function(strategy){\n\n                    //if it's an object we add it directly\n                    if(_.isPlainObject(strategy)){\n                        assetManager.addStrategy(strategy);\n\n                    //if it's a function, we create the strategy with a generated name\n                    } else if(_.isFunction(strategy)){\n                        self.addStrategy({\n                            name   : 'strategy_' + (self._strategies.length + 1),\n                            handle : strategy\n                        });\n                    }\n                });\n            },\n\n            /**\n             * Set context data\n             * @param {String|Object} [key] - the key of the data to set or the data values if it's an object\n             * @param {*} [value] - the value to set if a key is given\n             */\n            setData : function setData(key, value){\n                if(_.isString(key) && typeof value !== 'undefined'){\n                    data[key] = value;\n                } else if(_.isPlainObject(key)){\n                    data = key;\n                }\n            },\n\n            /**\n             * Get context data\n             * @param {String} [key] - if we want the value of a particuar key\n             * @returns {Object|*} all the data or the proprety value if key is given\n             */\n            getData : function getData(key){\n                if(_.isString(key)){\n                    return data[key];\n                }\n                return data;\n            },\n\n            /**\n             * Resolve the given URL against the strategies\n             * @param {String} url - the URL to resolve\n             * @returns {String?} the resolved URL or nothing\n             */\n            resolve : function resolve(url){\n                var resolved;\n                var inputUrl;\n\n                //if caching try to load the value from the cache\n                if(options.cache && cache.hasOwnProperty(url)){\n                    return cache[url];\n                }\n\n                //parse the url ?\n                inputUrl = options.parseUrl ? urlUtil.parse(url) : url;\n\n                //call strategies handlers, in their order until once returns somethin\n                _.forEach(this._strategies, function(strategy){\n                    var result = strategy.handle(inputUrl, data);\n                    if(result){\n                        resolved = result;\n                        return false;\n                    }\n                });\n\n                resolved = resolved || '';\n\n                if(options.cache){\n                    cache[url] = resolved;\n                }\n\n                return resolved;\n            },\n\n            /**\n             * Resolve the given URL against the strategy identified by the given name\n             * @param {String} name - the strategy name\n             * @param {String} url - the URL to resolve\n             * @returns {String?} the resolved URL or nothing\n             */\n            resolveBy : function resolveBy(name, url){\n                var inputUrl;\n                var resolved = '';\n                var strategy = _.find(this._strategies, {name : name});\n                if(strategy){\n                    //parse the url ?\n                    inputUrl = options.parseUrl ? urlUtil.parse(url) : url;\n                    resolved = strategy.handle(inputUrl, data);\n                }\n                return resolved;\n            },\n\n            /**\n             * When the cache is used, it could be useful to clear the cache\n             */\n            clearCache : function clearCache(){\n                if(options.cache){\n                    cache = {};\n                }\n            }\n        };\n\n        assetManager.setStrategies(strategies);\n\n        return assetManager;\n    };\n\n    return assetManagerFactory;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n * Provides common strategies to resolved assets\n * that may be used by any type of items.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoItems/assets/strategies',[\n    'util/url'\n], function(urlUtil){\n    'use strict';\n\n    /**\n     * Prepend a base to an URL\n     * @param {Object} url - a parsed URL\n     * @param {String} base - the base to prepend\n     * @param {Boolean} [slashcat = false] - remove dots, double slashes, etc.\n     * @returns {String} the URL\n     */\n    var prependToUrl = function prependToUrl(url, base, slashcat){\n\n        //is slashcat we manage slash concact\n        if(slashcat === true){\n            return base.replace(/\\/$/, '') + '/' + url.directory.replace(/^\\.\\//, '').replace(/^\\//, '')\n                + encodeURIComponent(url.file.replace(/^\\.\\//, '').replace(/^\\//, ''));\n        }\n\n        return base + url.directory.replace(/^\\.?\\//, '') + encodeURIComponent(url.file.replace(/^\\.?\\//, ''));\n    };\n\n    /**\n     * Unrelated strategies accessible by there name.\n     * Remember to not use the whole object, but each one in an array since the order matters.\n     *\n     * @exports taoItems/assets/strategies\n     */\n    var strategies = {\n\n        //the baseUrl concats the baseUrl in data if the url is relative\n        baseUrl : {\n            name : 'baseUrl',\n            handle : function handleBaseUrl(url, data){\n                if(typeof data.baseUrl === 'string' && (urlUtil.isRelative(url)) ){\n                    return prependToUrl(url, data.baseUrl, data.slashcat);\n                }\n            }\n        },\n\n        //bust the cache for item CSS\n        itemCssNoCache : {\n            name : 'itemCssNoCache',\n            handle : function handleItemCss(url, data){\n                if(typeof data.baseUrl === 'string' && (urlUtil.isRelative(url)) && /\\.css$/.test(url.file)) {\n                    return urlUtil.build(prependToUrl(url, data.baseUrl, data.slashcat), { bust : Date.now() });\n                }\n            }\n        },\n\n        //absolute URL are just left intact\n        external : {\n            name : 'external',\n            handle : function handleExternal(url){\n                if(urlUtil.isAbsolute(url)){\n                    return url.toString();\n                }\n            }\n        },\n\n        //the base64 encoded resources are also left intact\n        base64 : {\n            name : 'base64',\n            handle : function handleB64(url){\n                if(urlUtil.isBase64(url)){\n                    return url.toString();\n                }\n            }\n        },\n\n        //special tao media protocol\n        taomedia : {\n            name : 'taomedia',\n            handle : function handleTaoMedia(url, data){\n                //either a baseUrl is given or if empty, taomedia resources are managed as relative resources\n                var baseUrl = data.baseUrl || './';\n                if( (typeof url === 'object' && url.protocol === 'taomedia') ||\n                    (/^taomedia:\\/\\//.test(url.toString())) ){\n                    return baseUrl + url.toString();\n                }\n            }\n        }\n    };\n    return strategies;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n *\n */\ndefine('taoQtiItem/portableElementRegistry/factory/factory',['lodash', 'core/promise', 'core/eventifier'], function (_, Promise, eventifier){\n    'use strict';\n\n    var _requirejs = window.require;\n\n    return function portableElementRegistry(methods){\n\n        var _loaded = false;\n        var __providers = {};\n\n        return eventifier(_.defaults(methods || {}, {\n            _registry : {},\n            get : function get(typeIdentifier, version){\n\n                if(this._registry[typeIdentifier]){\n                    //check version\n                    if(version){\n                        return _.find(this._registry[typeIdentifier], version);\n                    }else{\n                        //latest\n                        return _.last(this._registry[typeIdentifier]);\n                    }\n                }\n            },\n            registerProvider : function registerProvider(moduleName){\n                __providers[moduleName] = null;\n                return this;\n            },\n            resetProviders : function resetProviders(){\n                __providers = {};\n                return this;\n            },\n            loadProviders : function loadProviders(){\n                var self = this;\n                return new Promise(function(resolve, reject) {\n                    var providerLoadingStack = [];\n                    _.forIn(__providers, function(provider, id){\n                        if(provider === null){\n                            providerLoadingStack.push(id);\n                        }\n                    });\n                    _requirejs(providerLoadingStack, function(){\n                        _.each([].slice.call(arguments), function(provider){\n                            if(provider && _.isFunction(provider.load)){\n                                __providers[providerLoadingStack.shift()] = provider;\n                            }\n                        });\n                        resolve();\n                        self.trigger('providersloaded');\n                    }, reject);\n                });\n            },\n            getAllVersions : function getAllVersions(){\n                var all = {};\n                _.forIn(this._registry, function (versions, id){\n                    all[id] = _.map(versions, 'version');\n                });\n                return all;\n            },\n            getRuntime : function getRuntime(typeIdentifier, version){\n                var pci = this.get(typeIdentifier, version);\n                if(pci){\n                    return _.assign(pci.runtime, {\n                        id : pci.typeIdentifier,\n                        label : pci.label,\n                        baseUrl : pci.baseUrl\n                    });\n                }else{\n                    this.trigger('error', {\n                        message : 'no portable element runtime found',\n                        typeIdentifier : typeIdentifier,\n                        version : version\n                    });\n                }\n            },\n            getCreator : function getCreator(typeIdentifier, version){\n                var pci = this.get(typeIdentifier, version);\n                if(pci && pci.creator){\n                    return _.assign(pci.creator, {\n                        id : pci.typeIdentifier,\n                        label : pci.label,\n                        baseUrl : pci.baseUrl,\n                        response : pci.response\n                    });\n                }else{\n                    this.trigger('error', {\n                        message : 'no portable element runtime found',\n                        typeIdentifier : typeIdentifier,\n                        version : version\n                    });\n                }\n            },\n            getBaseUrl : function getBaseUrl(typeIdentifier, version){\n                var runtime = this.get(typeIdentifier, version);\n                if(runtime){\n                    return runtime.baseUrl;\n                }\n                return '';\n            },\n            loadRuntimes : function loadRuntimes(reload){\n                var self = this;\n                var loadPromise;\n                if(_loaded && !reload){\n                    loadPromise = Promise.resolve();\n                } else {\n                    loadPromise = self.loadProviders().then(function(){\n\n                        var loadStack = [];\n\n                        _.each(__providers, function (provider){\n                            if(provider){//check that the provider is loaded\n                                loadStack.push(provider.load());\n                            }\n                        });\n\n                        //performs the loadings in parallel\n                        return Promise.all(loadStack).then(function (results){\n\n                            var requireConfigAliases = {};\n\n                            //update registry\n                            self._registry = _.reduce(results, function (acc, _pcis){\n                                return _.merge(acc, _pcis);\n                            }, {});\n\n                            //pre-configuring the baseUrl of the portable element's source\n                            _.forIn(self._registry, function (versions, typeIdentifier){\n                                //currently use latest runtime path\n                                requireConfigAliases[typeIdentifier] = self.getBaseUrl(typeIdentifier);\n                            });\n                            _requirejs.config({paths : requireConfigAliases});\n\n                            _loaded = true;\n                        });\n                    });\n                }\n\n                loadPromise\n                    .then(function() {\n                        self.trigger('runtimesloaded');\n                    })\n                    .catch(function(err) {\n                        self.trigger('error', err);\n                    });\n\n                return loadPromise;\n            },\n            loadCreators : function loadCreators(reload){\n\n                var self = this;\n\n                var loadPromise = self.loadRuntimes(reload).then(function(){\n                    var requiredCreators = [];\n\n                    _.forIn(self._registry, function (versions, typeIdentifier){\n                        var pciModel = self.get(typeIdentifier);//currently use the latest version only\n                        if(pciModel.creator && pciModel.creator.hook){\n                            requiredCreators.push(pciModel.creator.hook.replace(/\\.js$/, ''));\n                        }\n                    });\n\n                    if(requiredCreators.length){\n                        return new Promise(function(resolve, reject){\n                            //@todo support caching?\n                            _requirejs(requiredCreators, function (){\n                                var creators = {};\n                                _.each(arguments, function (creatorHook){\n                                    var id = creatorHook.getTypeIdentifier();\n                                    var pciModel = self.get(id);\n                                    var i = _.findIndex(self._registry[id], {version : pciModel.version});\n                                    if(i < 0){\n                                        self.trigger('error', 'no creator found for id/version ' + id + '/' + pciModel.version);\n                                    }else{\n                                        self._registry[id][i].creator.module = creatorHook;\n                                        creators[id] = creatorHook;\n                                    }\n                                });\n                                resolve(creators);\n                            }, reject);\n                        });\n                    }else{\n                        return Promise.resolve({});\n                    }\n\n                });\n\n                loadPromise\n                    .then(function(creators) {\n                        self.trigger('creatorsloaded', creators);\n                        return creators;\n                    })\n                    .catch(function(err) {\n                        self.trigger('error', err);\n                    });\n\n                return loadPromise;\n            }\n        }));\n    }\n});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Sam <sams@taotesting.com>\n * @requires jquery\n * @requires lodash\n */\ndefine('taoQtiItem/qtiCreator/helper/qtiElements',['jquery', 'lodash', 'i18n'], function($, _, __){\n    \"use strict\";\n\n    var QtiElements = {};\n\n    QtiElements.classes = {\n        //abstract classes:\n        'itemBody' : {'parents' : ['bodyElement'], 'contains' : ['block'], 'abstract' : true},\n        'atomicBlock' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['inline'], 'abstract' : true},\n        'atomicInline' : {'parents' : ['bodyElement', 'flowStatic', 'inlineStatic'], 'contains' : ['inline'], 'abstract' : true},\n        'simpleBlock' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['block'], 'abstract' : true},\n        'simpleInline' : {'parents' : ['bodyElement', 'flowStatic', 'inlineStatic'], 'contains' : ['inline'], 'abstract' : true},\n        'flowStatic' : {'parents' : ['flow'], 'abstract' : true},\n        'blockStatic' : {'parents' : ['block'], 'abstract' : true},\n        'inlineStatic' : {'parents' : ['inline'], 'abstract' : true},\n        'flow' : {'parents' : ['objectFlow'], 'abstract' : true},\n        'tableCell' : {'parents' : ['bodyElement'], 'contains' : ['flow'], 'abstract' : true},\n        //html-derived qti elements:\n        'caption' : {'parents' : ['bodyElement'], 'contains' : ['inline'], 'xhtml' : true},\n        'col' : {'parents' : ['bodyElement'], 'xhtml' : true},\n        'colgroup' : {'parents' : ['bodyElement'], 'contains' : ['col'], 'xhtml' : true},\n        'div' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['flow'], 'xhtml' : true},\n        'dl' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['dlElement'], 'xhtml' : true},\n        'dt' : {'parents' : ['dlElement'], 'contains' : ['inline'], 'xhtml' : true},\n        'dd' : {'parents' : ['dlElement'], 'contains' : ['flow'], 'xhtml' : true},\n        'hr' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'xhtml' : true},\n        'math' : {'parents' : ['blockStatic', 'flowStatic', 'inlineStatic'], 'xhtml' : true},\n        'li' : {'parents' : ['bodyElement'], 'contains' : ['flow'], 'xhtml' : true},\n        'ol' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['li'], 'xhtml' : true},\n        'ul' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['li'], 'xhtml' : true},\n        'object' : {'parents' : ['bodyElement', 'flowStatic', 'inlineStatic'], 'contains' : ['objectFlow'], 'xhtml' : true},\n        'param' : {'parents' : ['objectFlow'], 'xhtml' : true},\n        'table' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['caption', 'col', 'colgroup', 'thead', 'tfoot', 'tbody'], 'xhtml' : true},\n        'tbody' : {'parents' : ['bodyElement'], 'contains' : ['tr'], 'xhtml' : true},\n        'tfoot' : {'parents' : ['bodyElement'], 'contains' : ['tr'], 'xhtml' : true},\n        'thead' : {'parents' : ['bodyElement'], 'contains' : ['tr'], 'xhtml' : true},\n        'td' : {'parents' : ['tableCell'], 'xhtml' : true},\n        'th' : {'parents' : ['tableCell'], 'xhtml' : true},\n        'tr' : {'parents' : ['bodyElement'], 'contains' : ['tableCell'], 'xhtml' : true},\n        'a' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'abbr' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'acronym' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'b' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'big' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'cite' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'code' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'dfn' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'em' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'i' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'kbd' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'q' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'samp' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'small' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'span' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'strong' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'sub' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'sup' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'tt' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'var' : {'parents' : ['simpleInline'], 'xhtml' : true},\n        'blockquote' : {'parents' : ['simpleBlock'], 'xhtml' : true},\n        'address' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'h1' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'h2' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'h3' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'h4' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'h5' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'h6' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'p' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'pre' : {'parents' : ['atomicBlock'], 'xhtml' : true},\n        'img' : {'parents' : ['atomicInline'], 'xhtml' : true, attributes : ['src', 'alt', 'longdesc', 'height', 'width']},\n        'br' : {'parents' : ['atomicInline'], 'xhtml' : true},\n        //qti elements:\n        'infoControl' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'qti' : true},\n        'textRun' : {'parents' : ['inlineStatic', 'flowstatic'], 'qti' : true},\n        'feedbackInline' : {'parents' : ['simpleInline', 'feedbackElement'], 'qti' : true},\n        'feedbackBlock' : {'parents' : ['simpleBlock'], 'qti' : true},\n        'rubricBlock' : {'parents' : ['simpleBlock'], 'qti' : true}, //strange qti 2.1 exception, marked as simpleBlock instead of\n        'blockInteraction' : {'parents' : ['block', 'flow', 'interaction'], 'qti' : true},\n        'inlineInteraction' : {'parents' : ['inline', 'flow', 'interaction'], 'qti' : true},\n        'gap' : {'parents' : ['inlineStatic'], 'qti' : true},\n        'hottext' : {'parents' : ['flowstatic', 'inlineStatic'], 'contains' : ['inlineStatic'], 'qti' : true},\n        'printedVariable' : {'parents' : ['bodyElement', 'flowStatic', 'inlineStatic', 'textOrVariable'], 'qti' : true},\n        'prompt' : {'parents' : ['bodyElement'], 'contains' : ['inlineStatic'], 'qti' : true},\n        'templateElement' : {'parents' : ['bodyElement'], 'qti' : true},\n        'templateBlock' : {'parents' : ['blockStatic', 'flowStatic', 'templateElement'], 'contains' : ['blockStatic'], 'qti' : true},\n        'templateInline' : {'parents' : ['inlineStatic', 'flowStatic', 'templateElement'], 'contains' : ['inlineStatic'], 'qti' : true},\n        'choiceInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'associateInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'orderInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'matchInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'hottextInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'gapMatchInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'mediaInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'sliderInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'uploadInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'drawingInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'graphicInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\n        'hotspotInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\n        'graphicAssociateInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\n        'graphicOrderInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\n        'graphicGapMatchInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\n        'selectPointInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\n        'textEntryInteraction' : {'parents' : ['stringInteraction', 'inlineInteraction'], 'qti' : true},\n        'extendedTextInteraction' : {'parents' : ['stringInteraction', 'blockInteraction'], 'qti' : true},\n        'inlineChoiceInteraction' : {'parents' : ['inlineInteraction'], 'qti' : true},\n        'endAttemptInteraction' : {'parents' : ['inlineInteraction'], 'qti' : true},\n        'customInteraction' : {'parents' : ['block', 'flow', 'interaction'], 'qti' : true},\n        '_container' : {'parents' : ['block'], 'qti' : true}//a pseudo class introduced in TAO\n    };\n\n    QtiElements.cache = {containable : {}, children : {}, parents : {}};\n\n    QtiElements.getAllowedContainersElements = function(qtiClass, $container){\n        var classes = QtiElements.getAllowedContainers(qtiClass);\n        var jqSelector = '';\n        for(var i in classes){\n            if(!classes[i].qti){\n                //html element:\n                jqSelector += classes[i] + ', ';\n            }\n        }\n\n        if(jqSelector){\n            jqSelector = jqSelector.substring(0, jqSelector.length - 2);\n        }\n\n        return $(jqSelector, $container ? $container : $(document)).filter(':not([data-qti-type])');\n    };\n\n    QtiElements.getAllowedContainers = function(qtiClass){\n        var ret;\n        if(QtiElements.cache.containable[qtiClass]){\n            ret = QtiElements.cache.containable[qtiClass];\n        }else{\n            ret = [];\n            var parents = QtiElements.getParentClasses(qtiClass, true);\n            for(var aClass in QtiElements.classes){\n                var model = QtiElements.classes[aClass];\n                if(model.contains){\n                    var intersect = _.intersection(model.contains, parents);\n                    if(intersect.length){\n                        if(!model.abstract){\n                            ret.push(aClass);\n                        }\n                        ret = _.union(ret, QtiElements.getChildClasses(aClass, true));\n                    }\n                }\n            }\n            QtiElements.cache.containable[qtiClass] = ret;\n        }\n\n        return ret;\n    };\n\n    QtiElements.getAllowedContents = function(qtiClass, recursive, checked){\n\n        var ret = [];\n        checked = checked || {};\n\n        var model = QtiElements.classes[qtiClass];\n        if(model && model.contains){\n            for(var i in model.contains){\n                var contain = model.contains[i];\n                if(!checked[contain]){\n                    checked[contain] = true;\n\n                    //qtiClass can contain everything defined as its contents\n                    ret.push(contain);\n\n                    //qtiClass can also contain subclass of its contents\n                    var children = QtiElements.getChildClasses(contain, true);\n                    for(var i in children){\n                        var child = children[i];\n                        if(!checked[child]){\n                            checked[child] = true;\n\n                            ret.push(child);\n\n                            //adding children allowed contents depends on the option \"recursive\"\n                            if(recursive){\n                                ret = _.union(ret, QtiElements.getAllowedContents(child, true, checked));\n                            }\n                        }\n                    }\n\n                    //adding allowed contents of qtiClass' allowed contents depends on the option \"recursive\"\n                    if(recursive){\n                        ret = _.union(ret, QtiElements.getAllowedContents(contain, true, checked));\n                    }\n\n                }\n            }\n        }\n\n        //qtiClass can contain all allowed contents of its parents:\n        var parents = QtiElements.getParentClasses(qtiClass, true);\n        for(var i in parents){\n            ret = _.union(ret, QtiElements.getAllowedContents(parents[i], recursive, checked));\n        }\n\n        return _.uniq(ret, false);\n    };\n\n    QtiElements.isAllowedClass = function(qtiContainerClass, qtiContentClass){\n        var allowedClasses = QtiElements.getAllowedContents(qtiContainerClass);\n        return (_.indexOf(allowedClasses, qtiContentClass) >= 0);\n    };\n\n    QtiElements.getParentClasses = function(qtiClass, recursive){\n        var ret;\n        if(recursive && QtiElements.cache.parents[qtiClass]){\n            ret = QtiElements.cache.parents[qtiClass];\n        }else{\n            ret = [];\n            if(QtiElements.classes[qtiClass]){\n                ret = QtiElements.classes[qtiClass].parents;\n                if(recursive){\n                    for(var i in ret){\n                        ret = _.union(ret, QtiElements.getParentClasses(ret[i], recursive));\n                    }\n                    ret = _.uniq(ret, false);\n                }\n            }\n            QtiElements.cache.parents[qtiClass] = ret;\n        }\n\n        return ret;\n    };\n\n    QtiElements.getChildClasses = function(qtiClass, recursive, type){\n        var ret;\n        var cacheType = type ? type : 'all';\n        if(recursive && QtiElements.cache.children[qtiClass] && QtiElements.cache.children[qtiClass][cacheType]){\n            ret = QtiElements.cache.children[qtiClass][cacheType];\n        }else{\n            ret = [];\n            for(var aClass in QtiElements.classes){\n                var model = QtiElements.classes[aClass];\n                if(_.indexOf(model.parents, qtiClass) >= 0){\n                    if(type){\n                        if(model[type]){\n                            ret.push(aClass);\n                        }\n                    }else{\n                        ret.push(aClass);\n                    }\n                    if(recursive){\n                        ret = _.union(ret, QtiElements.getChildClasses(aClass, recursive, type));\n                    }\n                }\n            }\n            if(!QtiElements.cache.children[qtiClass]){\n                QtiElements.cache.children[qtiClass] = {};\n            }\n            QtiElements.cache.children[qtiClass][cacheType] = ret;\n        }\n\n        return ret;\n    };\n\n    QtiElements.isBlock = function(qtiClass){\n        return QtiElements.is(qtiClass, 'block');\n    };\n\n    QtiElements.isInline = function(qtiClass){\n        return QtiElements.is(qtiClass, 'inline');\n    };\n\n    QtiElements.is = function(qtiClass, topClass){\n        if(qtiClass === topClass){\n            return true;\n        }else{\n            var parents = QtiElements.getParentClasses(qtiClass, true);\n            return (_.indexOf(parents, topClass) >= 0);\n        }\n    };\n\n    QtiElements.getAvailableAuthoringElements = function(){\n\n        return {\n            choiceInteraction : {\n                label : __('Choice Interaction'),\n                description : __('Select a single (radio buttons) or multiple (check boxes) responses among a set of choices.'),\n                icon : 'icon-choice',\n                short : __('Choice'),\n                qtiClass : 'choiceInteraction',\n                tags:['Common Interactions', 'mcq']\n            },\n            orderInteraction : {\n                label : __('Order Interaction'),\n                icon : 'icon-order',\n                description : __('Arrange a list of choices in the correct order.'),\n                short : __('Order'),\n                qtiClass : 'orderInteraction',\n                tags:['Common Interactions', 'ordering']\n            },\n            associateInteraction : {\n                label : __('Associate Interaction'),\n                icon : 'icon-associate',\n                description : __('Create pair(s) from a series of choices.'),\n                short : __('Associate'),\n                qtiClass : 'associateInteraction',\n                tags:['Common Interactions', 'association']\n            },\n            matchInteraction : {\n                label : __('Match Interaction'),\n                icon : 'icon-match',\n                description : __('Create association(s) between two sets of choices displayed in a table (row and column).'),\n                short : __('Match'),\n                qtiClass : 'matchInteraction',\n                tags:['Common Interactions', 'association']\n            },\n            hottextInteraction : {\n                label : __('Hottext Interaction'),\n                icon : 'icon-hottext',\n                description : __('Select one or more text parts (hottext) within a text.'),\n                short : __('Hottext'),\n                qtiClass : 'hottextInteraction',\n                tags:['Common Interactions', 'text']\n            },\n            gapMatchInteraction : {\n                label : __('Gap Match Interaction'),\n                icon : 'icon-gap-match',\n                description : __(' Fill in the gaps in a text from a set of choices.'),\n                short : __('Gap Match'),\n                qtiClass : 'gapMatchInteraction',\n                tags:['Common Interactions', 'text', 'association']\n            },\n            sliderInteraction : {\n                label : __('Slider Interaction'),\n                icon : 'icon-slider',\n                description :__('Select a value within a numerical range.'),\n                short : __('Slider'),\n                qtiClass : 'sliderInteraction',\n                tags:['Common Interactions', 'special']\n            },\n            extendedTextInteraction : {\n                label : __('Extended Text Interaction'),\n                icon : 'icon-extended-text',\n                description : __('Collect open-ended information in one or more text area(s) (strings or numeric values).'),\n                short : __('Extended Text'),\n                qtiClass : 'extendedTextInteraction',\n                tags:['Common Interactions', 'text']\n            },\n            uploadInteraction : {\n                label : __('File Upload Interaction'),\n                icon : 'icon-upload',\n                description : __('Upload a file (e.g. document, picture...) as a response.'),\n                short : __('File Upload'),\n                qtiClass : 'uploadInteraction',\n                tags:['Common Interactions', 'special']\n            },\n            mediaInteraction : {\n                label : __('Media Interaction'),\n                icon : 'icon-media',\n                description : __('Control the playing parameters (auto-start, loop) of a video or audio file and report the number of time it has been played.'),\n                short : __('Media'),\n                qtiClass : 'mediaInteraction',\n                tags:['Common Interactions', 'media']\n            },\n            _container : {\n                label : __('Text Block'),\n                icon : 'icon-font',\n                description : __('Block contains the content (stimulus) of the item such as text or image. It is also required for Inline Interactions.'),\n                short : __('Block'),\n                qtiClass : '_container',\n                tags:['Inline Interactions', 'text']\n            },\n            inlineChoiceInteraction : {\n                label : __('Inline Choice Interaction'),\n                icon : 'icon-inline-choice',\n                description : __('Select a choice from a drop-down list.'),\n                short : __('Inline Choice'),\n                qtiClass : 'inlineChoiceInteraction',\n                tags:['Inline Interactions', 'inline-interactions', 'mcq']\n            },\n            textEntryInteraction : {\n                label : __('Text Entry Interaction'),\n                icon : 'icon-text-entry',\n                description : __('Collect open-ended information in a short text input (strings or numeric values).'),\n                short : __('Text Entry'),\n                qtiClass : 'textEntryInteraction',\n                tags:['Inline Interactions', 'inline-interactions', 'text']\n            },\n            endAttemptInteraction : {\n                label : __('End Attempt Interaction'),\n                icon : 'icon-end-attempt',\n                description : __('Trigger the end of the item attempt.'),\n                short : __('End Attempt'),\n                qtiClass : 'endAttemptInteraction',\n                tags:['Inline Interactions', 'inline-interactions', 'button', 'submit']\n            },\n            hotspotInteraction : {\n                label : __('Hotspot Interaction'),\n                icon : 'icon-hotspot',\n                description : __('Select one or more areas (hotspots) displayed on an picture.'),\n                short : __('Hotspot'),\n                qtiClass : 'hotspotInteraction',\n                tags:['Graphic Interactions', 'mcq']\n            },\n            graphicOrderInteraction : {\n                label : __('Graphic Order Interaction'),\n                icon : 'icon-graphic-order',\n                description : __('Order the areas (hotspots) displayed on a picture.'),\n                short : __('Order'),\n                qtiClass : 'graphicOrderInteraction',\n                tags:['Graphic Interactions', 'ordering']\n            },\n            graphicAssociateInteraction : {\n                label : __('Graphic Associate Interaction'),\n                icon : 'icon-graphic-associate',\n                description : __('Create association(s) between areas (hotspots) displayed on a picture.'),\n                short : __('Associate'),\n                qtiClass : 'graphicAssociateInteraction',\n                tags:['Graphic Interactions', 'association']\n            },\n            graphicGapMatchInteraction : {\n                label : __('Graphic Gap Match Interaction'),\n                icon : 'icon-graphic-gap',\n                description : __('Fill in the gaps on a picture with a set of image choices.'),\n                short : __('Gap Match'),\n                qtiClass : 'graphicGapMatchInteraction',\n                tags:['Graphic Interactions', 'association']\n            },\n            selectPointInteraction : {\n                label : __('Select Point Interaction'),\n                icon : 'icon-select-point',\n                description : __('Position one or more points on a picture (response areas are not displayed).'),\n                short : __('Select Point'),\n                qtiClass : 'selectPointInteraction',\n                tags:['Graphic Interactions']\n            }\n        };\n    };\n\n    return QtiElements;\n\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n *\n */\ndefine('taoQtiItem/portableElementRegistry/factory/ciRegistry',[\n    'lodash',\n    'taoQtiItem/portableElementRegistry/factory/factory',\n    'taoQtiItem/qtiCreator/helper/qtiElements'\n], function (_, portableElementRegistry, qtiElements){\n    'use strict';\n\n    /**\n     * Create a ney interaction registry instance\n     * interaction registry need to register newly loaded creator hooks in the list of available qti authoring elements\n     *\n     * @returns {Object} registry instance\n     */\n    return function customInteractionRegistry(){\n\n        return portableElementRegistry({\n            getAuthoringData : function getAuthoringData(typeIdentifier, version){\n                var pciModel = this.get(typeIdentifier, version);\n                if(pciModel && pciModel.creator && pciModel.creator.hook && pciModel.creator.icon){\n                    return {\n                        label : pciModel.label, //currently no translation available\n                        icon : pciModel.creator.icon.replace(new RegExp('^' + typeIdentifier + '\\/'), pciModel.baseUrl),\n                        short : pciModel.short,\n                        description : pciModel.description,\n                        qtiClass : 'customInteraction.' + pciModel.typeIdentifier, //custom interaction is block type\n                        tags : _.union(['Custom Interactions'], pciModel.tags)\n                    };\n                }\n            }\n        }).on('creatorsloaded', function(creators){\n            _.each(creators, function(creator){\n                qtiElements.classes['customInteraction.' + creator.getTypeIdentifier()] = {parents : ['customInteraction'], qti : true};\n            });\n        });\n    }\n\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n *\n */\ndefine('taoQtiItem/portableElementRegistry/ciRegistry',['lodash', 'taoQtiItem/portableElementRegistry/factory/ciRegistry', 'module'], function (_, ciRegistry, module){\n    'use strict';\n\n    //create a preregistered singleton of ciRegistry\n    var registry = ciRegistry();\n    var providers = [];\n    var config = module.config();\n\n    if(config && config.providers){\n        providers = config.providers;\n    }\n\n    _.each(providers, function(provider){\n        if(provider.name && provider.module){\n            registry.registerProvider(provider.module);\n        }\n    });\n\n    return registry;\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n *\n */\ndefine('taoQtiItem/portableElementRegistry/factory/icRegistry',[\n    'lodash',\n    'taoQtiItem/portableElementRegistry/factory/factory'\n], function (_, portableElementRegistry){\n    'use strict';\n\n    /**\n     * Info control registry has currently no additonal fonctionalities than the basic portable element registry\n     *\n     * @returns {Object} registry instance\n     */\n    return function infoControlRegistry(){\n        return portableElementRegistry();\n    }\n\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n *\n */\ndefine('taoQtiItem/portableElementRegistry/icRegistry',['lodash', 'taoQtiItem/portableElementRegistry/factory/icRegistry', 'module'], function (_, icRegistry, module){\n    'use strict';\n\n    //create a preregistered singleton of icRegistry\n    var registry = icRegistry();\n    var providers = [];\n    var config = module.config();\n\n    if(config && config.providers){\n        providers = config.providers;\n    }\n\n    _.each(providers, function(provider){\n        if(provider.name && provider.module){\n            registry.registerProvider(provider.module);\n        }\n    });\n\n    return registry;\n});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n */\n\ndefine('taoQtiItem/portableElementRegistry/assetManager/portableAssetStrategy',[\n    'taoQtiItem/portableElementRegistry/ciRegistry',\n    'taoQtiItem/portableElementRegistry/icRegistry'\n], function (ciRegistry, icRegistry) {\n    'use strict';\n\n    function getBaseUrlByIdentifier(typeIdentifier) {\n        if (ciRegistry.get(typeIdentifier)) {\n            return ciRegistry.getBaseUrl(typeIdentifier);\n        }\n        if (icRegistry.get(typeIdentifier)) {\n            return icRegistry.getBaseUrl(typeIdentifier);\n        }\n        return typeIdentifier;\n    }\n\n    //strategy to resolve portable info control and portable interactions paths.\n    //It should never be reached in the stack the usual way and should be called only using resolveBy.\n    return {\n        name: 'portableElementLocation',\n        handle: function handlePortableElementLocation(url) {\n\n            if (url.file === url.path) {\n                return getBaseUrlByIdentifier(url.file);\n            } else if (url.source === url.relative) {\n                return url.relative.replace(/^(\\.\\/)?([a-z_0-9]+)\\/(.*)/i, function (fullmatch, $1, typeIdentifier, relPath) {\n                    var runtimeLocation = getBaseUrlByIdentifier(typeIdentifier);\n                    if (runtimeLocation) {\n                        return runtimeLocation + '/' + relPath;\n                    }\n                    return fullmatch;\n                });\n            }\n        }\n    };\n});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\n */\n\ndefine('taoQtiItem/qtiCommonRenderer/renderers/config',[\n    'lodash',\n    'context',\n    'ui/themes',\n    'taoItems/assets/manager',\n    'taoItems/assets/strategies',\n    'module',\n    'taoQtiItem/portableElementRegistry/assetManager/portableAssetStrategy'\n], function(_, context, themes, assetManagerFactory, assetStrategies, module, portableAssetStrategy){\n    'use strict';\n\n    var itemThemes = themes.get('items');\n    var moduleConfig = module.config();\n\n    //Create asset manager stack\n    var assetManager = assetManagerFactory([\n        {\n            name : 'theme',\n            handle : function handleTheme(url){\n                if(itemThemes && url.path && (url.path === itemThemes.base || _.contains(_.pluck(itemThemes.available, 'path'), url.path))){\n                    return context.root_url + url.toString();\n                }\n            }\n        },\n        assetStrategies.taomedia,\n        assetStrategies.external,\n        assetStrategies.base64,\n        assetStrategies.itemCssNoCache,\n        assetStrategies.baseUrl,\n        portableAssetStrategy\n    ], {baseUrl : ''});//baseUrl is not predefined in the config, but should be set upon renderer instantiating\n\n    //renderers locations\n    var locations = {\n        'assessmentItem' : 'taoQtiItem/qtiCommonRenderer/renderers/Item',\n        '_container' : 'taoQtiItem/qtiCommonRenderer/renderers/Container',\n        '_simpleFeedbackRule' : false,\n        'stylesheet' : 'taoQtiItem/qtiCommonRenderer/renderers/Stylesheet',\n        'outcomeDeclaration' : false,\n        'responseDeclaration' : false,\n        'responseProcessing' : false,\n        'img' : 'taoQtiItem/qtiCommonRenderer/renderers/Img',\n        'math' : 'taoQtiItem/qtiCommonRenderer/renderers/Math',\n        'object' : 'taoQtiItem/qtiCommonRenderer/renderers/Object',\n        'rubricBlock' : 'taoQtiItem/qtiCommonRenderer/renderers/RubricBlock',\n        'modalFeedback' : 'taoQtiItem/qtiCommonRenderer/renderers/ModalFeedback',\n        'prompt' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/Prompt',\n        'choiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/ChoiceInteraction',\n        'extendedTextInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction',\n        'orderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/OrderInteraction',\n        'associateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/AssociateInteraction',\n        'matchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/MatchInteraction',\n        'textEntryInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/TextEntryInteraction',\n        'sliderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/SliderInteraction',\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction',\n        'simpleChoice.choiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.ChoiceInteraction',\n        'simpleChoice.orderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.OrderInteraction',\n        'hottext' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/Hottext',\n        'gap' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/Gap',\n        'gapText' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/GapText',\n        'simpleAssociableChoice.matchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.MatchInteraction',\n        'simpleAssociableChoice.associateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.AssociateInteraction',\n        'inlineChoice' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/InlineChoice',\n        'hottextInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction',\n        'hotspotInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction',\n        'hotspotChoice' : false,\n        'gapMatchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction',\n        'selectPointInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction',\n        'graphicOrderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction',\n        'mediaInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/MediaInteraction',\n        'uploadInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/UploadInteraction',\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction',\n        'gapImg' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/GapImg',\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction',\n        'associableHotspot' : false,\n        'customInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/PortableCustomInteraction',\n        'infoControl' : 'taoQtiItem/qtiCommonRenderer/renderers/PortableInfoControl',\n        'include' : 'taoQtiItem/qtiCommonRenderer/renderers/Include',\n        'endAttemptInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/EndAttemptInteraction'\n    };\n\n    return {\n        name:'commonRenderer',\n        locations: locations,\n        options:   {\n            assetManager: assetManager,\n            themes : itemThemes,\n            enableDragAndDrop: {\n                associate: !!moduleConfig.associateDragAndDrop,\n                gapMatch: !!moduleConfig.gapMatchDragAndDrop,\n                graphicGapMatch: !!moduleConfig.graphicGapMatchDragAndDrop,\n                order: !!moduleConfig.orderDragAndDrop\n            },\n            messages : moduleConfig.messages\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\n */\n\n/**\n * Define the Qti Item Common Renderer\n */\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Renderer',[\n    'taoQtiItem/qtiRunner/core/Renderer',\n    'taoQtiItem/qtiCommonRenderer/renderers/config'\n], function(Renderer, config){\n    'use strict';\n\n    return Renderer.build(config.locations, config.name, config.options);\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoClientDiagnostic/tools/performances/tester',[\n    'jquery',\n    'lodash',\n    'async',\n    'context',\n    'helpers',\n    'taoClientDiagnostic/tools/stats',\n    'taoQtiItem/qtiItem/core/Loader',\n    'taoQtiItem/qtiCommonRenderer/renderers/Renderer',\n    'lib/polyfill/performance-now'\n], function($, _, async, context, helpers, stats, Loader, Renderer) {\n    'use strict';\n\n    /**\n     * Duration of one second (in milliseconds)\n     * @type {Number}\n     * @private\n     */\n    var _second = 1000;\n\n    /**\n     * Default timeout duration\n     * @type {Number}\n     * @private\n     */\n    var _defaultTimeout = 30 * _second;\n\n    /**\n     * Default number of renderings by samples\n     * @type {Number}\n     * @private\n     */\n    var _defaultOccurrencesCount = 10;\n\n    /**\n     * List of default samples\n     * @type {Array}\n     */\n    var _defaultSamples = [\n        'taoClientDiagnostic/tools/performances/data/sample1/',\n        'taoClientDiagnostic/tools/performances/data/sample2/',\n        'taoClientDiagnostic/tools/performances/data/sample3/'\n    ];\n\n    /**\n     * Base text used to build sample identifiers\n     * @type {String}\n     * @private\n     */\n    var _sampleBaseId = 'sample';\n\n    /**\n     * Loads a page inside a div and compute the time to load\n     * @param {Object} data The descriptor of the page to load\n     * @param {Function} done A callback function called to provide the result\n     */\n    function loadItem(data, done){\n\n        //item location config\n        var qtiJsonFile = data.url + 'qti.json';\n        var urlTokens = data.url.split('/');\n        var extension = urlTokens[0];\n        var fullpath = require.s.contexts._.config.paths[extension];\n        var baseUrl = data.url.replace(extension, fullpath);\n        var loader = new Loader();\n        var renderer = new Renderer({\n            baseUrl : baseUrl       // compatibility mode for legacy installations\n        });\n\n        // check needed by compatibility mode for legacy installations\n        if (renderer.getAssetManager) {\n            renderer.getAssetManager().setData('baseUrl', baseUrl);\n        }\n\n        require(['json!'+qtiJsonFile], function(itemData){\n\n            loader.loadItemData(itemData, function(item){\n                renderer.load(function(){\n\n                    var $container,\n                        duration,\n                        start,\n                        end,\n                        result;\n\n                    //start right before rendering\n                    start = window.performance.now();\n\n                    //set renderer\n                    item.setRenderer(this);\n\n                    //render markup\n                    $container = $('<div>').appendTo('body');\n                    $container.append(item.render());\n\n                    //execute javascript\n                    item.postRender();\n\n                    //remove item\n                    $container.remove();\n\n                    //done\n                    end = window.performance.now();\n\n                    duration = (end - start) / _second;\n\n                    result = {\n                        id : data.id,\n                        url : data.url,\n                        duration: duration\n                    };\n\n                    done(null, result);\n\n                }, this.getLoadedClasses());\n            });\n\n        });\n\n    }\n\n    /**\n     * Performs a browser performances test by running a heavy page\n     *\n     * @param {Array} [samples]\n     * @param {Number} [occurrences]\n     * @param {Number} [timeout]\n     * @returns {Object}\n     */\n    var performancesTester = function performancesTester(samples, occurrences, timeout) {\n        var idx = 0;\n        var _samples = _.map(!_.isEmpty(samples) && samples || _defaultSamples, function(sample) {\n            idx ++;\n            return {\n                id : _sampleBaseId + idx,\n                url : sample,\n                timeout : timeout || _defaultTimeout,\n                nb : occurrences || _defaultOccurrencesCount\n            };\n        });\n\n        // add one occurrence on the first sample to obfuscate the time needed to load the runner\n        _samples[0].nb ++;\n\n        return {\n            /**\n             * Performs a performances test, then call a function to provide the result\n             * @param {Function} done\n             */\n            start: function start(done) {\n                var tests = [];\n                _.forEach(_samples, function(data) {\n                    var cb = _.partial(loadItem, data);\n                    var iterations = data.nb || 1;\n                    while (iterations --) {\n                        tests.push(cb);\n                    }\n                });\n\n                async.series(tests, function(err, measures) {\n                    var decimals = 2;\n                    var results;\n\n                    if(err && !measures.length){\n                        //something went wrong\n                        throw err;\n                    }\n\n                    // remove the first result to obfuscate the time needed to load the runner\n                    measures.shift();\n\n                    results = stats(measures, 'duration', decimals);\n\n                    done(results.average, results);\n                });\n            }\n        };\n    };\n\n    return performancesTester;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\ndefine('taoClientDiagnostic/tools/bandwidth/tester',[\n    'lodash',\n    'async',\n    'context',\n    'taoClientDiagnostic/tools/stats',\n    'taoClientDiagnostic/tools/fixedDecimals',\n    'lib/polyfill/performance-now'\n], function(_, async, context, stats, fixedDecimals) {\n    'use strict';\n\n    /**\n     * A binary kilo bytes (KiB)\n     * @type {Number}\n     * @private\n     */\n    var _kilo = 1024;\n\n    /**\n     * A binary mega bytes (MiB)\n     * @type {Number}\n     * @private\n     */\n    var _mega = _kilo * _kilo;\n\n    /**\n     * Duration of one second (in milliseconds)\n     * @type {Number}\n     * @private\n     */\n    var _second = 1000;\n\n    /**\n     * List of descriptors defining the data sets to download.\n     * - file : path of the file containing the test data\n     * - size : the given size of the file\n     * - timeout : the timeout for the download\n     * - threshold : a bandwidth threshold above which the data set can be downloaded to evaluate a more accurate value\n     * - nb : number of download iterations\n     * @type {Object}\n     */\n    var _downloadData = {\n        \"10KB\" : {\n            id : '10KB',\n            file : 'data/bin10KB.data',\n            size : 10 * _kilo,\n            timeout : _second,\n            threshold : 0,\n            nb : 10\n        },\n        \"100KB\" : {\n            id : '100KB',\n            file : 'data/bin100KB.data',\n            size : 100 * _kilo,\n            timeout : 2 * _second,\n            threshold : 0,\n            nb : 5\n        },\n        \"1MB\" : {\n            id : '1MB',\n            file : 'data/bin1MB.data',\n            size : _mega,\n            timeout : 20 * _second,\n            threshold : 0,\n            nb : 3\n        },\n        \"10MB\" : {\n            id : '10MB',\n            file : 'data/bin10MB.data',\n            size : 10 * _mega,\n            timeout : 20 * _second,\n            threshold : 8,\n            nb : 3\n        }\n    };\n\n    /**\n     * Download a data set as described by the provided descriptor and compute the duration.\n     * @param {Object} data The data set descriptor to use for download\n     * @param {Function} cb A callback function called at the end of the download.\n     * This callback is also called if a timeout breaks the download;\n     */\n    var download = function download(data, cb) {\n        var self = this;\n        var start, end;\n        var timeoutId;\n        var url;\n        var request;\n\n        if (data.threshold && this.bandwidth < data.threshold) {\n            return cb('threshold');\n        }\n\n        url = context.root_url + '/taoClientDiagnostic/views/js/tools/bandwidth/' + data.file + '?' + Date.now();\n        request = new XMLHttpRequest();\n        request.open('GET', url, true);\n        request.setRequestHeader('Accept', 'application/octet-stream');\n\n        request.onload = function onRequestLoad () {\n            var duration;\n            var bytes;\n            var seconds;\n            var speed;\n\n            end = window.performance.now();\n            clearTimeout(timeoutId);\n\n            duration = end - start;\n            bytes = data.size;\n            seconds = duration / _second;\n\n            // speed in Mbps\n            speed = ((bytes * 8) / seconds) / _mega;\n\n            self.bandwidth = Math.max(self.bandwidth, speed);\n\n            return cb(null, {\n                id : data.id,\n                file : data.file,\n                size : data.size,\n                duration : duration,\n                speed : speed\n            });\n        };\n        request.onerror = function onRequestError (err) {\n            clearTimeout(timeoutId);\n            cb(err);\n        };\n\n        timeoutId = _.delay(cb, data.timeout, 'timeout');\n        start = window.performance.now();\n        request.send();\n    };\n\n    /**\n     * Performs a bandwidth test by downloading a bunch of data sets with different sizes\n     *\n     * @returns {Object}\n     */\n    var bandwidthTester = function bandwidthTester (){\n        return {\n            /**\n             * Performs a bandwidth test, then call a function to provide the result\n             * @param {Function} done\n             */\n            start : function start(done){\n                var self = this;\n                var tests = [];\n                _.forEach(_downloadData, function(data) {\n                    var cb = _.bind(download, self, data);\n                    var iterations = data.nb || 1;\n                    while (iterations --) {\n                        tests.push(cb);\n                    }\n                });\n\n                this.bandwidth = 0;\n\n                async.series(tests, function(err, measures) {\n                    var duration = 0;\n                    var size = 0;\n                    var decimals = 2;\n                    var getValue;\n                    var results;\n\n                    if (err && !measures.length) {\n                        //something went wrong\n                        throw err;\n                    }\n\n                    getValue = function(value) {\n                        var speed = 0;\n\n                        if (value) {\n                            duration += value.duration;\n                            size += value.size;\n\n                            speed = value.speed;\n                            value.speed = fixedDecimals(speed, decimals);\n                        }\n\n                        return speed;\n                    };\n\n                    results = stats(measures, getValue, decimals);\n\n                    results.duration = fixedDecimals(duration / _second, decimals);\n                    results.size = size;\n\n                    done(results.average, results);\n                });\n            }\n        };\n    };\n\n    return bandwidthTester;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\ndefine('taoClientDiagnostic/tools/upload/tester',[\n    'jquery',\n    'lodash',\n    'async',\n    'util/url'\n], function($, _, async, urlHelper) {\n    'use strict';\n\n    /**\n     * A binary kilo bytes (KiB)\n     * @type {Number}\n     * @private\n     */\n    var _kilo = 1024;\n\n    /**\n     * A binary mega bytes (MiB)\n     * @type {Number}\n     * @private\n     */\n    var _mega = _kilo * _kilo;\n\n    /**\n     * Result of diagnostic\n     */\n    var data = [];\n\n    /**\n     * Generate random string of given length\n     * @param length\n     */\n    var generateStr = function generateStr(length) {\n        var text = \"\";\n        var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n        for( var i=0; i < length; i++ ) {\n            text += possible.charAt(Math.floor(Math.random() * possible.length));\n        }\n\n        return text;\n    };\n\n    /**\n     * Upload generated string to check upload speed.\n     * @param {number} size of string to upload in bytes\n     * @return {object} jqXHR\n     */\n    var upload = function upload(size) {\n\n        var url = urlHelper.route('upload', 'CompatibilityChecker', 'taoClientDiagnostic', {cache : Date.now()});\n        var str = generateStr(size);\n        data = [];\n\n        return $.ajax({\n            url : url,\n            type : 'POST',\n            data : {\n                upload : str\n            },\n            xhr: function() {\n                var xhr = new window.XMLHttpRequest();\n                var startTime = Date.now();\n                // Upload progress\n                xhr.upload.addEventListener(\"progress\", function(evt){\n                    if (evt.lengthComputable) {\n                        var passedTime = Date.now() - startTime;\n                        data.push({\n                            time: passedTime,\n                            loaded: evt.loaded,\n                            speed: ((evt.loaded * 8) / _mega) / (passedTime / 1000)\n                        });\n                    }\n                }, false);\n\n                return xhr;\n            },\n        });\n    };\n\n    /**\n     * Performs a upload speed test\n     * @returns {Object}\n     */\n    var uploadTester = function uploadTester (config){\n        return {\n            /**\n             * Performs upload speed test, then call a function to provide the result\n             * @param {Function} done\n             */\n            start : function start(done) {\n                var jqXHR = upload(parseInt(config.size, 10));\n                jqXHR.then(function() {\n                    done(data);\n                });\n            }\n        };\n    };\n\n    return uploadTester;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoClientDiagnostic/tools/getconfig',['lodash'], function (_) {\n    'use strict';\n\n    /**\n     * Gets a config set\n     * @param {Object} [config]\n     * @param {Object} [defaults]\n     * @returns {Object}\n     */\n    return function getConfig(config, defaults) {\n        return _(config || {})\n            .omit(function (value) {\n                return value === null || value === undefined;\n            })\n            .defaults(defaults || {})\n            .value();\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoClientDiagnostic/tools/browser/tester',[\n    'jquery',\n    'i18n',\n    'helpers',\n    'taoClientDiagnostic/tools/getconfig'\n], function ($, __, helpers, getConfig) {\n    'use strict';\n\n    /**\n     * Some default values\n     * @type {Object}\n     * @private\n     */\n    var _defaults = {\n        action: 'whichBrowser',\n        controller: 'CompatibilityChecker',\n        extension: 'taoClientDiagnostic'\n    };\n\n    /**\n     * Gets the URL of the browser tester\n     * @param {Window} window - Need an access to the window object\n     * @param {String} action - The name of the action to call to get the browser checker\n     * @param {String} controller - The name of the controller to call to get the browser checker\n     * @param {String} extension - The name of the extension containing the controller to call to get the browser checker\n     * @returns {String}\n     */\n    function getTesterUrl(window, action, controller, extension) {\n        var document = window.document;\n        var navigator = window.navigator;\n        var screen = window.screen;\n        var params = {};\n        var e = 0;\n        var f = 0;\n\n        // append the browser user agent\n        params.ua = navigator.userAgent;\n\n        // detect browser family\n        e |= window.ActiveXObject ? 1 : 0;\n        e |= window.opera ? 2 : 0;\n        e |= window.chrome ? 4 : 0;\n        e |= 'getBoxObjectFor' in document || 'mozInnerScreenX' in window ? 8 : 0;\n        e |= ('WebKitCSSMatrix' in window || 'WebKitPoint' in window || 'webkitStorageInfo' in window || 'webkitURL' in window) ? 16 : 0;\n        e |= (e & 16 && ({}.toString).toString().indexOf(\"\\n\") === -1) ? 32 : 0;\n        params.e = e;\n\n        // gather info about browser functionality\n        f |= 'sandbox' in document.createElement('iframe') ? 1 : 0;\n        f |= 'WebSocket' in window ? 2 : 0;\n        f |= window.Worker ? 4 : 0;\n        f |= window.applicationCache ? 8 : 0;\n        f |= window.history && window.history.pushState ? 16 : 0;\n        f |= document.documentElement.webkitRequestFullScreen ? 32 : 0;\n        f |= 'FileReader' in window ? 64 : 0;\n        params.f = f;\n\n        // append a unique ID\n        params.r = Math.random().toString(36).substring(7);\n\n        // get the screen size\n        params.w = screen.width;\n        params.h = screen.height;\n\n        return helpers._url(action, controller, extension, params);\n    }\n\n    /**\n     * Performs a browser support test\n     *\n     * @param {Window} window - Need an access to the window object\n     * @param {Object} [config] - Some optional configs\n     * @param {String} [config.action] - The name of the action to call to get the browser checker\n     * @param {String} [config.controller] - The name of the controller to call to get the browser checker\n     * @param {String} [config.extension] - The name of the extension containing the controller to call to get the browser checker\n     * @returns {Object}\n     */\n    function browserTester(window, config) {\n        var initConfig = getConfig(config || {}, _defaults);\n\n        return {\n            /**\n             * Performs a browser support test, then call a function to provide the result\n             * @param {Function} done\n             */\n            start: function start(done) {\n                var url = getTesterUrl(window, initConfig.action, initConfig.controller, initConfig.extension);\n                $.ajax({\n                    url : url,\n                    success : function(data) {\n                        done(data);\n                    }\n                });\n            }\n        };\n    }\n\n    return browserTester;\n});\n\n","\ndefine('tpl!taoClientDiagnostic/tools/diagnostic/tpl/main', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<p>\";\n  if (helper = helpers.header) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.header); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</p>\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<p>\";\n  if (helper = helpers.info) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.info); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</p>\";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"diagnostics-main-area\\\">\\n\\n    <h1>\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h1>\\n\\n    <div class=\\\"intro\\\">\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.header), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.info), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </div>\\n\\n    <div class=\\\"clearfix\\\">\\n        <button data-action=\\\"test-launcher\\\" class=\\\"btn-info small rgt\\\">\";\n  if (helper = helpers.button) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.button); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</button>\\n    </div>\\n\\n    <ul class=\\\"plain results\\\"></ul>\\n\\n    <div class=\\\"status\\\">\\n        <h2></h2>\\n    </div>\\n\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoClientDiagnostic/tools/diagnostic/tpl/result', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n        <div class=\\\"small feedback feedback-\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n            <span class=\\\"icon icon-\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></span>\\n            <span class=\\\"msg\\\">\";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n            \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.legend), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        </div>\\n        \";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<div class=\\\"legend\\\">\";\n  if (helper = helpers.legend) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.legend); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</div>\";\n  return buffer;\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\n        <div class=\\\"quality-bar\\\">\\n            <div class=\\\"quality-indicator\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.wide), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.label), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"></div>\\n        </div>\\n        \";\n  return buffer;\n  }\nfunction program5(depth0,data) {\n  \n  \n  return \" wide\";\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \" title=\\\"\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program9(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\n    <div class=\\\"clearfix\\\">\\n        <button data-action=\\\"show-details\\\" class=\\\"rgt btn-info small\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Show Details\", options) : helperMissing.call(depth0, \"__\", \"Show Details\", options)))\n    + \"</button>\\n        <button data-action=\\\"hide-details\\\" class=\\\"rgt btn-info small hidden\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Hide Details\", options) : helperMissing.call(depth0, \"__\", \"Hide Details\", options)))\n    + \"</button>\\n        <div class=\\\"details hidden\\\">\\n            <h2>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Details\", options) : helperMissing.call(depth0, \"__\", \"Details\", options)))\n    + \"</h2>\\n            <div>\\n                <table class=\\\"matrix\\\">\\n                    <tbody>\\n                    \";\n  stack1 = helpers.each.call(depth0, depth0, {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n                    </tbody>\\n                </table>\\n            </div>\\n        </div>\\n    </div>\\n    \";\n  return buffer;\n  }\nfunction program10(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n                        <tr><td>\";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</td><td>\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</td></tr>\\n                    \";\n  return buffer;\n  }\n\n  buffer += \"<li data-result=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n    <h2>\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h2>\\n    <div>\\n        \";\n  stack1 = helpers['with'].call(depth0, (depth0 && depth0.feedback), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\\n        \";\n  stack1 = helpers['with'].call(depth0, (depth0 && depth0.quality), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </div>\\n    \";\n  stack1 = helpers['with'].call(depth0, (depth0 && depth0.details), {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n</li>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('css!taoClientDiagnosticCss/diagnostics',[],function(){});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n * @author dieter <dieter@taotesting.com>\n */\ndefine('taoClientDiagnostic/tools/diagnostic/diagnostic',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'async',\n    'helpers',\n    'ui/feedback',\n    'ui/component',\n    'taoClientDiagnostic/tools/diagnostic/status',\n    'taoClientDiagnostic/tools/performances/tester',\n    'taoClientDiagnostic/tools/bandwidth/tester',\n    'taoClientDiagnostic/tools/upload/tester',\n    'taoClientDiagnostic/tools/browser/tester',\n    'taoClientDiagnostic/tools/getconfig',\n    'tpl!taoClientDiagnostic/tools/diagnostic/tpl/main',\n    'tpl!taoClientDiagnostic/tools/diagnostic/tpl/result',\n    'css!taoClientDiagnosticCss/diagnostics'\n], function ($, _, __, async, helpers, feedback, component, statusFactory, performancesTester, bandwidthTester, uploadTester, browserTester,getConfig,  mainTpl, resultTpl) {\n    'use strict';\n\n    /**\n     * Some default values\n     * @type {Object}\n     * @private\n     */\n    var _defaults = {\n        title: __('Diagnostic Tool'),\n        header: __('This tool will run a number of tests in order to establish how well your current environment is suitable to run the TAO platform.'),\n        info: __('Be aware that these tests will take up to several minutes.'),\n        button: __('Begin diagnostics'),\n        actionStore: 'storeData',\n        actionCheck: 'check',\n        controller: 'DiagnosticChecker',\n        extension: 'taoClientDiagnostic'\n    };\n\n    /**\n     * Default values for the browser tester\n     * @type {Object}\n     * @private\n     */\n    var _defaultsBrowser = {\n        action: 'whichBrowser',\n        controller: 'CompatibilityChecker',\n        extension: 'taoClientDiagnostic'\n    };\n\n    /**\n     * Default values for the bandwidth tester\n     * @type {Object}\n     * @private\n     */\n    var _defaultsBandwidth = {\n        // The typical bandwidth needed for a test taker (Mbps)\n        unit: 0.16,\n\n        // The thresholds for optimal bandwidth\n        ideal: 45,\n\n        // Maximum number of test takers to display\n        max: 100\n    };\n\n    /**\n     * Default values for the performances tester\n     * @type {Object}\n     * @private\n     */\n    var _defaultsPerformances = {\n        // The threshold for optimal performances\n        optimal: 0.025,\n\n        // The threshold for minimal performances\n        threshold: 0.25\n    };\n\n    /**\n     * Defines a diagnostic tool\n     * @type {Object}\n     */\n    var diagnostic = {\n        /**\n         * Updates the displayed status\n         * @param {String} status\n         * @returns {diagnostic}\n         * @private\n         */\n        changeStatus: function changeStatus(status) {\n            if (this.is('rendered')) {\n                this.controls.$status.html(status);\n            }\n            return this;\n        },\n\n        /**\n         * Sends the detailed stats to the server\n         * @param {String} type The type of stats\n         * @param {Object} details The stats details\n         * @param {Function} done A callback method called once server has responded\n         */\n        store: function store(type, details, done) {\n            var config = this.config;\n\n            details = _.omit(details, 'values');\n            details.type = type;\n\n            $.post(\n                helpers._url(config.actionStore, config.controller, config.extension, config.storeParams),\n                details,\n                done,\n                \"json\"\n            );\n        },\n\n        /**\n         * Performs a browser checks\n         * @param {Function} done\n         */\n        checkBrowser: function checkBrowser(done) {\n            var self = this;\n            var config = this.config;\n\n            this.changeStatus(__('Checking the browser...'));\n\n            browserTester(window, getConfig(this.config.browser, _defaultsBrowser)).start(function (information) {\n                // which browser\n                $.post(\n                    helpers._url(config.actionCheck, config.controller, config.extension, config.storeParams),\n                    information,\n                    function (data) {\n                        var percentage = ('success' === data.type) ? 100 : (('warning' === data.type) ? 33 : 0);\n                        var status = self.status.getStatus(percentage, data);\n                        var summary = {\n                            browser: {\n                                message: __('Web browser'),\n                                value: information.browser + ' ' + information.browserVersion\n                            },\n                            os: {\n                                message: __('Operating system'),\n                                value: information.os + ' ' + information.osVersion\n                            }\n                        };\n\n                        status.id = 'browser';\n                        status.title = __('Operating system and web browser');\n\n                        self.addResult(status);\n\n                        done(status, summary);\n                    },\n                    'json'\n                );\n            });\n        },\n\n        /**\n         * Performs a browser performances check\n         * @param {Function} done\n         */\n        checkPerformances: function checkPerformances(done) {\n            var self = this;\n            var config = getConfig(this.config.performances, _defaultsPerformances);\n            var optimal = config.optimal;\n            var range = Math.abs(optimal - (config.threshold));\n\n            this.changeStatus(__('Checking the performances...'));\n            performancesTester(config.samples, config.occurrences, config.timeout * 1000).start(function (average, details) {\n                var cursor = range - average + optimal;\n                var status = self.status.getStatus(cursor / range * 100, 'performances');\n                var summary = {\n                    performancesMin: {message: __('Minimum rendering time'), value: details.min + ' s'},\n                    performancesMax: {message: __('Maximum rendering time'), value: details.max + ' s'},\n                    performancesAverage: {message: __('Average rendering time'), value: details.average + ' s'}\n                };\n\n                self.store('performance', details, function () {\n                    status.id = 'performance';\n                    status.title = __('Workstation performances');\n\n                    self.addResult(status);\n                    done(status, summary);\n                });\n            });\n        },\n\n        /**\n         * Performs a browser bandwidth check\n         * @param {Function} done\n         */\n        checkBandwidth: function checkBandwidth(done) {\n            var self = this;\n            var config = getConfig(this.config.bandwidth, _defaultsBandwidth);\n\n            this.changeStatus(__('Checking the bandwidth...'));\n            bandwidthTester().start(function (average, details) {\n                var summary = {\n                    bandwidthMin: {message: __('Minimum bandwidth'), value: details.min + ' Mbps'},\n                    bandwidthMax: {message: __('Maximum bandwidth'), value: details.max + ' Mbps'},\n                    bandwidthAverage: {message: __('Average bandwidth'), value: details.average + ' Mbps'}\n                };\n\n                self.store('bandwidth', details, function () {\n                    var status = [];\n\n                    var bandwidthUnit = config.unit;\n                    var testTakers = config.ideal;\n                    var maxTestTakers = config.max;\n\n                    if (!_.isArray(testTakers)) {\n                        testTakers = [testTakers];\n                    }\n\n                    _.forEach(testTakers, function (threshold, i) {\n                        var max = threshold * bandwidthUnit;\n                        var st = self.status.getStatus(details.max / max * 100, 'bandwidth');\n                        var nb = Math.floor(details.max / bandwidthUnit);\n\n                        if (nb > maxTestTakers) {\n                            nb = '>' + maxTestTakers;\n                        }\n\n                        st.id = 'bandwidth-' + i;\n                        st.title = __('Bandwidth');\n                        st.feedback.legend = __('Number of simultaneous test takers the connection can handle');\n\n                        st.quality.label = nb;\n\n                        if (nb.toString().length > 2) {\n                            st.quality.wide = true;\n                        }\n\n                        status.push(st);\n\n                        self.addResult(st);\n                    });\n\n                    done(status, summary);\n                });\n            });\n        },\n\n        /**\n         * Check upload speed\n         * @param {Function} done\n         */\n        checkUpload: function checkUpload(done) {\n            var self = this;\n            var config = this.config.upload;\n\n            this.changeStatus(__('Checking upload speed...'));\n            uploadTester(config).start(function (data) {\n                var totalSpeed = 0;\n                var avgSpeed;\n                var maxSpeed = 0;\n                var optimal = config.optimal / 1024 / 1024;\n\n                _.forEach(data, function (val) {\n                    totalSpeed += val.speed;\n                    if (maxSpeed < val.speed) {\n                        maxSpeed = Math.round(val.speed * 100) / 100;\n                    }\n                });\n                avgSpeed = Math.round(totalSpeed / data.length * 100) / 100;\n\n                var status = self.status.getStatus((100 / optimal) * avgSpeed, 'upload');\n                var summary = {\n                    uploadAvg: {message: __('Average upload speed'), value: avgSpeed + ' Mbps'},\n                    uploadMax: {message: __('Max upload speed'), value: maxSpeed + ' Mbps'},\n                };\n\n                self.store('upload', {\n                    max: maxSpeed,\n                    avg: avgSpeed,\n                    type: 'upload'\n                }, function () {\n                    status.id = 'upload';\n                    status.title = __('Upload speed');\n\n                    self.addResult(status);\n\n                    done(status, summary);\n                });\n            });\n        },\n\n        /**\n         * Add a result row\n         * @param {Object} result\n         * @returns {diagnostic}\n         */\n        addResult: function addResult(result) {\n            var $result, $indicator;\n\n            if (this.is('rendered')) {\n                // adjust the width of the displayed label, if any, to the text length\n                if (result.quality && result.quality.label && result.quality.label.toString().length > 2) {\n                    result.quality.wide = true;\n                }\n\n                // create and append the result to the displayed list\n                $result = $(resultTpl(result));\n                $indicator = $result.find('.quality-indicator');\n                this.controls.$results.append($result);\n\n                // the result is hidden by default, show it with a little animation\n                $result.fadeIn(function () {\n                    if ($indicator.length) {\n                        $indicator.animate({\n                            left: (result.percentage * $result.outerWidth() / 100) - ($indicator.outerWidth() / 2)\n                        });\n                    }\n                });\n            }\n\n            return this;\n        },\n\n        /**\n         * Does some preparations before starting the diagnostics\n         * @returns {diagnostic}\n         * @private\n         */\n        prepare: function prepare() {\n            /**\n             * Notifies the diagnostic start\n             * @event diagnostic#start\n             */\n            this.trigger('start');\n            this.changeStatus(__('Starting...'));\n            this.setState('running', true);\n            this.setState('done', false);\n\n            // first we need a clean space to display the results, so remove the last results if any\n            this.controls.$results.empty();\n\n            // remove the start button during the diagnostic\n            this.controls.$start.addClass('hidden');\n\n            return this;\n        },\n\n        /**\n         * Does some post process after ending the diagnostics\n         * @returns {diagnostic}\n         * @private\n         */\n        finish: function finish() {\n            // restore the start button to allow a new diagnostic run\n            this.controls.$start.removeClass('hidden');\n\n            /**\n             * Notifies the diagnostic end\n             * @event diagnostic#end\n             */\n            this.trigger('end');\n            this.changeStatus(__('Done!'));\n            this.setState('running', false);\n            this.setState('done', true);\n\n            return this;\n        },\n\n        /**\n         * Runs the diagnostics\n         * @returns {diagnostic}\n         */\n        run: function run() {\n            var self = this;\n            var information = {};\n            var scores = {};\n\n            // common handling for testers\n            function doCheck(method, cb) {\n                /**\n                 * Notifies the start of a tester operation\n                 * @event diagnostic#starttester\n                 * @param {String} name - The name of the tester\n                 */\n                self.trigger('starttester', method);\n                self.setState(method, true);\n\n                self[method](function (status, details) {\n                    // the returned details must be ingested into the main details list\n                    _.assign(information, details);\n\n                    // sometimes it is an array, sometimes not...\n                    // simplify all by only supporting arrays\n                    if (!_.isArray(status)) {\n                        status = [status];\n                    }\n                    _.forEach(status, function (st) {\n                        scores[st.id] = st;\n                    });\n\n                    /**\n                     * Notifies the end of a tester operation\n                     * @event diagnostic#endtester\n                     * @param {String} name - The name of the tester\n                     * @param {Array} results - The results of the test\n                     */\n                    self.trigger('endtester', method, status);\n                    self.setState(method, false);\n\n                    // do not forget to notify the end of the operation to the manager\n                    cb();\n                });\n            }\n\n            if (this.is('rendered')) {\n                // set up the component to a new run\n                this.prepare();\n\n                // launch each testers in series, then display the results\n                async.series([function (cb) {\n                    doCheck('checkBrowser', cb);\n                }, function (cb) {\n                    doCheck('checkPerformances', cb);\n                }, function (cb) {\n                    doCheck('checkBandwidth', cb);\n                }, function (cb) {\n                    doCheck('checkUpload', cb);\n                }], function () {\n                    // pick the lowest percentage as the main score\n                    var total = _.min(scores, 'percentage');\n\n                    // get a status according to the main score\n                    var status = self.status.getStatus(total.percentage, 'summary');\n\n                    // display the result\n                    status.title = __('Total');\n                    status.id = 'total';\n                    status.details = information;\n                    self.addResult(status);\n\n                    // done !\n                    self.finish();\n                });\n            }\n\n            return this;\n        }\n    };\n\n    /**\n     * Builds an instance of the diagnostic tool\n     * @param {Object} config\n     * @param {String} [config.title] - The displayed title\n     * @param {String} [config.header] - A header text displayed to describe the component\n     * @param {String} [config.info] - An information text displayed to warn about run duration\n     * @param {String} [config.button] - The caption of the start button\n     * @param {String} [config.actionStore] - The name of the action to call to store the results\n     * @param {String} [config.actionCheck] - The name of the action to call to check the browser results\n     * @param {String} [config.controller] - The name of the controller to call\n     * @param {String} [config.extension] - The name of the extension containing the controller\n     * @param {Object} [config.storeParams] - A list of additional parameters to send with diagnostic results\n     *\n     * @param {String} [config.browser.action] - The name of the action to call to get the browser checker\n     * @param {String} [config.browser.controller] - The name of the controller to call to get the browser checker\n     * @param {String} [config.browser.extension] - The name of the extension containing the controller to call to get the browser checker\n     *\n     * @param {Number} [config.bandwidth.unit] - The typical bandwidth needed for a test taker (Mbps)\n     * @param {Array} [config.bandwidth.ideal] - The thresholds for optimal bandwidth, one by bar\n     * @param {Number} [config.bandwidth.max] - Maximum number of test takers to display\n     *\n     * @param {Array} [config.performances.samples] - A list of samples to render in order to compute the rendering performances\n     * @param {Number} [config.performances.occurrences] - The number of renderings by samples\n     * @param {Number} [config.performances.timeout] - Max allowed duration for a sample rendering\n     * @param {Number} [config.performances.optimal] - The threshold for optimal performances\n     * @param {Number} [config.performances.threshold] - The threshold for minimal performances\n     * @returns {diagnostic}\n     */\n    function diagnosticFactory(config) {\n        // fix the translations for content loaded from config files\n        if (config) {\n            _.forEach(['title', 'header', 'footer', 'info', 'button'], function(name) {\n                if (config[name]) {\n                    config[name] = __(config[name]);\n                }\n            });\n        }\n        \n        return component(diagnostic, _defaults)\n            .setTemplate(mainTpl)\n\n            // uninstalls the component\n            .on('destroy', function () {\n                this.controls = null;\n                this.status = null;\n            })\n\n            // renders the component\n            .on('render', function () {\n                var self = this;\n\n                // use an external component to handle the thresholds and status\n                this.status = statusFactory();\n\n                // get access to all needed placeholders\n                this.controls = {\n                    $start: this.$component.find('[data-action=\"test-launcher\"]'),\n                    $status: this.$component.find('.status h2'),\n                    $results: this.$component.find('.results')\n                };\n\n                // start the diagnostic\n                this.controls.$start.on('click', function () {\n                    self.run();\n                });\n\n                // show result details\n                this.controls.$results.on('click', 'button[data-action=\"show-details\"]', function () {\n                    var $btn = $(this).closest('button');\n                    var $result = $btn.closest('[data-result]');\n                    var $details = $result.find('.details');\n                    $details.removeClass('hidden');\n                    $btn.addClass('hidden');\n                    $result.find('[data-action=\"hide-details\"]').removeClass('hidden');\n                });\n\n                // hide result details\n                this.controls.$results.on('click', 'button[data-action=\"hide-details\"]', function () {\n                    var $btn = $(this).closest('button');\n                    var $result = $btn.closest('[data-result]');\n                    var $details = $result.find('.details');\n                    $details.addClass('hidden');\n                    $btn.addClass('hidden');\n                    $result.find('[data-action=\"show-details\"]').removeClass('hidden');\n                });\n            })\n            .init(config);\n    }\n\n    return diagnosticFactory;\n});\n\n","\ndefine('tpl!taoProctoring/templates/diagnostic/main', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<p>\";\n  if (helper = helpers.header) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.header); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</p>\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<p>\";\n  if (helper = helpers.info) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.info); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</p>\";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"diagnostics-main-area\\\">\\n\\n    <h1>\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h1>\\n\\n    <div class=\\\"intro\\\">\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.header), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.info), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        <p>\\n            <label for=\\\"workstation\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Workstation:\", options) : helperMissing.call(depth0, \"__\", \"Workstation:\", options)))\n    + \"</label>\\n            <input type=\\\"text\\\" data-control=\\\"workstation\\\" id=\\\"workstation\\\" name=\\\"workstation\\\" maxlength=\\\"64\\\" placeholder=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Workstation name\", options) : helperMissing.call(depth0, \"__\", \"Workstation name\", options)))\n    + \"\\\" />\\n        </p>\\n    </div>\\n\\n    <div class=\\\"clearfix\\\">\\n        <button data-action=\\\"test-launcher\\\" class=\\\"btn-info small rgt\\\">\";\n  if (helper = helpers.button) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.button); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</button>\\n    </div>\\n\\n    <ul class=\\\"plain results\\\"></ul>\\n\\n    <div class=\\\"status\\\">\\n        <h2></h2>\\n    </div>\\n\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n *\n * @author dieter <dieter@taotesting.com>\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/Diagnostic/diagnostic',[\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'ui/actionbar',\n    'ui/feedback',\n    'taoProctoring/component/breadcrumbs',\n    'taoClientDiagnostic/tools/diagnostic/diagnostic',\n    'tpl!taoProctoring/templates/diagnostic/main'\n], function ($, __, helpers, loadingBar, actionbar, feedback, breadcrumbsFactory, diagnosticFactory, diagnosticTpl) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.diagnostic-runner';\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Controls the taoProctoring readiness check page\n     *\n     * @type {Object}\n     */\n    var taoProctoringDiagnosticRunnerCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n            var $container = $(cssScope);\n            var $list = $container.find('.list');\n            var $panel = $('.panel');\n            var crumbs = $container.data('breadcrumbs');\n            var config = $container.data('config');\n            var testCenterId = $container.data('testcenter');\n            var indexUrl = helpers._url('index', 'Diagnostic', 'taoProctoring', {testCenter : testCenterId});\n            var workstationUrl = helpers._url('workstation', 'DiagnosticChecker', 'taoProctoring', {testCenter : testCenterId});\n\n            var bc = breadcrumbsFactory($container, crumbs);\n\n            /**\n             * Installs the diagnostic tool GUI\n             * @param {String} workstation\n             */\n            function installTester(workstation) {\n                diagnosticFactory(config)\n                    .setTemplate(diagnosticTpl)\n                    .on('render', function() {\n                        var self = this;\n\n                        // get access to the input\n                        this.controls.$workstation = this.getElement().find('[data-control=\"workstation\"]')\n                            .on('keypress', function (e) {\n                                if (e.which === 13) {\n                                    e.preventDefault();\n                                    self.run();\n                                }\n                            })\n                            .val(workstation);\n                    })\n                    .on('start', function() {\n                        // append the workstation name to the queries\n                        this.config.storeParams = this.config.storeParams || {};\n                        this.config.storeParams.workstation = this.controls.$workstation.val();\n\n                        // disable the input when running the test\n                        this.controls.$workstation.prop('disabled', true);\n                        loadingBar.start();\n                    })\n                    .on('end', function() {\n                        // enable the input when the test is complete\n                        this.controls.$workstation.removeProp('disabled');\n                        loadingBar.stop();\n                    })\n                    .on('render', function() {\n                        loadingBar.stop();\n                    })\n                    .render($list);\n            }\n\n            actionbar({\n                renderTo: $panel,\n                buttons: [{\n                    id: 'back',\n                    icon: 'step-backward',\n                    title: __('Return to the list'),\n                    label: __('List of readiness checks'),\n                    action: function() {\n                        window.location.href = indexUrl;\n                    }\n                }]\n            });\n\n            // need to known the workstation name to display it\n            $.get(workstationUrl, 'json')\n                .done(function(data) {\n                    installTester(data && data.workstation);\n                })\n                .fail(function() {\n                    feedback().error(__('Unable to get the workstation name!'));\n                    installTester();\n                });\n        }\n    };\n\n    return taoProctoringDiagnosticRunnerCtlr;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/Diagnostic/index',[\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'util/encode',\n    'ui/feedback',\n    'ui/dialog',\n    'taoProctoring/component/breadcrumbs',\n    'taoClientDiagnostic/tools/diagnostic/status',\n    'ui/datatable'\n], function ($, __, helpers, loadingBar, encode, feedback, dialog, breadcrumbsFactory, statusFactory) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.diagnostic-index';\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Format a number with decimals\n     * @param {Number} number - The number to format\n     * @param {Number} [digits] - The number of decimals\n     * @returns {Number}\n     */\n    function formatNumber(number, digits) {\n        var nb = undefined === digits ? 2 : Math.max(0, parseInt(digits, 10));\n        var factor = Math.pow(10, nb) || 1;\n        return Math.round(number * factor) / factor;\n    }\n\n    /**\n     * Controls the taoProctoring readiness check page\n     *\n     * @type {Object}\n     */\n    var taoProctoringDiagnosticCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n            var $container = $(cssScope);\n            var $list = $container.find('.list');\n            var crumbs = $container.data('breadcrumbs');\n            var dataset = $container.data('set');\n            var config = $container.data('config') || {};\n            var installedExtension = $container.data('installedextension') || false;\n            var testCenterId = $container.data('testcenter');\n            var diagnosticUrl = helpers._url('diagnostic', 'Diagnostic', 'taoProctoring', {testCenter : testCenterId});\n            var deliveryUrl = helpers._url('deliveriesByProctor', 'Diagnostic', 'taoProctoring', {testCenter : testCenterId});\n            var removeUrl = helpers._url('remove', 'Diagnostic', 'taoProctoring', {testCenter : testCenterId});\n            var serviceUrl = helpers._url('diagnosticData', 'Diagnostic', 'taoProctoring', {testCenter : testCenterId});\n\n            var performancesConfig = config.performances || {};\n            var performancesOptimal = performancesConfig.optimal;\n            var performancesRange = Math.abs(performancesOptimal - (performancesConfig.threshold));\n\n            var diagnosticStatus = statusFactory();\n\n            var bc = breadcrumbsFactory($container, crumbs);\n\n            var tools = [];\n            var actions = [];\n            var model = [];\n\n            // request the server with a selection of readiness check results\n            function request(url, selection, message) {\n                if (selection && selection.length) {\n                    loadingBar.start();\n\n                    $.ajax({\n                        url: url,\n                        data: {\n                            id: selection\n                        },\n                        dataType : 'json',\n                        type: 'POST',\n                        error: function() {\n                            loadingBar.stop();\n                        }\n                    }).done(function(response) {\n                        loadingBar.stop();\n\n                        if (response && response.success) {\n                            if (message) {\n                                feedback().success(message);\n                            }\n                            $list.datatable('refresh');\n                        } else {\n                            feedback().error(__('Something went wrong ...') + '<br>' + encode.html(response.error), {encodeHtml: false});\n                        }\n                    });\n                }\n            }\n\n            // request the server to remove the selected diagnostic-index\n            function remove(selection) {\n                request(removeUrl, selection, __('The readiness check result have been removed'));\n            }\n\n            // tool: page refresh\n            tools.push({\n                id: 'refresh',\n                icon: 'reset',\n                title: __('Refresh the page'),\n                label: __('Refresh'),\n                action: function() {\n                    $list.datatable('refresh');\n                }\n            });\n\n            // tool: readiness check\n            tools.push({\n                id: 'launch',\n                icon: 'play',\n                title: __('Launch another readiness check'),\n                label: __('Launch readiness check'),\n                action: function() {\n                    window.location.href = diagnosticUrl;\n                }\n            });\n\n            if(installedExtension){\n                // tool: compatibilty via lti\n                tools.push({\n                    id: 'lti',\n                    icon: 'play',\n                    title: __('Try a test delivery'),\n                    label: __('Try a test delivery'),\n                    action: function() {\n                        window.location.href = deliveryUrl;\n                    }\n                });\n            }\n\n            // tool: remove selected results\n            tools.push({\n                id: 'remove',\n                icon: 'remove',\n                title: __('Remove the selected readiness check results'),\n                label: __('Remove'),\n                massAction: true,\n                action: function(selection) {\n                    dialog({\n                        message: __('The selected readiness check results will be removed. Continue ?'),\n                        autoRender: true,\n                        autoDestroy: true,\n                        onOkBtn: function() {\n                            remove(selection);\n                        }\n                    });\n                }\n            });\n\n            // action: remove the result\n            actions.push({\n                id: 'remove',\n                icon: 'remove',\n                title: __('Remove the readiness check result?'),\n                action: function(id) {\n                    dialog({\n                        autoRender: true,\n                        autoDestroy: true,\n                        message: __('The readiness check result will be removed. Continue ?'),\n                        onOkBtn: function() {\n                            remove([id]);\n                        }\n                    });\n                }\n            });\n\n            // column: Workstation identifier\n            model.push({\n                id: 'workstation',\n                label: __('Workstation')\n            });\n\n            // column: Operating system information\n            model.push({\n                id: 'os',\n                label: __('OS')\n            });\n\n            // column: Browser information\n            model.push({\n                id: 'browser',\n                label: __('Browser')\n            });\n\n            // column: Performances of the workstation\n            model.push({\n                id: 'performance',\n                label: __('Performances'),\n                transform: function(value) {\n                    var cursor = performancesRange - value + performancesOptimal;\n                    var status = diagnosticStatus.getStatus(cursor / performancesRange * 100, 'performances');\n                    return status.feedback.message;\n                }\n            });\n\n            // column: Available bandwidth\n            model.push({\n                id: 'bandwidth',\n                label: __('Bandwidth'),\n                transform: function(value) {\n                    var bandwidth = formatNumber(value);\n\n                    if (value > 100) {\n                        bandwidth = '> 100';\n                    }\n\n                    return bandwidth + ' Mbs';\n                }\n            });\n\n            // column: Date of diagnostic\n            model.push({\n                id: 'date',\n                label: __('Date')\n            });\n\n            $list\n                .on('query.datatable', function() {\n                    loadingBar.start();\n                })\n                .on('load.datatable', function() {\n                    loadingBar.stop();\n                })\n                .datatable({\n                    url: serviceUrl,\n                    status: {\n                        empty: __('No readiness checks have been done!'),\n                        available: __('Readiness checks already done'),\n                        loading: __('Loading')\n                    },\n                    tools: tools,\n                    actions: actions,\n                    selectable: true,\n                    model: model\n                }, dataset);\n        }\n    };\n\n    return taoProctoringDiagnosticCtlr;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n\ndefine('taoProctoring/controller/Irregularity/index',[\n    'lodash',\n    'jquery',\n    'i18n',\n    'ui/feedback',\n    'layout/loading-bar',\n    'helpers',\n    'jquery.fileDownload'\n], function (_, $, __, feedback, loadingBar, helpers){\n    'use strict';\n\n    /**\n     * Controls the ProctorDelivery index page\n     *\n     * @type {Object}\n     */\n    var IrregularityCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start(){\n            var $form = $('#export-form');\n\n            $form.on('submit', function (e) {\n\n                e.stopPropagation();\n                e.preventDefault();\n                loadingBar.start();\n\n                var self = $(this),\n                    uri = $('[name=\"uri\"]', self).val(),\n                    from = $('[name=\"from\"]', self).val(),\n                    to = $('[name=\"to\"]', self).val(),\n                    params = {'uri': uri, 'from': from, 'to': to},\n                    exportUrl = helpers._url('exportIrregularities', 'Irregularity', 'taoProctoring', params);\n\n                $.fileDownload(exportUrl, {\n                    successCallback : function () {\n                        loadingBar.stop();\n                    },\n                    failCallback : function (jqXHR) {\n                        loadingBar.stop();\n                        var response = $.parseJSON($(jqXHR).text());\n                        if (response) {\n                            feedback().error(new Error(response.message));\n                        }\n                    }\n                });\n\n            });\n        }\n    };\n\n    return IrregularityCtlr;\n});\n\n","\ndefine('tpl!taoProctoring/component/proctorForm/form', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"proctor-form section-container\\\">\\n    <div class=\\\"content-block\\\">\\n        \";\n  if (helper = helpers.form) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.form); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </div>\\n</div>\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Sam <sam@taotesting.com>\n */\ndefine('taoProctoring/component/proctorForm',[\n    'lodash',\n    'jquery',\n    'i18n',\n    'helpers',\n    'users',\n    'ui/feedback',\n    'ui/component',\n    'taoProctoring/helper/textConverter',\n    'tpl!taoProctoring/component/proctorForm/form'\n], function(_, $, __, helpers, users, feedback, component, textConverter, formTpl){\n    'use strict';\n\n    var _ns = '.proctor-form';\n\n    //service urls:\n    var proctorFormUrl = helpers._url('createProctorForm', 'ProctorManager', 'taoProctoring');\n    var proctorLoginCheckUrl = helpers._url('checkLogin', 'ProctorManager', 'taoProctoring');\n    \n    //initialize legacy components\n    helpers.init();\n    \n    /**\n     * Render the form from the server provided data\n     * \n     * @param {JQuery} $container\n     * @param {Object} formData\n     */\n    function renderFormFromData($container, formData){\n        $container.html(formTpl({\n            form : formData.form\n        }));\n        users.checkLogin(formData.loginId, proctorLoginCheckUrl);\n    }\n    \n    /**\n     * Create a proctor creation form\n     * \n     * @param {type} config\n     * @param {JQuery} config.renderTo - the jQuery container it should be rendered to\n     * @param {Object} config.testCenterList - the test center list component\n     * @returns {proctorForm}\n     */\n    return function proctorFormFactory(config){\n\n        return component()\n            .on('destroy', function(){\n                this.getElement().off(_ns).empty();\n            })\n            .on('render', function(){\n\n                var self = this;\n                var $element = this.getElement();\n\n                textConverter().then(function(labels) {\n                    $.get(proctorFormUrl, function(formData){\n\n                        renderFormFromData($element, formData);\n\n                        $element.on('submit' + _ns, 'form', function(e){\n\n                            var $form = $(this);\n                            var fields = $form.serializeArray();\n                            var list = self.config.testCenterList;\n                            var data = {\n                                testCenters : list && list.getSelection()\n                            };\n                            _.each(fields, function(field){\n                                data[field.name] = field.value;\n                            });\n\n                            $.post(proctorFormUrl, data, function(res){\n                                if(res.created){\n                                    feedback().success(labels.get('Proctor created'));\n                                    self.destroy();\n                                }else{\n                                    renderFormFromData($element, res);\n                                }\n                            });\n\n                            e.preventDefault();\n                        }).on('click', 'button.btn-diasble', function() {\n                            self.destroy();\n                        });\n                    });\n                }).catch(function(err) {\n                   console.log(err);\n                });\n\n            })\n            .init(config);\n    };\n});\n\n","\ndefine('tpl!taoProctoring/templates/proctorManager/counters', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.count), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<div class=\\\"\";\n  if (helper = helpers.cls) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.cls); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"><span class=\\\"text\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>: <span class=\\\"count\\\">\";\n  if (helper = helpers.count) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.count); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span></div>\";\n  return buffer;\n  }\n\n  stack1 = helpers.each.call(depth0, depth0, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","\ndefine('tpl!taoProctoring/templates/proctorManager/status', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Authorized\", options) : helperMissing.call(depth0, \"__\", \"Authorized\", options)))\n    + \" <span class=\\\"icon icon-authorize\\\"></span>\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"<span title=\\\"\";\n  if (helper = helpers.testCenters) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.testCenters); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Partially authorized\", options) : helperMissing.call(depth0, \"__\", \"Partially authorized\", options)))\n    + \"</span>\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.authorized), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.partially), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Sam <sam@taotesting.com>\n */\ndefine('taoProctoring/controller/ProctorManager/index',[\n    'lodash',\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'util/encode',\n    'ui/feedback',\n    'ui/dialog/confirm',\n    'ui/bulkActionPopup',\n    'ui/datalist',\n    'taoProctoring/component/breadcrumbs',\n    'taoProctoring/component/proctorForm',\n    'taoProctoring/helper/textConverter',\n    'tpl!taoProctoring/templates/proctorManager/counters',\n    'tpl!taoProctoring/templates/proctorManager/status',\n    'ui/datatable'\n], function (_, $, __, helpers, loadingBar, encode, feedback, dialogConfirm, bulkActionPopup, datalist, breadcrumbsFactory, proctorForm, textConverter, counterTpl, statusTpl) {\n    'use strict';\n    \n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.proctorManager-index';\n    \n    //service urls:\n    var proctorsDataUrl = helpers._url('proctorAuthorizations', 'ProctorManager', 'taoProctoring');\n    var authorizeUrl = helpers._url('authorize', 'ProctorManager', 'taoProctoring');\n    var unauthorizeUrl = helpers._url('unauthorize', 'ProctorManager', 'taoProctoring');\n\n    // page modes\n    var _modes = {\n        EMPTY: 0,\n        LIST: 1,\n        FORM: 2\n    };\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Controls the ProctorDelivery index page\n     *\n     * @type {Object}\n     */\n    var taoProctoringCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n            textConverter().then(function(labels) {\n                var $container = $(cssScope);\n                var $panelSelection = $('.test-center-panel');\n                var $panelData = $('.proctor-panel');\n                var $containerList = $('.proctor-list');\n                var $containerForm = $('.proctor-create');\n                var $noSelection = $('.proctor-default');\n                var testCenters = $container.data('list');\n                var crumbs = $container.data('breadcrumbs');\n                var pageMode = _modes.EMPTY;\n                var bc = breadcrumbsFactory($container, crumbs);\n                var list = datalist({\n                    renderTo: $panelSelection,\n                    textNumber:  __('Test sites'),\n                    labelText: __('Test site'),\n                    selectable: true\n                }, testCenters);\n\n                function request(url, selection, message) {\n                    if (selection && selection.length) {\n                        loadingBar.start();\n\n                        $.ajax({\n                            url: url,\n                            data: {\n                                testCenters: list.getSelection(),\n                                proctors: selection\n                            },\n                            dataType : 'json',\n                            type: 'POST',\n                            error: function() {\n                                loadingBar.stop();\n                            }\n                        }).done(function(response) {\n                            loadingBar.stop();\n\n                            if (response && response.success) {\n                                if (message) {\n                                    feedback().success(message);\n                                }\n                                $containerList.datatable('refresh');\n                            } else {\n                                feedback().error(__('Something went wrong ...') + '<br>' + encode.html(response.error), {encodeHtml: false});\n                            }\n                        });\n                    }\n                }\n\n                function authorize(selection, message) {\n                    dialogConfirm(message, function() {\n                        request(authorizeUrl, selection, labels.get('Proctors authorized'));\n                    });\n                }\n\n                function revoke(selection, message) {\n                    dialogConfirm(message, function() {\n                        request(unauthorizeUrl, selection, labels.get('Proctors revoked'));\n                    });\n                }\n\n                function processMode(selection) {\n                    if (!selection.length) {\n                        if (_modes.LIST === pageMode) {\n                            pageMode = _modes.EMPTY;\n                        } else if (_modes.EMPTY !== pageMode) {\n                            feedback().warning(__('You must select at least one test center!'));\n                        }\n                    } else {\n                        switch (pageMode) {\n                            case _modes.EMPTY:\n                                pageMode = _modes.LIST;\n\n                            case _modes.LIST:\n                                $containerList\n                                    // erase previous parameters to prevent the datatable to keep old values\n                                    .datatable('options', {\n                                        params: {testCenters: null}\n                                    })\n                                    // set new parameter value\n                                    .datatable('options', {\n                                        params: {testCenters: selection}\n                                    })\n                                    .datatable('refresh');\n                                break;\n\n                            case _modes.FORM:\n                                // the form manages itself the selection\n                                break;\n                        }\n                    }\n\n                    $noSelection.toggleClass('hidden', _modes.EMPTY !== pageMode);\n                    $containerList.toggleClass('hidden', _modes.LIST !== pageMode);\n                    $containerForm.toggleClass('hidden', _modes.FORM !== pageMode);\n                }\n\n                list.on('select', function(selection) {\n                    processMode(selection);\n                });\n\n                $containerList\n                    .on('query.datatable', function() {\n                        loadingBar.start();\n                    })\n                    .on('load.datatable', function(e, dataset) {\n                        var partially = 0;\n                        var authorized = 0;\n                        var lines = dataset && dataset.data;\n                        _.forEach(lines, function(line) {\n                            if (line && line.status) {\n                                switch (line.status) {\n                                    case 1: partially ++; break;\n                                    case 2: authorized ++; break;\n                                }\n                            }\n\n                        });\n\n                        $(this).find('.datatable-wrapper h2').append(counterTpl([{\n                            id: 'authorized-list',\n                            label: labels.get('Authorized proctors'),\n                            count: authorized\n                        }, {\n                            id: 'partially-list',\n                            label: labels.get('Partially authorized proctors'),\n                            count: partially\n                        }]));\n\n                        loadingBar.stop();\n                    })\n                    .datatable({\n                        url: proctorsDataUrl,\n                        status: {\n                            empty: labels.get('No assigned proctors'),\n                            available: labels.get('Assigned proctors'),\n                            loading: __('Loading')\n                        },\n                        tools: [{\n                            id: 'refresh',\n                            icon: 'reset',\n                            title: __('Refresh the page'),\n                            label: __('Refresh'),\n                            action: function() {\n                                $containerList.datatable('refresh');\n                            }\n                        }, {\n                            id: 'create',\n                            icon: 'add',\n                            title: labels.get('Creates and authorizes proctor'),\n                            label: labels.get('Create Proctor'),\n                            action: function() {\n                                var selection = list.getSelection();\n                                // switch to proctorForm\n                                proctorForm({\n                                    renderTo : $containerForm,\n                                    testCenterList : list\n                                }).on('destroy', function() {\n                                    pageMode = _modes.LIST;\n                                    processMode(list.getSelection());\n                                });\n                                pageMode = _modes.FORM;\n                                processMode(selection);\n                            }\n                        }, {\n                            id: 'authorize',\n                            icon: 'authorize',\n                            title: labels.get('Authorize the selected proctors'),\n                            label: __('Authorize'),\n                            massAction: true,\n                            action: function(selection) {\n                                authorize(selection, labels.get('The proctors will be authorized. Continue ?'));\n                            }\n                        }, {\n                            id: 'revoke',\n                            icon: 'revoke',\n                            title: labels.get('Revoke authorization for the selected proctors'),\n                            label: __('Revoke'),\n                            massAction: true,\n                            action: function(selection) {\n                                revoke(selection, labels.get('The proctors will be revoked. Continue ?'));\n                            }\n                        }],\n                        actions: [{\n                            id: 'authorize',\n                            icon: 'authorize',\n                            title: labels.get('Authorize the proctor'),\n                            hidden: function() {\n                                return this.status === 2;\n                            },\n                            action: function(id) {\n                                authorize([id], labels.get('The proctor will be authorized. Continue ?'));\n                            }\n                        }, {\n                            id: 'revoke',\n                            icon: 'revoke',\n                            title: labels.get('Revoke the proctor'),\n                            hidden: function() {\n                                return !this.status;\n                            },\n                            action: function(id) {\n                                revoke([id], labels.get('The proctor will be revoked. Continue ?'));\n                            }\n                        }],\n                        selectable: true,\n                        model: [{\n                            id: 'firstname',\n                            label: __('First name')\n                        }, {\n                            id: 'lastname',\n                            label: __('Last name')\n                        }, {\n                            id: 'login',\n                            label: __('Login')\n                        }, {\n                            id: 'state',\n                            label: __('Status'),\n                            transform: function(value, row) {\n                                return statusTpl({\n                                    testCenters: row.authorized,\n                                    partially: row.status === 1,\n                                    authorized: row.status === 2\n                                });\n                            }\n                        }]\n                    }, []);\n\n                loadingBar.stop();\n            }).catch(function (err) {\n                console.error(err);\n            });\n        }\n    };\n\n    return taoProctoringCtlr;\n});\n\n","\ndefine('tpl!taoProctoring/component/dateRange/form', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<form class=\\\"daterange\\\">\\n    <label>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"From\", options) : helperMissing.call(depth0, \"__\", \"From\", options)))\n    + \"</label><input type=\\\"text\\\" name=\\\"periodStart\\\" value=\\\"\";\n  if (helper = helpers.start) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.start); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"/>\\n    <label>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"to\", options) : helperMissing.call(depth0, \"__\", \"to\", options)))\n    + \"</label><input type=\\\"text\\\" name=\\\"periodEnd\\\" value=\\\"\";\n  if (helper = helpers.end) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.end); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"/>\\n    <button class=\\\"small info\\\" data-control=\\\"filter\\\"><span class=\\\"icon icon-filter\\\"></span>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Filter\", options) : helperMissing.call(depth0, \"__\", \"Filter\", options)))\n    + \"</button>\\n</form>\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/component/dateRange',[\n    'jquery',\n    'lodash',\n    'ui/component',\n    'tpl!taoProctoring/component/dateRange/form',\n    'jquery.timePicker'\n], function ($, _, component, formTpl) {\n    'use strict';\n\n    /**\n     * Some default config\n     * @type {Object}\n     * @private\n     */\n    var _defaults = {\n        dateFormat: 'yy-mm-dd'\n    };\n\n    /**\n     * Creates a dates range with date pickers\n     *\n     * @param {Object} config\n     * @param {String} [config.start] - The initial start date (default: none)\n     * @param {String} [config.end] - The initial end date (default: none)\n     * @param {String} [config.dateFormat] - The date picker format (default: 'yy-mm-dd')\n     * @fires change when any date is changed\n     * @fires submit when the submit button is clicked\n     */\n    function dateRangeFactory(config){\n        var initConfig = _.defaults(config || {}, _defaults);\n        var periodStart = initConfig.start || '';\n        var periodEnd = initConfig.end || '';\n\n        var dateRange = {\n            /**\n             * Gets the start date of the range\n             * @returns {String}\n             */\n            getStart: function getStart() {\n                return periodStart;\n            },\n\n            /**\n             * Gets the end date of the range\n             * @returns {String}\n             */\n            getEnd: function getEnd() {\n                return periodEnd;\n            }\n        };\n\n        initConfig.start = periodStart;\n        initConfig.end = periodEnd;\n\n        return component(dateRange)\n            .setTemplate(formTpl)\n            .on('render', function() {\n                var self = this;\n                var $form = this.getElement();\n                var $periodStart = $form.find('input[name=periodStart]');\n                var $periodEnd = $form.find('input[name=periodEnd]');\n                var $filterBtn = $form.find('[data-control=\"filter\"]');\n\n                $periodStart.datepicker({\n                    dateFormat: initConfig.dateFormat,\n                    autoSize: true\n                }).change(function(){\n                    periodStart = $periodStart.val();\n                    $periodEnd.datepicker('option', 'minDate', periodStart);\n\n                    /**\n                     * @event change\n                     * @param {String} property\n                     * @param {String} value\n                     */\n                    self.trigger('change', 'start', periodStart);\n                });\n\n                $periodEnd.datepicker({\n                    dateFormat: initConfig.dateFormat,\n                    autoSize: true\n                }).change(function(){\n                    periodEnd = $periodEnd.val();\n                    $periodStart.datepicker('option', 'maxDate', periodEnd);\n\n                    /**\n                     * @event change\n                     * @param {String} property\n                     * @param {String} value\n                     */\n                    self.trigger('change', 'end', periodEnd);\n                });\n\n                $filterBtn.on('click', function(event) {\n                    event.preventDefault();\n\n                    periodStart = $periodStart.val();\n                    periodEnd = $periodEnd.val();\n\n                    /**\n                     * @event submit\n                     */\n                    self.trigger('submit');\n                });\n            })\n            .init(initConfig);\n    }\n\n    return dateRangeFactory;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/component/history/historyTable',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'ui/component',\n    'ui/datatable'\n], function ($, _, __, component) {\n    'use strict';\n\n    /**\n     * Some default config\n     * @type {Object}\n     * @private\n     */\n    var _defaults = {\n        sortBy: 'timestamp',\n        sortOrder: 'desc'\n    };\n\n    /**\n     * Renders the event details\n     * @param {String|Array} details\n     * @returns {String}\n     */\n    function renderDetails(details) {\n        if (_.isArray(details)) {\n            details = details.join('<br />');\n        }\n        return details;\n    }\n\n    /**\n     * Renders a history table\n     * @param {Object} config\n     * @param {String} config.service - The URL of the service providing the data\n     * @param {Object} [config.params] - A list of additional parameters to provide to the service\n     * @param {String} [config.sortBy] - The default sorted column\n     * @param {String} [config.sortOrder] - The default sort direction\n     * @param {Array} [config.tools] - A list of optional tools, using the datable format\n     * @param {Object} [data] - The first data set\n     * @returns {*}\n     */\n    function historyTableFactory(config, data) {\n        var initConfig = _.defaults(config || {}, _defaults);\n\n        // define some additional behavior\n        var historyTable = {\n            /**\n             * Refresh the table\n             * @param {Object} [params]\n             */\n            refresh: function refresh(params) {\n                var $element;\n\n                if (this.is('rendered')) {\n                    $element = this.getElement();\n                    if (params) {\n                        $element.datatable('options', {\n                            params: params\n                        });\n                    }\n                    $element.datatable('refresh');\n                } else {\n                    if (params) {\n                        initConfig.params = _.merge(initConfig.params, params);\n                    }\n                }\n            }\n        };\n\n        return component(historyTable)\n            .on('render', function() {\n                var self = this;\n                var tools = [{\n                    id: 'refresh',\n                    icon: 'reset',\n                    title: __('Refresh the page'),\n                    label: __('Refresh'),\n                    action: function() {\n                        self.refresh();\n                    }\n                }];\n                this.getElement()\n                    .on('query.datatable', function() {\n                        self.trigger('loading');\n                    })\n                    .on('load.datatable', function() {\n                        self.trigger('loaded');\n                    })\n                    .datatable({\n                        url: initConfig.service,\n                        params: initConfig.params,\n                        sortby: initConfig.sortBy,\n                        sortorder: initConfig.sortOrder,\n                        status: {\n                            empty: __('No history to display!'),\n                            available: __('Available history'),\n                            loading: __('Loading')\n                        },\n                        selectable: !!(initConfig.tools && _.find(initConfig.tools, {massAction: true})),\n                        tools: tools.concat(initConfig.tools || []),\n                        model: [{\n                            id: 'date',\n                            label: __('Date'),\n                            sortable: true\n                        }, {\n                            id: 'role',\n                            label: __('Role'),\n                            sortable: true\n                        }, {\n                            id: 'actor',\n                            label: __('Actor'),\n                            sortable: true\n                        }, {\n                            id: 'event',\n                            label: __('Event'),\n                            sortable: true\n                        }, {\n                            id: 'details',\n                            label: __('Details'),\n                            transform: renderDetails\n                        }, {\n                            id: 'context',\n                            label: __('Context'),\n                            transform: renderDetails\n                        }]\n                    }, data);\n            })\n            .init(initConfig);\n    }\n\n    return historyTableFactory;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/Reporting/history',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'util/encode',\n    'taoProctoring/component/dateRange',\n    'taoProctoring/component/history/historyTable',\n    'taoProctoring/component/breadcrumbs',\n    'ui/datatable'\n], function ($, _, __, helpers, loadingBar, encode, dateRangeFactory, historyTableFactory, breadcrumbsFactory) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.session-history';\n\n    /**\n     * Controls the taoProctoring session history page\n     *\n     * @type {Object}\n     */\n    var taoProctoringReportCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n            var $container = $(cssScope);\n            var dataset = $container.data('set');\n            var testCenterId = $container.data('testcenter');\n            var deliveryId = $container.data('delivery');\n            var sessions = $container.data('sessions');\n            var sortBy = $container.data('sortBy');\n            var sortOrder = $container.data('sortorder');\n            var periodStart = $container.data('periodstart');\n            var periodEnd = $container.data('periodEnd');\n            var serviceUrl = helpers._url('history', 'Reporting', 'taoProctoring', {testCenter : testCenterId, delivery : deliveryId, session: sessions});\n            var monitoringUrl = helpers._url('monitoring', 'Delivery', 'taoProctoring', {testCenter: testCenterId, delivery : deliveryId});\n            var monitoringAllUrl = helpers._url('monitoringAll', 'Delivery', 'taoProctoring', {testCenter: testCenterId});\n            var detailedHistory = false;\n\n            var historyTable = historyTableFactory({\n                    tools: [{\n                        id: 'back',\n                        icon: 'preview',\n                        title: __('Return to the session monitoring'),\n                        label: __('Monitoring'),\n                        action: function() {\n                            window.location.href = deliveryId ? monitoringUrl : monitoringAllUrl;\n                        }\n                    }, {\n                        id: 'show-detailed-report',\n                        icon: 'insert-horizontal-line',\n                        title: __('Show detailed session history messages'),\n                        label: __('Show detailed report'),\n                        action: function() {\n                            var tool = historyTable.config.tools.find(function (val) {return val.id === 'show-detailed-report'});\n\n                            historyTable.config.params.detailed = detailedHistory = !detailedHistory;\n                            tool.label = detailedHistory ? __('Show brief report') : __('Show detailed report');\n                            historyTable.refresh();\n                        }\n                    }],\n                    params: {detailed: detailedHistory},\n                    service: serviceUrl,\n                    sortBy: sortBy,\n                    sortOrder: sortOrder\n                }, dataset)\n                .on('loading', function() {\n                    loadingBar.start();\n                })\n                .on('loaded', function() {\n                    loadingBar.stop();\n                })\n                .render($container.find('.list'));\n\n            breadcrumbsFactory($container, $container.data('breadcrumbs'));\n\n            dateRangeFactory({\n                start : periodStart,\n                end : periodEnd,\n                renderTo: $container.find('.panel')\n            }).on('change submit', function() {\n                historyTable.refresh({\n                    periodStart : this.getStart(),\n                    periodEnd : this.getEnd()\n                });\n            });\n        }\n    };\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    return taoProctoringReportCtlr;\n});\n\n","\ndefine('tpl!taoProctoring/templates/testSiteAdmin/adminLink', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<a href=\\\"\";\n  if (helper = helpers.href) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.href); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"admin-link\\\">\\n    <span class=\\\"icon-users\\\"></span>\\n    \";\n  if (helper = helpers.manageProctorMenu) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.manageProctorMenu); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\n</a>\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/TestCenter/index',[\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'ui/listbox',\n    'taoProctoring/component/breadcrumbs',\n    'taoProctoring/helper/textConverter',\n    'tpl!taoProctoring/templates/testSiteAdmin/adminLink'\n], function ($, __, helpers, loadingBar, listBox, breadcrumbsFactory, textConverter, adminLinkTpl) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.testcenters-index';\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Controls the taoProctoring index page\n     *\n     * @type {Object}\n     */\n    var taoProctoringIndexCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n\n            textConverter().then(function(labels) {\n\n                var $container = $(cssScope);\n                var admin = $container.data('administrator');\n                var boxes = $container.data('list');\n                var crumbs = $container.data('breadcrumbs');\n                var list = listBox({\n                    title: __(\"My Test sites\"),\n                    textEmpty: __(\"No test site available\"),\n                    textNumber: __(\"Available\"),\n                    textLoading: __(\"Loading\"),\n                    renderTo: $container.find('.content'),\n                    replace: true\n                });\n                var bc = breadcrumbsFactory($container, crumbs);\n                var serviceUrl = helpers._url('index', 'TestCenter', 'taoProctoring');\n                var adminUrl = helpers._url('index', 'ProctorManager', 'taoProctoring');\n\n                // update the index from a JSON array\n                var update = function(boxes) {\n                    list.update(boxes);\n                    loadingBar.stop();\n                };\n\n                // refresh the index\n                var refresh = function() {\n                    loadingBar.start();\n                    list.setLoading(true);\n\n                    $.ajax({\n                        url: serviceUrl,\n                        cache: false,\n                        dataType : 'json',\n                        type: 'GET'\n                    }).done(function(response) {\n                        boxes = response && response.list;\n                        update(boxes);\n                    });\n                };\n\n                if (!boxes) {\n                    refresh();\n                } else {\n                    update(boxes);\n                }\n\n                if(admin){\n                    //add test center admin link\n                    $container.find('.header').append(adminLinkTpl({\n                        href : adminUrl,\n                        manageProctorMenu : labels.get('Manage Proctors')\n                    }));\n                }\n            }).catch(function (err) {\n                console.log(err);\n            });\n        }\n    };\n\n    return taoProctoringIndexCtlr;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoProctoring/controller/TestCenter/testCenter',[\n    'jquery',\n    'i18n',\n    'helpers',\n    'layout/loading-bar',\n    'ui/listbox',\n    'taoProctoring/component/breadcrumbs'\n], function ($, __, helpers, loadingBar, listBox, breadcrumbsFactory) {\n    'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.testcenters-testcenter';\n\n    // the page is always loading data when starting\n    loadingBar.start();\n\n    /**\n     * Controls the taoProctoring test site page\n     *\n     * @type {Object}\n     */\n    var taoProctoringTestSiteCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start() {\n            var $container = $(cssScope);\n            var boxes = $container.data('list');\n            var crumbs = $container.data('breadcrumbs');\n            var id = $container.data('id');\n            var title = $container.data('title');\n            var list = listBox({\n                title: title,\n                textEmpty: false,\n                textNumber: false,\n                textLoading: __(\"Loading\"),\n                renderTo: $container.find('.content'),\n                replace: true,\n                width: 12\n            });\n            var bc = breadcrumbsFactory($container, crumbs);\n            var serviceUrl = helpers._url('testCenter', 'TestCenter', 'taoProctoring');\n\n            // update the index from a JSON array\n            var update = function(boxes) {\n                list.update(boxes);\n                loadingBar.stop();\n            };\n\n            // refresh the index\n            var refresh = function() {\n                loadingBar.start();\n                list.setLoading(true);\n\n                $.ajax({\n                    url: serviceUrl,\n                    cache: false,\n                    dataType : 'json',\n                    type: 'GET'\n                }).done(function(response) {\n                    boxes = response && response.list;\n                    update(boxes);\n                });\n            };\n\n            if (!boxes) {\n                refresh();\n            } else {\n                update(boxes);\n            }\n        }\n    };\n\n    return taoProctoringTestSiteCtlr;\n});\n\n","\ndefine('tpl!taoProctoring/component/eligibilityEditor/layout', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \" editing\";\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"flex-col-12\";\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"flex-col-6\";\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"for\", options) : helperMissing.call(depth0, \"__\", \"for\", options)))\n    + \" <span class=\\\"delivery-name\\\">\";\n  if (helper = helpers.deliveryName) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.deliveryName); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span> :\";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"eligibility-editor\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.editingMode), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\n    <h2 class=\\\"title\\\">\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h2>\\n\\n    <div class=\\\"flex-grid \\\">\\n        <div class=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.editingMode), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" tree-container eligible-delivery\\\">\\n            <label>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Eligible Deliveries\", options) : helperMissing.call(depth0, \"__\", \"Eligible Deliveries\", options)))\n    + \"</label>\\n                <div id=\\\"\";\n  if (helper = helpers.deliveryTreeId) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.deliveryTreeId); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></div>\\n        </div>\\n        <div class=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.editingMode), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" tree-container eligible-testTaker\\\">\\n            <label>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Eligible Test Takers\", options) : helperMissing.call(depth0, \"__\", \"Eligible Test Takers\", options)))\n    + \" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.editingMode), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</label>\\n                <div id=\\\"\";\n  if (helper = helpers.subjectTreeId) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.subjectTreeId); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></div>\\n        </div>\\n    </div>\\n    <div class=\\\"actions\\\">\\n        <button class=\\\"btn btn-info small done\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"OK\", options) : helperMissing.call(depth0, \"__\", \"OK\", options)))\n    + \"</button>\\n        <a href=\\\"#\\\" class=\\\"btn cancel\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"cancel the action\", options) : helperMissing.call(depth0, \"__\", \"cancel the action\", options)))\n    + \"\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"cancel\", options) : helperMissing.call(depth0, \"__\", \"cancel\", options)))\n    + \"</a>\\n    </div>\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('css!taoProctoringCss/eligibilityEditor',[],function(){});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n *\n */\ndefine('taoProctoring/component/eligibilityEditor',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'helpers',\n    'uri',\n    'ui/component',\n    'generis.tree.select',\n    'tpl!taoProctoring/component/eligibilityEditor/layout',\n    'ui/feedback',\n    'ui/modal',\n    'css!taoProctoringCss/eligibilityEditor'\n], function($, _, __, helpers, uri, component, GenerisTreeSelectClass, layoutTpl, feedback){\n    'use strict';\n\n    var _ns = '.eligibility-editor';\n\n    var _modalDefaults = {\n        width : 600\n    };\n\n    var config = {\n        dataUrl :  helpers._url('getData', 'GenerisTree', 'tao')\n    };\n\n    /**\n     * Create an eligibility editor into a $container\n     *\n     * @param {JQuery} $container\n     * @param {Array} eligibilities\n     * @param {Object} [delivery]\n     * @param {String} [delivery.label]\n     * @param {String} [delivery.uri]\n     * @returns {Object} the eligibility editor instance\n     */\n    var eligibilityEditorFactory = function eligibilityEditorFactory() {\n\n        var eligibilityEditor;\n\n        var testTakerTreeId = _.uniqueId('eligible-testTaker-tree-');//generating the generis tree id, because it requires one to work\n        var deliveryTreeId  = _.uniqueId('eligible-delivery-tree-');//generating the generis tree id, because it requires one to work\n\n        /**\n         * Builds a tree to select test takers\n         *\n         * @param {String} id - the tree identifier, use to get the DOM node to put the tree\n         * @param {String} url - the tree data url\n         * @param {Array} [testTakers] - array of currently selected test takers\n         * @returns {tree} the created tree\n         */\n        var buildTestTakerTree = function buildTestTakerTree(id, url, testTakers){\n\n            var selected = _.pluck(testTakers, 'uri');\n\n            return new GenerisTreeSelectClass('#' + id, url, {\n                actionId : 'treeOptions.actionId',\n                saveUrl : 'treeOptions.saveUrl',\n                saveData : {},\n                checkedNodes : _.map(selected, uri.encode), //generis tree uses \"encoded uri\" to check nodes\n                serverParameters : {\n                    openParentNodes : selected, //generis tree uses normal if to open nodes...\n                    rootNode : 'http://www.tao.lu/Ontologies/TAOSubject.rdf#Subject'\n                },\n                paginate : 10\n            });\n        };\n\n        /**\n         * Builds a tree to select deliveries\n         *\n         * @param {String} id - the tree identifier, use to get the DOM node to put the tree\n         * @param {String} url - the tree data url\n         * @param {Array} [deliveries] - array of currently selected deliveris\n         * @returns {tree} the created tree\n         */\n        var buildDeliveryTree = function buildDeliveryTree(id, url, deliveries){\n\n            var selected = _.pluck(deliveries, 'uri');\n            return new GenerisTreeSelectClass('#' + id, url, {\n                actionId : 'treeOptions.actionId',\n                saveUrl : 'treeOptions.saveUrl',\n                saveData : {},\n                checkedNodes : _.map(selected, uri.encode), //generis tree uses \"encoded uri\" to check nodes\n                serverParameters : {\n                    openParentNodes : selected, //generis tree uses normal if to open nodes...\n                    rootNode : 'http://www.tao.lu/Ontologies/TAODelivery.rdf#AssembledDelivery'\n                },\n                paginate : 10\n            });\n        };\n\n        /**\n         * Destroy the modal\n         *\n         * @param {object} instance\n         * @returns {undefined}\n         */\n        var destroyModal = function destroyModal(){\n            if(eligibilityEditor && eligibilityEditor.getElement()){\n                eligibilityEditor.getElement()\n                    .modal('destroy')\n                    .remove();\n            }\n        };\n\n        /**\n         * Add the editor into a popup and display it\n         *\n         * @param {Object} [modalConfig] - any config option available in ui/modal\n         */\n        var initModal = function initModal(modalConfig){\n            modalConfig = _.defaults(modalConfig || {}, _modalDefaults);\n\n            if(eligibilityEditor && eligibilityEditor.getElement()){\n                eligibilityEditor.getElement()\n                    .addClass('modal')\n                    .on('closed.modal', destroyModal)\n                    .modal(modalConfig);\n            }\n        };\n\n        /**\n         * The eligibiltiyEditor API\n         */\n        var api = {\n\n            /**\n             * Add eligibilities\n             * @param {jQueryElement} $container - where to append the component\n             * @param {Object} [options]\n             * @param {String} [options.dataUrl] - to define where the tree data are retrieved\n             * @returns {eligibilityEditor} chains the component\n             * @fires eligibilityEditor#ok with the selected eligibities in parameter\n             * @fires eligibilityEditor#cancel\n             */\n            add : function add($container, options){\n                return this.on('render', function(){\n                    var self = this;\n                    var deliveryTree;\n                    var testTakerTree;\n\n                    options = _.defaults(options || {}, this.config);\n\n                    deliveryTree = buildDeliveryTree(deliveryTreeId, options.dataUrl);\n                    testTakerTree = buildTestTakerTree(testTakerTreeId, options.dataUrl);\n\n                    initModal({\n                        width : 650\n                    });\n\n                    this.$component\n                        .on('click' + _ns, '.actions .done', function(e){\n\n                            var deliveries = _(deliveryTree.getChecked()).uniq().compact().value();\n                            var testTakers = _(testTakerTree.getChecked()).uniq().compact().value();\n\n                            if( deliveries && deliveries.length){\n                                self.trigger('ok', {\n                                    deliveries: deliveries,\n                                    testTakers: testTakers\n                                });\n                                destroyModal();\n                            } else {\n                                feedback(self.$component).warning(__('At least one delivery need to be selected to create'));\n                            }\n\n                        }).on('click' + _ns, '.actions .cancel', function(e){\n                            e.preventDefault();\n                            destroyModal();\n                            self.trigger('cancel');\n                        });\n                   this.trigger('open');\n                })\n                .init({\n                    title :  __('Add Eligibility'),\n                    editingMode : false,\n                    subjectTreeId : testTakerTreeId,\n                    deliveryTreeId : deliveryTreeId,\n                })\n                .render($container);\n\n            },\n\n            /**\n             * Add eligibilities\n             * @param {jQueryElement} $container - where to append the component\n             * @param {String} deliveryName - the name of the eligibility's deliveryA\n             * @param {Array} testTakers - the test takers already selected\n             * @param {Object} [options]\n             * @param {String} [options.dataUrl] - to define where the tree data are retrieved\n             * @returns {eligibilityEditor} chains the component\n             * @fires eligibilityEditor#ok with the selected test takers in parameter\n             * @fires eligibilityEditor#cancel\n             */\n            edit : function edit($container, deliveryName, testTakers, options){\n                return this.on('render', function(){\n                    var self = this;\n                    var testTakerTree;\n\n                    options = _.defaults(options || {}, this.config);\n\n                    testTakerTree = buildTestTakerTree(testTakerTreeId, options.dataUrl, testTakers);\n\n                    initModal({\n                        width : 400\n                    });\n\n                    this.$component\n                        .on('click' + _ns, '.actions .done', function(e){\n\n                            var testTakers = _(testTakerTree.getChecked()).uniq().compact().value();\n                            self.trigger('ok', {\n                                testTakers : testTakers\n                            });\n                            destroyModal();\n\n                        }).on('click' + _ns, '.actions .cancel', function(e){\n                            e.preventDefault();\n                            destroyModal();\n                            self.trigger('cancel');\n                        });\n\n                   this.trigger('open');\n                })\n                .init({\n                    title :  __('Edit Eligibility'),\n                    editingMode : true,\n                    subjectTreeId : testTakerTreeId,\n                    deliveryTreeId : deliveryTreeId,\n                    deliveryName : deliveryName\n                })\n                .render($container);\n            }\n        };\n\n        //creates the component here\n        eligibilityEditor = component(api, config).setTemplate(layoutTpl);\n\n        return eligibilityEditor;\n    };\n\n    return eligibilityEditorFactory;\n});\n\n","\ndefine('tpl!taoProctoring/component/eligibilityTable/status', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n    <span class=\\\"icon-unshield txt-danger\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This delivery can be launched without authorization\", options) : helperMissing.call(depth0, \"__\", \"This delivery can be launched without authorization\", options)))\n    + \"\\\"></span>\\n\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n    <span class=\\\"icon-shield txt-success\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This delivery needs proctor authorization\", options) : helperMissing.call(depth0, \"__\", \"This delivery needs proctor authorization\", options)))\n    + \"\\\"></span>\\n\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.byPassProctor), {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoProctoring/component/eligibilityTable/actions', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n    <button class=\\\"btn-info small edit\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Enable proctor authorization\", options) : helperMissing.call(depth0, \"__\", \"Enable proctor authorization\", options)))\n    + \"\\\" data-action=\\\"shield\\\">\\n        <span class=\\\"icon-shield\\\"></span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Proctor\", options) : helperMissing.call(depth0, \"__\", \"Proctor\", options)))\n    + \"\\n    </button>\\n\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n    <button class=\\\"btn-info small edit\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove proctor authorization\", options) : helperMissing.call(depth0, \"__\", \"Remove proctor authorization\", options)))\n    + \"\\\" data-action=\\\"unshield\\\">\\n        <span class=\\\"icon-unshield\\\"></span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Un-Proctor\", options) : helperMissing.call(depth0, \"__\", \"Un-Proctor\", options)))\n    + \"\\n    </button>\\n\";\n  return buffer;\n  }\n\n  buffer += \"<button class=\\\"btn-info small edit\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Edit eligibile test takers\", options) : helperMissing.call(depth0, \"__\", \"Edit eligibile test takers\", options)))\n    + \"\\\" data-action=\\\"edit\\\">\\n    <span class=\\\"icon-edit\\\"></span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Edit\", options) : helperMissing.call(depth0, \"__\", \"Edit\", options)))\n    + \"\\n</button>\\n\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.byPassProctor), {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\\n<button class=\\\"btn-info small remove\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove eligibility\", options) : helperMissing.call(depth0, \"__\", \"Remove eligibility\", options)))\n    + \"\\\" data-action=\\\"remove\\\">\\n    <span class=\\\"icon-bin\\\"></span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove\", options) : helperMissing.call(depth0, \"__\", \"Remove\", options)))\n    + \"\\n</button>\\n\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('css!taoProctoringCss/eligibilityTable',[],function(){});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n *\n */\n\n/**\n * The eligibility table component.\n *\n * Manages a list of eligibilties.\n *\n * As this is mainly a refactoring, I've kept the data as they were and\n * the format used is inconsistent across the different calls...\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoProctoring/component/eligibilityTable',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'ui/component',\n    'helpers',\n    'tpl!taoProctoring/component/eligibilityTable/status',\n    'tpl!taoProctoring/component/eligibilityTable/actions',\n    'css!taoProctoringCss/eligibilityTable.css',\n    'ui/datatable'\n], function($, _, __, component, helpers, statusTpl, actionsTpl){\n    'use strict';\n\n\n    /**\n     * Creates the eligibilityTable component\n     *\n     * @param {String} testCenterId - the test center URI\n     * @returns {eligibilityTable} the component\n     * @throws {TypeError} without a test center\n     */\n    var eligibilityTableFactory = function eligibilityTableFactory(testCenterId){\n        var eligibilities = [];\n\n        if(_.isEmpty(testCenterId)){\n            throw new TypeError('The eligibility provider needs to be initialized with a test center');\n        }\n\n        /**\n         * The component.\n         *\n         * @typedef eligibilityTable\n         * @see ui/component\n         * @throws eligibilityTable#loading while loading something\n         * @throws eligibilityTable#loaded when loading is done\n         * @throws eligibilityTable#render once mounted to the DOM\n         * @throws eligibilityTable#add action\n         * @throws eligibilityTable#edit action\n         * @throws eligibilityTable#remove action\n         * @throws eligibilityTable#shield action\n         * @throws eligibilityTable#unshield action\n         */\n        return component({}, {\n                //config can be changed\n                dataUrl : helpers._url('getEligibilities', 'TestCenterManager', 'taoProctoring', { uri : testCenterId })\n            })\n            .on('render', function(){\n                var self = this;\n\n                //set up the ui/datatable\n                this.$component\n                    .on('query.datatable', function(){\n                        self.trigger('loading');\n                    })\n                    .on('load.datatable', function(e){\n                        self.trigger('loaded');\n                    })\n                    .on('beforeload.datatable', function(e, dataSet){\n                        if(dataSet && dataSet.data){\n                            eligibilities = dataSet.data;\n                        }\n                    })\n                    .datatable({\n                        url : this.config.dataUrl,\n                        status : {\n                            empty:     __('No Eligible Delivery yet'),\n                            available: __('Eligible Deliveries'),\n                            loading:   __('Loading')\n                        },\n                        tools : [{\n                            id : 'add',\n                            icon : 'add',\n                            title : __('Add'),\n                            label : __('Add'),\n                            action : function(){\n\n                                /**\n                                 * Add action\n                                 * @event eligibilityTable#add\n                                 * @param {Object} eligibilities\n                                 */\n                                self.trigger('add', eligibilities);\n                            }\n                        }],\n                        model : [{\n                            id : 'status',\n                            label : '',\n                            transform: function(value, row){\n                                return statusTpl(row);\n                            }\n                        }, {\n                            id : 'deliveryLabel',\n                            label : __('Delivery'),\n                            transform : function(value, row){\n                                return row.delivery.label;\n                            }\n                        }, {\n                            id : 'testTakersCount',\n                            label : __('Eligible Test Takers'),\n                            transform : function(value, row){\n                                return row.testTakers && row.testTakers.length ? row.testTakers.length : 0;\n                            }\n                        }, {\n                            id: 'actions',\n                            label: __('Actions'),\n                            transform: function(value, row){\n                                return actionsTpl(row);\n                            }\n                        }],\n                        selectable : false\n                    }).on('click', '.actions button', function(e){\n                        e.preventDefault();\n\n                        var $button = $(this);\n                        var itemId = $button.parents('[data-item-identifier]').data('item-identifier');\n                        var action = $button.data('action');\n\n                        self.trigger(action, itemId, eligibilities);\n                    });\n\n            })\n            .on('reload', function(){\n                if(this.$component){\n                    this.$component.datatable('refresh');\n                }\n            });\n    };\n\n    return eligibilityTableFactory;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n\n/**\n * The eligibility provider, interface to communicate eligibility data.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoProctoring/provider/eligibility',[\n    'jquery',\n    'lodash',\n    'helpers',\n    'core/promise'\n], function($, _, helpers, Promise){\n    'use strict';\n\n    /**\n     * Performs an ajax request on the right controller\n     * @param {String} action - the action name to call\n     * @param {Object} parameters - the data to send\n     * @returns {jQuery.Deferred} the ajax call\n     */\n    var request = function request(action, parameters){\n        return $.ajax({\n            url : helpers._url(action, 'TestCenterManager', 'taoProctoring'),\n            data :  parameters,\n            dataType : 'json',\n            type : 'POST'\n        });\n    };\n\n\n    /**\n     * Creates an eligibilityProvider\n     * @param {String} testCenterId - every call is contextualized for a test center\n     * @returns {eligibilityProvider} the provider\n     * @throws {TypeError} is the test center is missing\n     */\n    return function eligibilityProviderFactory(testCenterId) {\n        if(_.isEmpty(testCenterId)){\n            throw new TypeError('The eligibility provider needs to be initialized with a test center');\n        }\n\n        /**\n         * The new provider\n         * @typedef eligibilityProvider\n         */\n        return {\n\n            /**\n             * Add a new eligibilities\n             *\n             * @param {Object} eligibility - the eligibility to add\n             * @param {String[]} eligibility.deliveries - the deliveries URIs\n             * @param {String[]} eligibility.testTakers - the test takers URIs\n             * @returns {Promise} that resolves once the eligibilities are added\n             */\n            addEligibilities : function addEligibilities (eligibilities){\n                return new Promise(function (resolve, reject){\n                    if( !_.isPlainObject(eligibilities) ) {\n                        return reject(new TypeError('Invalid eligibility'));\n                    }\n\n                    request('addEligibilities', {\n                        uri : testCenterId,\n                        eligibility : eligibilities\n                    })\n                    .success(resolve)\n                    .fail(function(xhr){\n                        return reject(new Error(xhr.responseText));\n                    });\n                });\n            },\n\n            /**\n             * Edit an eligibility\n             *\n             * @param {Object} eligibility - the eligibility to add\n             * @param {String[]} eligibility.deliveries - the deliveries URIs\n             * @param {String[]} eligibility.testTakers - the test takers URIs\n             * @returns {Promise} that resolves once the eligibility is edited\n             */\n            editEligibility : function editEligibility(eligibility){\n\n                return new Promise(function (resolve, reject){\n                    if( !_.isPlainObject(eligibility) ) {\n                        return reject(new TypeError('Invalid eligibility'));\n                    }\n\n                    request('editEligibilities', {\n                        uri : testCenterId,\n                        eligibility : eligibility\n                    })\n                    .success(resolve)\n                    .fail(function(xhr){\n                        return reject(new Error(xhr.responseText));\n                    });\n                });\n            },\n\n            /**\n             * Remove an eligibility\n             *\n             * @param {Object} eligibility - the eligibility to add\n             * @param {String[]} eligibility.deliveries - the deliveries URIs\n             * @returns {Promise} that resolves once the eligibility is removed\n             */\n            removeEligibility : function removeEligibility(eligibility){\n\n                return new Promise(function (resolve, reject){\n                    if( !_.isPlainObject(eligibility) ) {\n                        return reject(new TypeError('Invalid eligibility'));\n                    }\n\n                    request('removeEligibilities', {\n                        uri : testCenterId,\n                        eligibility : eligibility\n                    })\n                    .success(resolve)\n                    .fail(function(xhr){\n                        return reject(new Error(xhr.responseText));\n                    });\n                });\n            },\n\n            /**\n             * Shield an eligibility\n             *\n             * @param {String} eligibilityId - the eligibility URI\n             * @returns {Promise} that resolves once the eligibility is shielded\n             */\n            shieldEligibility : function shieldEligibility(eligibilityId){\n                return new Promise(function (resolve, reject){\n                    if( !_.isString(eligibilityId) ) {\n                        reject(new TypeError('Invalid eligibility'));\n                    }\n\n                    request('shieldEligibility', {\n                        uri : testCenterId,\n                        eligibility : eligibilityId\n                    })\n                    .success(resolve)\n                    .fail(function(xhr){\n                        return reject(new Error(xhr.responseText));\n                    });\n                });\n            },\n\n            /**\n             * Unshield an eligibility\n             *\n             * @param {String} eligibilityId - the eligibility URI\n             * @returns {Promise} that resolves once the eligibility is unshielded\n             */\n            unshieldEligibility : function unshieldEligibility(eligibilityId){\n                return new Promise(function (resolve, reject){\n                    if( !_.isString(eligibilityId) ) {\n                        reject(new TypeError('Invalid eligibility'));\n                    }\n\n                    request('unshieldEligibility', {\n                        uri : testCenterId,\n                        eligibility : eligibilityId\n                    })\n                    .success(resolve)\n                    .fail(function(xhr){\n                        return reject(new Error(xhr.responseText));\n                    });\n                });\n            }\n        };\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\ndefine('taoProctoring/controller/TestCenterManager/editCenter',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'layout/loading-bar',\n    'ui/feedback',\n    'taoProctoring/component/eligibilityEditor',\n    'taoProctoring/component/eligibilityTable',\n    'taoProctoring/provider/eligibility'\n], function( $, _, __, loadingBar, feedback, eligibilityEditorFactory, eligibilityTableFactory, eligibilityProvider ){\n'use strict';\n\n    /**\n     * The CSS scope\n     * @type {String}\n     */\n    var cssScope = '.eligible-deliveries';\n\n    /**\n     * Controls the test center manager screen\n     *\n     * @type {Object}\n     */\n    var editCenterCtlr = {\n        /**\n         * Entry point of the page\n         */\n        start : function start(){\n\n            var eligibilityTable;\n            var $container = $(cssScope);\n            var $tableContainer = $('.eligibility-table-container', $container);\n            var $editorContainer = $('.eligibility-editor-container', $container);\n\n            //get the test center id from the DOM\n            var testCenterId = $container.data('testcenter');\n\n            /**\n             * Start the loading bar\n             */\n            var loading = function loading(){\n                loadingBar.start();\n            };\n\n            /**\n             * Stop the loading bar\n             */\n            var loaded = function loaded(){\n                loadingBar.stop();\n            };\n\n            /**\n             * Handle errors\n             * @param {Error} err - the error to handle\n             */\n            var handleError = function handleError(err){\n                loaded();\n                feedback().error(err.message);\n            };\n\n            /**\n             * Handle successful operations\n             * @param {String} message - the message to display\n             */\n            var success = function success(message){\n                loaded();\n                feedback().success(message);\n                eligibilityTable.trigger('reload');\n            };\n\n            //setup the eligibility table\n            eligibilityTable =\n              eligibilityTableFactory(testCenterId)\n                .on('loading', loading)\n                .on('loaded', loaded)\n                .on('add', function handleAddAction(){\n                    var self = this;\n\n                    //show the editor to select deliveries and test takers\n                    eligibilityEditorFactory()\n                        .add($editorContainer)\n                        .on('ok', function(eligibility){\n\n                            //then inform the server\n                            loading();\n                            eligibilityProvider(testCenterId)\n                                .addEligibilities(eligibility)\n                                .then(function(response){\n\n                                    loaded();\n                                    if(response.failed && response.failed.length){\n                                        feedback().warning(__('The following delivery(ies) are already eligible : ') + response.failed.join(', '));\n                                    } else {\n                                        feedback().success(__('New eligible delivery added'));\n                                    }\n                                    self.trigger('reload');\n                                })\n                                .catch(handleError);\n                        });\n                })\n                .on('edit', function handleEditAction(eligibilityId, eligibilities) {\n\n                    //show the editor to edit  test takers\n                    var eligibility = _.find(eligibilities, { uri : eligibilityId });\n                    //eligibilityEditor\n                        //.init($editorContainer, eligibilities, eligibility.delivery)\n                    eligibilityEditorFactory()\n                        .edit($editorContainer, eligibility.delivery.label, eligibility.testTakers)\n                        .on('ok', function(updated){\n\n                            loading();\n                            eligibilityProvider(testCenterId)\n                                .editEligibility({\n                                    deliveries : [eligibility.delivery.uri],\n                                    testTakers : updated.testTakers\n                                })\n                                .then(function(response){\n                                    success(__('Eligible test takers updated'));\n                                })\n                                .catch(handleError);\n                        });\n                })\n\n                .on('remove', function handleRemoveAction(eligibilityId, eligibilities) {\n                    var eligibility = _.find(eligibilities, { uri : eligibilityId });\n\n                    loading();\n                    eligibilityProvider(testCenterId)\n                        .removeEligibility({\n                            deliveries: [eligibility.delivery.uri]\n                        })\n                        .then(function(){\n                            success(__('Eligible delivery removed'));\n                        })\n                        .catch(handleError);\n                })\n\n                .on('shield', function handleShieldAction(eligibilityId) {\n                    loading();\n                    eligibilityProvider(testCenterId)\n                        .shieldEligibility(eligibilityId)\n                        .then(function(){\n                            success(__('Eligibility needs proctor authorization'));\n                        })\n                        .catch(handleError);\n                })\n\n                .on('unshield', function handleUnshieldAction(eligibilityId) {\n                    loading();\n                    eligibilityProvider(testCenterId)\n                        .unshieldEligibility(eligibilityId)\n                        .then(function(){\n                            success(__('Eligibility don\\'t need proctor authorization any more.'));\n                        })\n                        .catch(handleError);\n                })\n                .init({})\n                .render($tableContainer);\n        }\n    };\n\n    return editCenterCtlr;\n});\n\n","\n(function(c){var d=document,a='appendChild',i='styleSheet',s=d.createElement('style');s.type='text/css';d.getElementsByTagName('head')[0][a](s);s[i]?s[i].cssText=c:s[a](d.createTextNode(c));})\n('.diagnostics-main-area{max-width:768px;margin:40px auto 0 auto;background:#f3f1ef;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;padding:20px}.diagnostics-main-area h1,.diagnostics-main-area h2,.diagnostics-main-area h3{font-style:normal;font-family:\\\"Century Gothic\\\",CenturyGothic,AppleGothic,sans-serif}.diagnostics-main-area h1{margin-bottom:20px;font-size:20px;font-size:2rem}.diagnostics-main-area h2{margin:0;font-size:14px;font-size:1.4rem}.diagnostics-main-area h3{margin-top:10px;margin-bottom:5px;font-size:12px;font-size:1.2rem}.diagnostics-main-area .status h2,.diagnostics-main-area .details h2{margin:1rem 0}.diagnostics-main-area .legend{font-style:italic;font-weight:normal;font-family:\\\"Century Gothic\\\",CenturyGothic,AppleGothic,sans-serif;font-size:11px;font-size:1.1rem}.diagnostics-main-area .quality-bar{height:15px;background:linear-gradient(to right, #CE1431 0%, #D57915 25%, #D5A215 50%, #D5CB15 75%, #36B111 100%);opacity:.8;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;margin:5px 0 10px;position:relative}.diagnostics-main-area .quality-indicator{position:absolute;border-width:10px 8px;border-style:solid;border-color:#333 transparent transparent;top:-1px;height:25px;width:0}.diagnostics-main-area .quality-indicator[title]:before{font-size:11px;font-size:1.1rem;content:attr(title);position:absolute;top:-36px;left:-12px;text-align:center;width:24px;height:24px;line-height:24px;display:inline-block;background-color:#0e5d91;color:rgba(255,255,255,0.9);-moz-border-radius:12px;-webkit-border-radius:12px;border-radius:12px}.diagnostics-main-area .quality-indicator.wide[title]:before{left:-16px;width:32px}.diagnostics-main-area [data-result],.diagnostics-main-area .bandwidth-box{display:none}.diagnostics-main-area [data-action=bandwidth-launcher]{margin:5px 0 10px}.diagnostics-main-area li{padding-bottom:10px}.diagnostics-main-area .intro{margin-bottom:20px}.diagnostics-main-area table.matrix{border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;margin-top:5px}table.datatable [class^=\\\"icon-\\\"]{padding:0}table.datatable td{font-size:90%;font-weight:normal}table.datatable .progress .state:not(:first-child):before{content:\\' - \\'}table.datatable .progress .item-time:before{content:\\' (\\'}table.datatable .progress .item-time .total:before{content:\\' / \\'}table.datatable .progress .item-time:after{content:\\')\\'}.diagnostic-scope h1{font-family:\\\"Century Gothic\\\",CenturyGothic,AppleGothic,sans-serif;font-size:22px;font-size:2.2rem;font-weight:normal}.diagnostic-scope h2{font-family:\\\"Century Gothic\\\",CenturyGothic,AppleGothic,sans-serif;font-size:18px;font-size:1.8rem;margin:30px 0 10px}.diagnostic-scope form.daterange label{padding:0}.diagnostic-scope form.daterange input{margin:0 10px}.diagnostic-scope table.datatable [class^=\\\"icon-\\\"]{padding:0}.diagnostic-scope table.datatable td{font-size:90%;font-weight:normal}.diagnostic-scope .content{margin:auto}.diagnostic-scope .diagnostic-index .content,.diagnostic-scope .diagnostic-runner .content{width:100%;padding:0 20px}.diagnostic-scope .diagnostic-index .message,.diagnostic-scope .diagnostic-runner .message{padding:8px;text-align:center}.diagnostic-scope .panel .action-bar{background:#266d9c;padding:3px;overflow:hidden;color:#e7eff4;margin:40px 0 10px 0}.diagnostic-scope .panel .action-bar .btn-info{overflow:hidden;background:transparent;border:1px rgba(255,255,255,0.3) solid}.diagnostic-scope .diagnostics-main-area{margin-top:0px;max-width:800px}.action-bar .tool-exitButton,.action-bar [data-control=\\\"exitButton\\\"]{float:right}\\n/*# sourceMappingURL=diagnostics.css.map */\\n.eligibility-editor h2.title{margin-top:0}.eligibility-editor .tree-container label{top:10px}.eligibility-editor .tree{border:none}.eligibility-editor .eligible-delivery{margin-left:0}.eligibility-editor.editing .eligible-delivery{display:none}.eligibility-editor.editing .eligible-testTaker{margin-left:0}.eligibility-editor.editing .eligible-testTaker .delivery-name{font-weight:bold}.eligibility-editor .actions{margin-top:20px}.eligibility-editor .actions .btn{float:right;margin-left:20px}.eligibility-editor .actions .btn.cancel{position:relative;top:3px}\\n/*# sourceMappingURL=eligibilityEditor.css.map */\\n.eligible-deliveries th:last-child{text-align:center}.eligible-deliveries td.status{text-align:center;width:48px}.eligible-deliveries td.status>span{font-size:18px;font-size:1.8rem;vertical-align:bottom}\\n/*# sourceMappingURL=eligibilityTable.css.map */\\n');\n"]}